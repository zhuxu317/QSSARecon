#include "mass_mole.h"

/** Function converting species mole fractions to mass fractions.
 *
 * \param[in]  X  array of species mole fractions
 * \param[out] Y  array of species mass fractions
 */
void mole2mass (const double * X, double * Y) {

  // mole fraction of final species
  double X_N;
  X_N = 1.0 - (X[0] + X[1] + X[2] + X[3] + X[4] + X[5] + X[6] + X[7] + X[8]
                + X[9] + X[10] + X[11] + X[12] + X[13] + X[14] + X[15] + X[16]
                + X[17] + X[18] + X[19] + X[20] + X[21] + X[22] + X[23]
                + X[24] + X[25] + X[26] + X[27] + X[28] + X[29] + X[30]
                + X[31] + X[32] + X[33] + X[34] + X[35] + X[36] + X[37]
                + X[38] + X[39]);
  // average molecular weight
  double mw_avg = 0.0;
  mw_avg += X[0] * 1.7030999999999999e+01;
  mw_avg += X[1] * 4.6005000000000003e+01;
  mw_avg += X[2] * 3.0006000000000000e+01;
  mw_avg += X[3] * 4.4012999999999998e+01;
  mw_avg += X[4] * 2.0160000000000000e+00;
  mw_avg += X[5] * 3.1998000000000001e+01;
  mw_avg += X[6] * 4.7997000000000000e+01;
  mw_avg += X[7] * 1.0080000000000000e+00;
  mw_avg += X[8] * 1.5999000000000001e+01;
  mw_avg += X[9] * 1.7007000000000001e+01;
  mw_avg += X[10] * 3.3006000000000000e+01;
  mw_avg += X[11] * 1.8015000000000001e+01;
  mw_avg += X[12] * 3.4014000000000003e+01;
  mw_avg += X[13] * 2.8009999999999998e+01;
  mw_avg += X[14] * 4.4009000000000000e+01;
  mw_avg += X[15] * 4.5016999999999996e+01;
  mw_avg += X[16] * 3.0026000000000000e+01;
  mw_avg += X[17] * 2.9018000000000001e+01;
  mw_avg += X[18] * 1.6023000000000000e+01;
  mw_avg += X[19] * 1.5015000000000001e+01;
  mw_avg += X[20] * 1.4007000000000000e+01;
  mw_avg += X[21] * 2.9021999999999998e+01;
  mw_avg += X[22] * 3.2045999999999999e+01;
  mw_avg += X[23] * 3.1038000000000000e+01;
  mw_avg += X[24] * 3.0030000000000001e+01;
  mw_avg += X[25] * 3.0030000000000001e+01;
  mw_avg += X[26] * 3.0030000000000001e+01;
  mw_avg += X[27] * 3.3030000000000001e+01;
  mw_avg += X[28] * 3.2021999999999998e+01;
  mw_avg += X[29] * 3.2021999999999998e+01;
  mw_avg += X[30] * 3.1014000000000003e+01;
  mw_avg += X[31] * 3.1014000000000003e+01;
  mw_avg += X[32] * 4.7012999999999998e+01;
  mw_avg += X[33] * 4.7012999999999998e+01;
  mw_avg += X[34] * 6.2003999999999998e+01;
  mw_avg += X[35] * 6.3012000000000000e+01;
  mw_avg += X[36] * 4.4033000000000001e+01;
  mw_avg += X[37] * 4.3024999999999999e+01;
  mw_avg += X[38] * 4.0026020000000004e+00;
  mw_avg += X[39] * 2.8013999999999999e+01;
  mw_avg += X_N * 3.9950000000000003e+01;

  // calculate mass fractions
  Y[0] = X[0] * 1.7030999999999999e+01 / mw_avg;
  Y[1] = X[1] * 4.6005000000000003e+01 / mw_avg;
  Y[2] = X[2] * 3.0006000000000000e+01 / mw_avg;
  Y[3] = X[3] * 4.4012999999999998e+01 / mw_avg;
  Y[4] = X[4] * 2.0160000000000000e+00 / mw_avg;
  Y[5] = X[5] * 3.1998000000000001e+01 / mw_avg;
  Y[6] = X[6] * 4.7997000000000000e+01 / mw_avg;
  Y[7] = X[7] * 1.0080000000000000e+00 / mw_avg;
  Y[8] = X[8] * 1.5999000000000001e+01 / mw_avg;
  Y[9] = X[9] * 1.7007000000000001e+01 / mw_avg;
  Y[10] = X[10] * 3.3006000000000000e+01 / mw_avg;
  Y[11] = X[11] * 1.8015000000000001e+01 / mw_avg;
  Y[12] = X[12] * 3.4014000000000003e+01 / mw_avg;
  Y[13] = X[13] * 2.8009999999999998e+01 / mw_avg;
  Y[14] = X[14] * 4.4009000000000000e+01 / mw_avg;
  Y[15] = X[15] * 4.5016999999999996e+01 / mw_avg;
  Y[16] = X[16] * 3.0026000000000000e+01 / mw_avg;
  Y[17] = X[17] * 2.9018000000000001e+01 / mw_avg;
  Y[18] = X[18] * 1.6023000000000000e+01 / mw_avg;
  Y[19] = X[19] * 1.5015000000000001e+01 / mw_avg;
  Y[20] = X[20] * 1.4007000000000000e+01 / mw_avg;
  Y[21] = X[21] * 2.9021999999999998e+01 / mw_avg;
  Y[22] = X[22] * 3.2045999999999999e+01 / mw_avg;
  Y[23] = X[23] * 3.1038000000000000e+01 / mw_avg;
  Y[24] = X[24] * 3.0030000000000001e+01 / mw_avg;
  Y[25] = X[25] * 3.0030000000000001e+01 / mw_avg;
  Y[26] = X[26] * 3.0030000000000001e+01 / mw_avg;
  Y[27] = X[27] * 3.3030000000000001e+01 / mw_avg;
  Y[28] = X[28] * 3.2021999999999998e+01 / mw_avg;
  Y[29] = X[29] * 3.2021999999999998e+01 / mw_avg;
  Y[30] = X[30] * 3.1014000000000003e+01 / mw_avg;
  Y[31] = X[31] * 3.1014000000000003e+01 / mw_avg;
  Y[32] = X[32] * 4.7012999999999998e+01 / mw_avg;
  Y[33] = X[33] * 4.7012999999999998e+01 / mw_avg;
  Y[34] = X[34] * 6.2003999999999998e+01 / mw_avg;
  Y[35] = X[35] * 6.3012000000000000e+01 / mw_avg;
  Y[36] = X[36] * 4.4033000000000001e+01 / mw_avg;
  Y[37] = X[37] * 4.3024999999999999e+01 / mw_avg;
  Y[38] = X[38] * 4.0026020000000004e+00 / mw_avg;
  Y[39] = X[39] * 2.8013999999999999e+01 / mw_avg;

} // end mole2mass

/** Function converting species mass fractions to mole fractions.
 *
 * \param[in]  Y  array of species mass fractions
 * \param[out] X  array of species mole fractions
 */
void mass2mole (const double * Y, double * X) {

  // mass fraction of final species
  double Y_N;
  Y_N = 1.0 - (Y[0] + Y[1] + Y[2] + Y[3] + Y[4] + Y[5] + Y[6] + Y[7] + Y[8]
                + Y[9] + Y[10] + Y[11] + Y[12] + Y[13] + Y[14] + Y[15] + Y[16]
                + Y[17] + Y[18] + Y[19] + Y[20] + Y[21] + Y[22] + Y[23]
                + Y[24] + Y[25] + Y[26] + Y[27] + Y[28] + Y[29] + Y[30]
                + Y[31] + Y[32] + Y[33] + Y[34] + Y[35] + Y[36] + Y[37]
                + Y[38] + Y[39]);
  // average molecular weight
  double mw_avg = 0.0;
  mw_avg += Y[0] / 1.7030999999999999e+01;
  mw_avg += Y[1] / 4.6005000000000003e+01;
  mw_avg += Y[2] / 3.0006000000000000e+01;
  mw_avg += Y[3] / 4.4012999999999998e+01;
  mw_avg += Y[4] / 2.0160000000000000e+00;
  mw_avg += Y[5] / 3.1998000000000001e+01;
  mw_avg += Y[6] / 4.7997000000000000e+01;
  mw_avg += Y[7] / 1.0080000000000000e+00;
  mw_avg += Y[8] / 1.5999000000000001e+01;
  mw_avg += Y[9] / 1.7007000000000001e+01;
  mw_avg += Y[10] / 3.3006000000000000e+01;
  mw_avg += Y[11] / 1.8015000000000001e+01;
  mw_avg += Y[12] / 3.4014000000000003e+01;
  mw_avg += Y[13] / 2.8009999999999998e+01;
  mw_avg += Y[14] / 4.4009000000000000e+01;
  mw_avg += Y[15] / 4.5016999999999996e+01;
  mw_avg += Y[16] / 3.0026000000000000e+01;
  mw_avg += Y[17] / 2.9018000000000001e+01;
  mw_avg += Y[18] / 1.6023000000000000e+01;
  mw_avg += Y[19] / 1.5015000000000001e+01;
  mw_avg += Y[20] / 1.4007000000000000e+01;
  mw_avg += Y[21] / 2.9021999999999998e+01;
  mw_avg += Y[22] / 3.2045999999999999e+01;
  mw_avg += Y[23] / 3.1038000000000000e+01;
  mw_avg += Y[24] / 3.0030000000000001e+01;
  mw_avg += Y[25] / 3.0030000000000001e+01;
  mw_avg += Y[26] / 3.0030000000000001e+01;
  mw_avg += Y[27] / 3.3030000000000001e+01;
  mw_avg += Y[28] / 3.2021999999999998e+01;
  mw_avg += Y[29] / 3.2021999999999998e+01;
  mw_avg += Y[30] / 3.1014000000000003e+01;
  mw_avg += Y[31] / 3.1014000000000003e+01;
  mw_avg += Y[32] / 4.7012999999999998e+01;
  mw_avg += Y[33] / 4.7012999999999998e+01;
  mw_avg += Y[34] / 6.2003999999999998e+01;
  mw_avg += Y[35] / 6.3012000000000000e+01;
  mw_avg += Y[36] / 4.4033000000000001e+01;
  mw_avg += Y[37] / 4.3024999999999999e+01;
  mw_avg += Y[38] / 4.0026020000000004e+00;
  mw_avg += Y[39] / 2.8013999999999999e+01;
  mw_avg += Y_N / 3.9950000000000003e+01;
  mw_avg = 1.0 / mw_avg;

  // calculate mole fractions
  X[0] = Y[0] * mw_avg / 1.7030999999999999e+01;
  X[1] = Y[1] * mw_avg / 4.6005000000000003e+01;
  X[2] = Y[2] * mw_avg / 3.0006000000000000e+01;
  X[3] = Y[3] * mw_avg / 4.4012999999999998e+01;
  X[4] = Y[4] * mw_avg / 2.0160000000000000e+00;
  X[5] = Y[5] * mw_avg / 3.1998000000000001e+01;
  X[6] = Y[6] * mw_avg / 4.7997000000000000e+01;
  X[7] = Y[7] * mw_avg / 1.0080000000000000e+00;
  X[8] = Y[8] * mw_avg / 1.5999000000000001e+01;
  X[9] = Y[9] * mw_avg / 1.7007000000000001e+01;
  X[10] = Y[10] * mw_avg / 3.3006000000000000e+01;
  X[11] = Y[11] * mw_avg / 1.8015000000000001e+01;
  X[12] = Y[12] * mw_avg / 3.4014000000000003e+01;
  X[13] = Y[13] * mw_avg / 2.8009999999999998e+01;
  X[14] = Y[14] * mw_avg / 4.4009000000000000e+01;
  X[15] = Y[15] * mw_avg / 4.5016999999999996e+01;
  X[16] = Y[16] * mw_avg / 3.0026000000000000e+01;
  X[17] = Y[17] * mw_avg / 2.9018000000000001e+01;
  X[18] = Y[18] * mw_avg / 1.6023000000000000e+01;
  X[19] = Y[19] * mw_avg / 1.5015000000000001e+01;
  X[20] = Y[20] * mw_avg / 1.4007000000000000e+01;
  X[21] = Y[21] * mw_avg / 2.9021999999999998e+01;
  X[22] = Y[22] * mw_avg / 3.2045999999999999e+01;
  X[23] = Y[23] * mw_avg / 3.1038000000000000e+01;
  X[24] = Y[24] * mw_avg / 3.0030000000000001e+01;
  X[25] = Y[25] * mw_avg / 3.0030000000000001e+01;
  X[26] = Y[26] * mw_avg / 3.0030000000000001e+01;
  X[27] = Y[27] * mw_avg / 3.3030000000000001e+01;
  X[28] = Y[28] * mw_avg / 3.2021999999999998e+01;
  X[29] = Y[29] * mw_avg / 3.2021999999999998e+01;
  X[30] = Y[30] * mw_avg / 3.1014000000000003e+01;
  X[31] = Y[31] * mw_avg / 3.1014000000000003e+01;
  X[32] = Y[32] * mw_avg / 4.7012999999999998e+01;
  X[33] = Y[33] * mw_avg / 4.7012999999999998e+01;
  X[34] = Y[34] * mw_avg / 6.2003999999999998e+01;
  X[35] = Y[35] * mw_avg / 6.3012000000000000e+01;
  X[36] = Y[36] * mw_avg / 4.4033000000000001e+01;
  X[37] = Y[37] * mw_avg / 4.3024999999999999e+01;
  X[38] = Y[38] * mw_avg / 4.0026020000000004e+00;
  X[39] = Y[39] * mw_avg / 2.8013999999999999e+01;

} // end mass2mole

/** Function calculating density from mole fractions.
 *
 * \param[in]  temp  temperature
 * \param[in]  pres  pressure
 * \param[in]  X     array of species mole fractions
 * \return     rho  mixture mass density
 */
double getDensity (const double temp, const double pres, const double * X) {

  // mole fraction of final species
  double X_N;
  X_N = 1.0 - (X[0] + X[1] + X[2] + X[3] + X[4] + X[5] + X[6] + X[7] + X[8]
                + X[9] + X[10] + X[11] + X[12] + X[13] + X[14] + X[15] + X[16]
                + X[17] + X[18] + X[19] + X[20] + X[21] + X[22] + X[23]
                + X[24] + X[25] + X[26] + X[27] + X[28] + X[29] + X[30]
                + X[31] + X[32] + X[33] + X[34] + X[35] + X[36] + X[37]
                + X[38] + X[39]);
  // average molecular weight
  double mw_avg = 0.0;
  mw_avg += X[0] * 1.7030999999999999e+01;
  mw_avg += X[1] * 4.6005000000000003e+01;
  mw_avg += X[2] * 3.0006000000000000e+01;
  mw_avg += X[3] * 4.4012999999999998e+01;
  mw_avg += X[4] * 2.0160000000000000e+00;
  mw_avg += X[5] * 3.1998000000000001e+01;
  mw_avg += X[6] * 4.7997000000000000e+01;
  mw_avg += X[7] * 1.0080000000000000e+00;
  mw_avg += X[8] * 1.5999000000000001e+01;
  mw_avg += X[9] * 1.7007000000000001e+01;
  mw_avg += X[10] * 3.3006000000000000e+01;
  mw_avg += X[11] * 1.8015000000000001e+01;
  mw_avg += X[12] * 3.4014000000000003e+01;
  mw_avg += X[13] * 2.8009999999999998e+01;
  mw_avg += X[14] * 4.4009000000000000e+01;
  mw_avg += X[15] * 4.5016999999999996e+01;
  mw_avg += X[16] * 3.0026000000000000e+01;
  mw_avg += X[17] * 2.9018000000000001e+01;
  mw_avg += X[18] * 1.6023000000000000e+01;
  mw_avg += X[19] * 1.5015000000000001e+01;
  mw_avg += X[20] * 1.4007000000000000e+01;
  mw_avg += X[21] * 2.9021999999999998e+01;
  mw_avg += X[22] * 3.2045999999999999e+01;
  mw_avg += X[23] * 3.1038000000000000e+01;
  mw_avg += X[24] * 3.0030000000000001e+01;
  mw_avg += X[25] * 3.0030000000000001e+01;
  mw_avg += X[26] * 3.0030000000000001e+01;
  mw_avg += X[27] * 3.3030000000000001e+01;
  mw_avg += X[28] * 3.2021999999999998e+01;
  mw_avg += X[29] * 3.2021999999999998e+01;
  mw_avg += X[30] * 3.1014000000000003e+01;
  mw_avg += X[31] * 3.1014000000000003e+01;
  mw_avg += X[32] * 4.7012999999999998e+01;
  mw_avg += X[33] * 4.7012999999999998e+01;
  mw_avg += X[34] * 6.2003999999999998e+01;
  mw_avg += X[35] * 6.3012000000000000e+01;
  mw_avg += X[36] * 4.4033000000000001e+01;
  mw_avg += X[37] * 4.3024999999999999e+01;
  mw_avg += X[38] * 4.0026020000000004e+00;
  mw_avg += X[39] * 2.8013999999999999e+01;
  mw_avg += X_N * 3.9950000000000003e+01;

  return pres * mw_avg / (8.31446210e+03 * temp);
} // end getDensity

