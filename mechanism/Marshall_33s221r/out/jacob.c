#include "jacob.h"

void eval_jacob (const double t, const double pres, const double * __restrict__ y, double * __restrict__ jac) {

  double T = y[0];

  // average molecular weight
  double mw_avg;
  // mass-averaged density
  double rho;
  // species molar concentrations
  double conc[41];
  double y_N;
  eval_conc(y[0], pres, &y[1], &y_N, &mw_avg, &rho, conc);

  // evaluate reaction rates
  double fwd_rates[271];
  double rev_rates[268];
  eval_rxn_rates (T, pres, conc, fwd_rates, rev_rates);

  double pres_mod[37];
  //get pressure modifications to reaction rates
  get_rxn_pres_mod (T, pres, conc, pres_mod);

  // evaluate rate of change of species molar concentration
  double spec_rates[41] = {0};
  eval_spec_rates (fwd_rates, rev_rates, pres_mod, spec_rates, &spec_rates[40]);

  double m = pres / (8.31446210e+03 * T);
  double logT = log(T);
  double dBdT[41];
  if (T <= 1000.0) {
    dBdT[0] = (3.1402787099999996e+00 + -6.6854515799999999e+03 / T) / T + -1.7924457099999999e-03 + T * (6.3158634666666668e-06 + T * (-4.9708492500000002e-09 + 1.4305359219999998e-12 * T));
    dBdT[1] = (2.7871269600000002e+00 + 2.8950012400000001e+03 / T) / T + -2.1478841700000000e-04 + T * (4.5794606000000002e-06 + T * (-4.3566034999999999e-09 + 1.3424992880000000e-12 * T));
    dBdT[2] = (3.0851799000000000e+00 + 9.8406126700000004e+03 / T) / T + -1.8234659400000000e-03 + T * (2.8320253733333335e-06 + T * (-1.6560143349999999e-09 + 3.5529474599999998e-13 * T));
    dBdT[3] = (1.1394229000000000e+00 + 8.8700862199999992e+03 / T) / T + 6.0900436999999997e-03 + T * (-5.3063138333333337e-06 + T * (3.0230009749999999e-09 + -7.7025182999999996e-13 * T));
    dBdT[4] = (1.3769420399999999e+00 + -9.2117308100000002e+02 / T) / T + 3.8695846099999999e-03 + T * (-6.2911690999999993e-06 + T * (4.8879278499999998e-09 + -1.4341913259999999e-12 * T));
    dBdT[5] = (2.7849825799999999e+00 + -1.0641358900000000e+03 / T) / T + -1.5100111649999999e-03 + T * (3.3067639033333336e-06 + T * (-2.4446010850000002e-09 + 6.5775540400000006e-13 * T));
    dBdT[7] = (1.4997592499999999e+00 + 2.5473766500000002e+04 / T) / T + 3.3691224950000002e-07 + T * (3.7269087000000003e-10 + T * (-9.2548031499999991e-13 + 4.2846764400000000e-16 * T));
    dBdT[8] = (2.1590652600000002e+00 + 2.9129845300000001e+04 / T) / T + -1.6075499949999999e-03 + T * (2.1641851433333333e-06 + T * (-1.4968877874999999e-09 + 4.1375223400000002e-13 * T));
    dBdT[9] = (2.9758516500000001e+00 + 3.3934113699999998e+03 / T) / T + -1.1427764550000000e-03 + T * (1.4448096066666668e-06 + T * (-8.9981659999999995e-10 + 2.5341386000000001e-13 * T));
    dBdT[10] = (3.2625124999999997e+00 + 2.6244235600000002e+02 / T) / T + -2.2282101599999998e-03 + T * (6.8388311333333335e-06 + T * (-5.8948502749999998e-09 + 1.8112285139999998e-12 * T));
    dBdT[11] = (3.2014755099999999e+00 + -3.0295006600000001e+04 / T) / T + -1.0279177300000001e-03 + T * (2.1884906899999998e-06 + T * (-1.3822674000000000e-09 + 3.5656521000000001e-13 * T));
    dBdT[12] = (3.2385415999999996e+00 + -1.7648600299999998e+04 / T) / T + -1.2480545549999999e-04 + T * (5.3285966999999996e-06 + T * (-5.1729986250000002e-09 + 1.6595326399999999e-12 * T));
    dBdT[13] = (2.5950837700000000e+00 + -1.4344896800000000e+04 / T) / T + -3.6059846849999998e-04 + T * (4.2746078000000001e-07 + T * (1.6310732324999999e-10 + -1.6434296119999999e-13 * T));
    dBdT[14] = (1.2066432100000002e+00 + -4.8352986400000002e+04 / T) / T + 5.0485043000000002e-03 + T * (-3.3211293633333335e-06 + T * (1.3678890574999999e-09 + -2.5546793000000003e-13 * T));
    dBdT[16] = (3.7718723100000000e+00 + -1.4379810600000001e+04 / T) / T + -4.8813307749999996e-03 + T * (1.2337397266666666e-05 + T * (-9.4230404249999995e-09 + 2.6265329199999999e-12 * T));
    dBdT[17] = (2.9707474899999999e+00 + 3.8420329099999999e+03 / T) / T + -7.4560803999999998e-04 + T * (3.1801392533333331e-06 + T * (-2.2068008725000002e-09 + 5.3529025799999992e-13 * T));
    dBdT[18] = (3.0646332899999997e+00 + 2.1176866800000000e+04 / T) / T + -5.5010726999999999e-04 + T * (1.4194968933333333e-06 + T * (-6.7055895749999997e-10 + 1.1785348139999998e-13 * T));
    dBdT[19] = (2.4588700299999999e+00 + 4.2108837200000002e+04 / T) / T + 2.4695220399999999e-04 + T * (-6.2620853333333337e-07 + T * (7.1385559750000004e-10 + -2.3372934200000003e-13 * T));
    dBdT[20] = (1.4997664300000002e+00 + 5.6076071000000004e+04 / T) / T + 2.5107479700000002e-07 + T * (6.4363737000000003e-10 + T * (-1.2365815724999999e-12 + 5.4817901199999999e-16 * T));
    dBdT[21] = (3.2547463199999997e+00 + 2.8832379300000001e+04 / T) / T + -1.7254914900000000e-03 + T * (4.5929566333333333e-06 + T * (-3.3315936000000000e-09 + 8.8204679400000002e-13 * T));
    dBdT[22] = (2.8347214900000002e+00 + 1.0089392500000000e+04 / T) / T + -3.2456477749999999e-04 + T * (1.2561615433333334e-05 + T * (-1.2517729550000001e-08 + 4.0672412799999997e-12 * T));
    dBdT[23] = (2.4212550500000001e+00 + 2.5819895600000000e+04 / T) / T + 6.7450794999999997e-04 + T * (7.4486356999999996e-06 + T * (-7.4931933000000001e-09 + 2.4195794000000001e-12 * T));
    dBdT[24] = (2.8892921299999998e+00 + 2.2894089599999999e+04 / T) / T + -1.6050043000000000e-03 + T * (6.4796836666666673e-06 + T * (-4.6368257749999999e-09 + 1.1474256979999999e-12 * T));
    dBdT[25] = (2.9983441900000001e+00 + 2.5495866399999999e+04 / T) / T + -1.9250812100000000e-03 + T * (6.7227713333333332e-06 + T * (-4.7105544749999998e-09 + 1.1525323840000000e-12 * T));
    dBdT[26] = (3.5320400100000002e+00 + 3.4958000300000000e+04 / T) / T + -3.6620928900000000e-03 + T * (1.0026790433333333e-05 + T * (-7.6000137749999992e-09 + 2.0940127800000001e-12 * T));
    dBdT[27] = (2.2101609199999999e+00 + -6.5814848099999999e+03 / T) / T + 3.0983583800000001e-03 + T * (3.6864982666666666e-06 + T * (-4.9167065500000002e-09 + 1.7650331799999999e-12 * T));
    dBdT[28] = (2.9320113900000000e+00 + 6.7117897499999999e+03 / T) / T + -8.2014082500000000e-05 + T * (4.6387136333333328e-06 + T * (-4.0686963250000003e-09 + 1.2007056680000000e-12 * T));
    dBdT[29] = (2.9560824800000001e+00 + 1.0919978999999999e+04 / T) / T + -1.5130550999999999e-03 + T * (8.5624798666666668e-06 + T * (-7.8911280000000004e-09 + 2.4816914800000000e-12 * T));
    dBdT[30] = (3.5532615999999999e+00 + 1.1631560299999999e+04 / T) / T + -2.9226584399999998e-03 + T * (6.2951247999999994e-06 + T * (-4.4009973250000004e-09 + 1.1457792420000000e-12 * T));
    dBdT[32] = (2.1641643799999999e+00 + -1.0774408600000001e+04 / T) / T + 4.2525888650000003e-03 + T * (1.8285385766666667e-07 + T * (-2.0691411850000000e-09 + 8.7991430200000003e-13 * T));
    dBdT[33] = (3.0377934700000004e+00 + -6.5308823599999996e+03 / T) / T + -2.2306155450000000e-03 + T * (1.0648027166666666e-05 + T * (-9.4839872500000008e-09 + 2.8914177000000001e-12 * T));
    dBdT[34] = (2.3558685000000001e+00 + 7.4753493099999996e+03 / T) / T + 5.3272718000000000e-03 + T * (-9.5563498000000005e-07 + T * (-1.2867790275000000e-09 + 6.1706457200000001e-13 * T));
    dBdT[35] = (5.5975055999999990e-01 + -1.7395587100000001e+04 / T) / T + 1.0075108450000000e-02 + T * (-3.8405765333333333e-06 + T * (-5.7972807500000003e-10 + 6.3516110399999999e-13 * T));
    dBdT[36] = (2.5364009400000000e+00 + -3.0962387199999998e+03 / T) / T + 4.8670356700000004e-03 + T * (-1.2909761566666667e-07 + T * (-1.4753204399999999e-09 + 6.0236373199999998e-13 * T));
    dBdT[37] = (1.2400903099999998e+00 + -1.5458995100000000e+04 / T) / T + 7.2800248499999996e-03 + T * (-5.1450776666666668e-06 + T * (2.1388375700000002e-09 + -3.5926322200000001e-13 * T));
    dBdT[39] = (2.5360352100000001e+00 + -1.0474964500000001e+03 / T) / T + -7.9135472000000005e-05 + T * (-1.4232808366666666e-07 + T * (5.9385647499999997e-10 + -2.7941641200000000e-13 * T));
  } else {
    dBdT[0] = (1.3607431100000000e+00 + -6.4159647299999997e+03 / T) / T + 3.1592507299999999e-03 + T * (-7.6322268666666668e-07 + T * (1.0294185275000000e-10 + -5.8167357399999999e-15 * T));
    dBdT[1] = (3.9048228500000004e+00 + 2.2895897900000000e+03 / T) / T + 1.0723724900000000e-03 + T * (-2.7088468633333331e-07 + T * (3.8877989250000000e-11 + -2.0822792599999997e-15 * T));
    dBdT[2] = (2.2548731700000002e+00 + 9.9069983599999996e+03 / T) / T + 5.9934970500000000e-04 + T * (-1.4434283333333334e-07 + T * (1.7573583400000001e-11 + -8.1957715000000002e-16 * T));
    dBdT[3] = (3.8064138200000004e+00 + 8.1979821900000006e+03 / T) / T + 1.3265372150000000e-03 + T * (-3.2359913233333334e-07 + T * (4.0647537500000000e-11 + -1.9934763080000002e-15 * T));
    dBdT[4] = (1.9020764899999998e+00 + -7.9794872599999997e+02 / T) / T + 4.3449629050000001e-04 + T * (-5.5288143333333333e-08 + T * (4.7712974750000002e-12 + -1.8622435780000001e-16 * T));
    dBdT[5] = (2.6598048799999998e+00 + -1.2160304799999999e+03 / T) / T + 3.2993868600000002e-04 + T * (-4.8052723999999998e-08 + T * (5.3664009250000000e-12 + -2.7300756799999998e-16 * T));
    dBdT[7] = (1.4998521100000000e+00 + 2.5473802400000000e+04 / T) / T + 1.1729127400000000e-07 + T * (-3.8723880333333334e-11 + T * (5.6427074500000002e-15 + -3.0598400999999999e-19 * T));
    dBdT[8] = (1.5516008700000001e+00 + 2.9228762800000000e+04 / T) / T + -1.9154272849999999e-05 + T * (2.8106582600000000e-10 + T * (1.0031678399999999e-12 + -8.3495314800000002e-17 * T));
    dBdT[9] = (1.8458172099999999e+00 + 3.7170661000000000e+03 / T) / T + 5.4861909000000005e-04 + T * (-9.6373700333333336e-08 + T * (1.0227497750000000e-11 + -4.6276451600000004e-16 * T));
    dBdT[10] = (3.1056400999999996e+00 + 4.3289876900000003e+01 / T) / T + 1.0202341800000000e-03 + T * (-1.2195918733333333e-07 + T * (4.6493261000000001e-12 + 9.9763662999999997e-17 * T));
    dBdT[11] = (1.7311751200000001e+00 + -2.9916908200000002e+04 / T) / T + 1.4756849749999999e-03 + T * (-2.7845326166666668e-07 + T * (3.1522148250000002e-11 + -1.6810633520000000e-15 * T));
    dBdT[12] = (3.5401748000000000e+00 + -1.7951402900000001e+04 / T) / T + 2.0798548550000000e-03 + T * (-4.3625592333333335e-07 + T * (5.0205903750000003e-11 + -2.3101848599999999e-15 * T));
    dBdT[13] = (2.0339727399999998e+00 + -1.4258604400000000e+04 / T) / T + 6.8664059000000000e-04 + T * (-1.6548169566666666e-07 + T * (2.0257036174999999e-11 + -9.7066349800000000e-16 * T));
    dBdT[14] = (3.6353746999999998e+00 + -4.9020367700000003e+04 / T) / T + 1.3727972949999999e-03 + T * (-3.3276079633333335e-07 + T * (4.0253401499999999e-11 + -1.8440372840000001e-15 * T));
    dBdT[16] = (1.9133251599999999e+00 + -1.4462235800000000e+04 / T) / T + 3.3501996300000000e-03 + T * (-8.5173561333333335e-07 + T * (1.0694878550000000e-10 + -4.8814504199999996e-15 * T));
    dBdT[17] = (2.8578111300000000e+00 + 3.6164288299999998e+03 / T) / T + 1.3205697500000000e-03 + T * (-2.4805909800000002e-07 + T * (3.0828307500000001e-11 + -1.7779174360000003e-15 * T));
    dBdT[18] = (1.6249931200000001e+00 + 2.1541910400000001e+04 / T) / T + 1.6992058850000000e-03 + T * (-3.3876989333333334e-07 + T * (3.1377699000000002e-11 + -5.3300168600000000e-16 * T));
    dBdT[19] = (1.7949894099999999e+00 + 4.2340899799999999e+04 / T) / T + 6.4629783500000002e-04 + T * (-1.2851969800000001e-07 + T * (1.5650690200000000e-11 + -7.4084382600000004e-16 * T));
    dBdT[20] = (1.4160424500000000e+00 + 5.6105151200000000e+04 / T) / T + 8.7331883000000003e-05 + T * (-3.9621520666666666e-08 + T * (7.5462513500000001e-12 + -4.0652031800000000e-16 * T));
    dBdT[21] = (2.4274442299999999e+00 + 2.8806774000000001e+04 / T) / T + 1.6164761699999999e-03 + T * (-3.9098766333333333e-07 + T * (4.7627089000000001e-11 + -2.2898301200000000e-15 * T));
    dBdT[22] = (3.9395735700000003e+00 + 9.2826554799999994e+03 / T) / T + 4.3750859350000001e-03 + T * (-9.9799686000000006e-07 + T * (1.1681960449999999e-10 + -5.4613719800000003e-15 * T));
    dBdT[23] = (3.0448356600000004e+00 + 2.5324142000000000e+04 / T) / T + 3.6556509300000001e-03 + T * (-8.2541933000000010e-07 + T * (9.5933255249999996e-11 + -4.4621514599999999e-15 * T));
    dBdT[24] = (9.0331153000000008e-01 + 2.3099923800000000e+04 / T) / T + 4.2805767950000002e-03 + T * (-1.3195173133333333e-06 + T * (2.1958465349999999e-10 + -1.5218374180000000e-14 * T));
    dBdT[25] = (7.9734239000000007e-01 + 2.5754209500000001e+04 / T) / T + 4.2954951549999997e-03 + T * (-1.3163777999999999e-06 + T * (2.1830648450000000e-10 + -1.5097083560000001e-14 * T));
    dBdT[26] = (2.0590367000000001e+00 + 3.4853014900000002e+04 / T) / T + 3.0919117349999998e-03 + T * (-7.4057054999999995e-07 + T * (8.9634801500000001e-11 + -4.2906580999999997e-15 * T));
    dBdT[27] = (2.8811250199999998e+00 + -6.8601841899999999e+03 / T) / T + 4.0785422400000000e-03 + T * (-9.4205192000000002e-07 + T * (1.0948273325000000e-10 + -5.0544920800000002e-15 * T));
    dBdT[28] = (2.7555591399999999e+00 + 6.5182617700000001e+03 / T) / T + 2.5810967700000001e-03 + T * (-5.8795795666666668e-07 + T * (6.8763173000000006e-11 + -3.2128628599999998e-15 * T));
    dBdT[29] = (2.9832193299999998e+00 + 1.0578010600000000e+04 / T) / T + 2.4442318699999998e-03 + T * (-5.5028878999999994e-07 + T * (6.3842861499999997e-11 + -2.9661712199999996e-15 * T));
    dBdT[30] = (2.2412905300000001e+00 + 1.1774574400000000e+04 / T) / T + 1.3618859650000000e-03 + T * (-5.3544431999999998e-08 + T * (-2.4478374549999999e-11 + 2.3420788799999998e-15 * T));
    dBdT[32] = (4.7914464099999998e+00 + -1.1597434300000001e+04 / T) / T + 1.8231536600000001e-03 + T * (-4.3037588333333331e-07 + T * (5.1624558249999998e-11 + -2.4427735800000002e-15 * T));
    dBdT[33] = (3.6635850400000001e+00 + -7.2521633400000001e+03 / T) / T + 2.4492717549999998e-03 + T * (-5.9898064333333328e-07 + T * (7.3605090249999999e-11 + -3.5647115400000000e-15 * T));
    dBdT[34] = (6.3756914599999996e+00 + 6.2244557699999996e+03 / T) / T + 1.1086650149999999e-03 + T * (-1.9189859633333333e-07 + T * (1.6744385600000000e-11 + -5.1786939999999998e-16 * T));
    dBdT[35] = (7.0306125700000006e+00 + -1.9303376400000001e+04 / T) / T + 2.2318416799999999e-03 + T * (-5.7424259666666668e-07 + T * (7.2902901500000000e-11 + -3.6097472399999996e-15 * T));
    dBdT[36] = (4.6916933099999998e+00 + -3.8102860599999999e+03 / T) / T + 3.0435899449999999e-03 + T * (-6.9811173999999995e-07 + T * (8.2112184249999994e-11 + -3.8540778000000001e-15 * T));
    dBdT[37] = (4.3004505100000001e+00 + -1.6199527400000001e+04 / T) / T + 2.0112541050000001e-03 + T * (-4.6987426666666663e-07 + T * (5.5963835500000001e-11 + -2.6499993199999998e-15 * T));
    dBdT[39] = (1.9380297000000000e+00 + -9.1718098999999995e+02 / T) / T + 7.0919015000000000e-04 + T * (-1.6776034833333333e-07 + T * (2.0188886600000000e-11 + -9.5212855000000002e-16 * T));
  }

  if (T <= 998.4) {
    dBdT[15] = (1.8219115700000001e+00 + -2.3546521799999999e+04 / T) / T + 4.8310908750000001e-03 + T * (-9.2853392333333331e-07 + T * (-1.0317312325000000e-09 + 5.2294414400000005e-13 * T));
  } else {
    dBdT[15] = (3.6398870700000003e+00 + -2.4052733499999998e+04 / T) / T + 2.8318136299999999e-03 + T * (-8.9285103666666671e-07 + T * (1.5426222100000000e-10 + -1.1219070620000000e-14 * T));
  }

  eval_jacob_0(pres, conc, fwd_rates, rev_rates, pres_mod, spec_rates, m, mw_avg, rho, dBdT, T, jac);
  eval_jacob_1(pres, conc, fwd_rates, rev_rates, pres_mod, spec_rates, m, mw_avg, rho, dBdT, T, jac);
  eval_jacob_2(pres, conc, fwd_rates, rev_rates, pres_mod, spec_rates, m, mw_avg, rho, dBdT, T, jac);
  eval_jacob_3(pres, conc, fwd_rates, rev_rates, pres_mod, spec_rates, m, mw_avg, rho, dBdT, T, jac);
  eval_jacob_4(pres, conc, fwd_rates, rev_rates, pres_mod, spec_rates, m, mw_avg, rho, dBdT, T, jac);
  eval_jacob_5(pres, conc, fwd_rates, rev_rates, pres_mod, spec_rates, m, mw_avg, rho, dBdT, T, jac);
  eval_jacob_6(pres, conc, fwd_rates, rev_rates, pres_mod, spec_rates, m, mw_avg, rho, dBdT, T, jac);
  // species enthalpies
  double h[41];
  eval_h(T, h);

  // species specific heats
  double cp[41];
  eval_cp(T, cp);

  // average specific heat
  double cp_avg;
  cp_avg = (y[1] * cp[0]) + (y[2] * cp[1]) + (y[3] * cp[2]) + (y[4] * cp[3]) + 
     (y[5] * cp[4]) + (y[6] * cp[5]) + (y[7] * cp[6]) + (y[8] * cp[7]) + 
     (y[9] * cp[8]) + (y[10] * cp[9]) + (y[11] * cp[10]) + (y[12] * cp[11]) + 
     (y[13] * cp[12]) + (y[14] * cp[13]) + (y[15] * cp[14]) + (y[16] * cp[15]) + 
     (y[17] * cp[16]) + (y[18] * cp[17]) + (y[19] * cp[18]) + (y[20] * cp[19]) + 
     (y[21] * cp[20]) + (y[22] * cp[21]) + (y[23] * cp[22]) + (y[24] * cp[23]) + 
     (y[25] * cp[24]) + (y[26] * cp[25]) + (y[27] * cp[26]) + (y[28] * cp[27]) + 
     (y[29] * cp[28]) + (y[30] * cp[29]) + (y[31] * cp[30]) + (y[32] * cp[31]) + 
     (y[33] * cp[32]) + (y[34] * cp[33]) + (y[35] * cp[34]) + (y[36] * cp[35]) + 
     (y[37] * cp[36]) + (y[38] * cp[37]) + (y[39] * cp[38]) + (y[40] * cp[39]) + (y_N * cp[40]);
  jac[0] = 0.0;
  double working_temp = 0;
  //Finish dYk / Yj's
  //And dT/dYj's
  eval_jacob_7(mw_avg, rho, cp_avg, spec_rates, h, cp, jac);
  eval_jacob_8(mw_avg, rho, cp_avg, spec_rates, h, cp, jac);
  if (T <= 998.4) {
    working_temp = (y[16] * 1.8469605038096722e+02 * (9.6621817500000002e-03 + T * (-5.5712035399999998e-06 + T * (-1.2380774790000000e-08 + 1.0458882880000001e-11 * T))));
  } else {
    working_temp = (y[16] * 1.8469605038096722e+02 * (5.6636272599999999e-03 + T * (-5.3571062200000000e-06 + T * (1.8511466520000000e-09 + -2.2438141240000001e-13 * T))));
  }

  if (T <= 1000.0) {
    working_temp += (y[1] * 4.8819576654336220e+02 * (-3.5848914199999998e-03 + T * (3.7895180800000001e-05 + T * (-5.9650190999999999e-08 + 2.8610718439999999e-11 * T))))
    + (y[2] * 1.8072953157265516e+02 * (-4.2957683400000001e-04 + T * (2.7476763599999999e-05 + T * (-5.2279241999999999e-08 + 2.6849985759999999e-11 * T))))
    + (y[3] * 2.7709331800306609e+02 * (-3.6469318799999999e-03 + T * (1.6992152240000001e-05 + T * (-1.9872172019999999e-08 + 7.1058949199999999e-12 * T))))
    + (y[4] * 1.8890923363551681e+02 * (1.2180087399999999e-02 + T * (-3.1837883000000002e-05 + T * (3.6276011699999999e-08 + -1.5405036599999999e-11 * T))))
    + (y[5] * 4.1242371527777777e+03 * (7.7391692199999997e-03 + T * (-3.7747014599999998e-05 + T * (5.8655134199999998e-08 + -2.8683826520000000e-11 * T))))
    + (y[6] * 2.5984318082380150e+02 * (-3.0200223299999998e-03 + T * (1.9840583420000001e-05 + T * (-2.9335213020000002e-08 + 1.3155108080000000e-11 * T))))
    + (y[7] * 1.7322878721586767e+02 * (2.6854693900000000e-03 + T * (2.4482331999999999e-05 + T * (-6.2228316900000010e-08 + 3.6919413759999999e-11 * T))))
    + (y[8] * 8.2484743055555555e+03 * (6.7382449900000005e-07 + T * (2.2361452200000002e-09 + T * (-1.1105763779999999e-11 + 8.5693528799999998e-15 * T))))
    + (y[9] * 5.1968636164760301e+02 * (-3.2150999899999999e-03 + T * (1.2985110860000000e-05 + T * (-1.7962653450000000e-08 + 8.2750446800000008e-12 * T))))
    + (y[10] * 4.8888470041747513e+02 * (-2.2855529100000000e-03 + T * (8.6688576400000006e-06 + T * (-1.0797799199999999e-08 + 5.0682771999999999e-12 * T))))
    + (y[11] * 2.5190759558868086e+02 * (-4.4564203199999996e-03 + T * (4.1032986800000000e-05 + T * (-7.0738203300000001e-08 + 3.6224570279999998e-11 * T))))
    + (y[12] * 4.6152995281709690e+02 * (-2.0558354600000001e-03 + T * (1.3130944140000000e-05 + T * (-1.6587208800000002e-08 + 7.1313041999999997e-12 * T))))
    + (y[13] * 2.4444235020873757e+02 * (-2.4961091099999998e-04 + T * (3.1971580199999999e-05 + T * (-6.2075983499999999e-08 + 3.3190652799999999e-11 * T))))
    + (y[14] * 2.9683906104962517e+02 * (-7.2119693699999995e-04 + T * (2.5647646800000002e-06 + T * (1.9572878789999999e-09 + -3.2868592240000000e-12 * T))))
    + (y[15] * 1.8892640369015430e+02 * (1.0097008600000000e-02 + T * (-1.9926776180000002e-05 + T * (1.6414668689999999e-08 + -5.1093586000000004e-12 * T))))
    + (y[17] * 2.7690874908412712e+02 * (-9.7626615499999993e-03 + T * (7.4024383599999999e-05 + T * (-1.1307648509999999e-07 + 5.2530658399999997e-11 * T))))
    + (y[18] * 2.8652774484802541e+02 * (-1.4912160800000000e-03 + T * (1.9080835519999999e-05 + T * (-2.6481610470000001e-08 + 1.0705805159999999e-11 * T))))
    + (y[19] * 5.1890795107033648e+02 * (-1.1002145400000000e-03 + T * (8.5169813600000001e-06 + T * (-8.0467074899999988e-09 + 2.3570696279999999e-12 * T))))
    + (y[20] * 5.5374372960372966e+02 * (4.9390440799999998e-04 + T * (-3.7572512000000000e-06 + T * (8.5662671700000000e-09 + -4.6745868400000003e-12 * T))))
    + (y[21] * 5.9359335332333842e+02 * (5.0214959400000004e-07 + T * (3.8618242200000000e-09 + T * (-1.4838978870000000e-11 + 1.0963580240000001e-14 * T))))
    + (y[22] * 2.8648825373854322e+02 * (-3.4509829800000000e-03 + T * (2.7557739800000002e-05 + T * (-3.9979123200000003e-08 + 1.7640935880000001e-11 * T))))
    + (y[23] * 2.5945397553516824e+02 * (-6.4912955499999998e-04 + T * (7.5369692600000006e-05 + T * (-1.5021275460000000e-07 + 8.1344825599999994e-11 * T))))
    + (y[24] * 2.6788008570139829e+02 * (1.3490158999999999e-03 + T * (4.4691814199999999e-05 + T * (-8.9918319600000001e-08 + 4.8391587999999999e-11 * T))))
    + (y[25] * 2.7687186480186483e+02 * (-3.2100086000000001e-03 + T * (3.8878102000000002e-05 + T * (-5.5641909300000002e-08 + 2.2948513959999999e-11 * T))))
    + (y[26] * 2.7687186480186483e+02 * (-3.8501624199999999e-03 + T * (4.0336627999999999e-05 + T * (-5.6526653699999998e-08 + 2.3050647680000000e-11 * T))))
    + (y[27] * 2.7687186480186483e+02 * (-7.3241857799999999e-03 + T * (6.0160742599999999e-05 + T * (-9.1200165299999997e-08 + 4.1880255600000001e-11 * T))))
    + (y[28] * 2.5172455646382079e+02 * (6.1967167600000001e-03 + T * (2.2118989599999999e-05 + T * (-5.9000478600000003e-08 + 3.5300663599999999e-11 * T))))
    + (y[29] * 2.5964843232777469e+02 * (-1.6402816500000000e-04 + T * (2.7832281799999999e-05 + T * (-4.8824355900000000e-08 + 2.4014113360000001e-11 * T))))
    + (y[30] * 2.5964843232777469e+02 * (-3.0261101999999999e-03 + T * (5.1374879200000001e-05 + T * (-9.4693535999999998e-08 + 4.9633829600000001e-11 * T))))
    + (y[31] * 2.6808738311730184e+02 * (-5.8453168799999997e-03 + T * (3.7770748799999998e-05 + T * (-5.2811967900000005e-08 + 2.2915584839999999e-11 * T))))
    + (y[32] * 2.6808738311730184e+02 * (-3.8782640200000001e-03 + T * (4.1095206199999999e-05 + T * (-7.4714844899999990e-08 + 3.9494618479999999e-11 * T))))
    + (y[33] * 1.7685453172526749e+02 * (8.5051777300000006e-03 + T * (1.0971231459999999e-06 + T * (-2.4829694219999999e-08 + 1.7598286040000001e-11 * T))))
    + (y[34] * 1.7685453172526749e+02 * (-4.4612310900000000e-03 + T * (6.3888162999999995e-05 + T * (-1.1380784700000001e-07 + 5.7828354000000002e-11 * T))))
    + (y[35] * 1.3409557609186507e+02 * (1.0654543600000000e-02 + T * (-5.7338098800000003e-06 + T * (-1.5441348330000000e-08 + 1.2341291440000001e-11 * T))))
    + (y[36] * 1.3195045546879959e+02 * (2.0150216900000000e-02 + T * (-2.3043459200000002e-05 + T * (-6.9567369000000004e-09 + 1.2703222080000000e-11 * T))))
    + (y[37] * 1.8882343015465673e+02 * (9.7340713400000008e-03 + T * (-7.7458569399999995e-07 + T * (-1.7703845280000000e-08 + 1.2047274640000000e-11 * T))))
    + (y[38] * 1.9324723067983732e+02 * (1.4560049699999999e-02 + T * (-3.0870466000000002e-05 + T * (2.5666050840000002e-08 + -7.1852644400000001e-12 * T))))
    + (y[39] * 2.0772642645958804e+03 * (1.0101343200000001e-06 + T * (-1.6491569300000001e-09 + T * (-2.0579499179999999e-12 + 2.8990074239999999e-15 * T))))
    + (y[40] * 2.9679667666166921e+02 * (-1.5827094400000001e-04 + T * (-8.5396850199999998e-07 + T * (7.1262776999999996e-09 + -5.5883282400000000e-12 * T))))
    + (y_N * 2.0812170463078849e+02 * (2.1303795999999999e-07 + T * (1.7946415439999999e-09 + T * (-6.9418725599999997e-12 + 5.2080557199999997e-15 * T))));
  } else {
    working_temp += (y[1] * 4.8819576654336220e+02 * (6.3185014599999997e-03 + T * (-4.5793361200000001e-06 + T * (1.2353022329999999e-09 + -1.1633471479999999e-13 * T))))
    + (y[2] * 1.8072953157265516e+02 * (2.1447449800000001e-03 + T * (-1.6253081179999999e-06 + T * (4.6653587099999997e-10 + -4.1645585199999998e-14 * T))))
    + (y[3] * 2.7709331800306609e+02 * (1.1986994100000000e-03 + T * (-8.6605700000000004e-07 + T * (2.1088300080000000e-10 + -1.6391543000000000e-14 * T))))
    + (y[4] * 1.8890923363551681e+02 * (2.6530744300000001e-03 + T * (-1.9415947940000001e-06 + T * (4.8777045000000000e-10 + -3.9869526160000002e-14 * T))))
    + (y[5] * 4.1242371527777777e+03 * (8.6899258100000003e-04 + T * (-3.3172886000000001e-07 + T * (5.7255569700000003e-11 + -3.7244871559999999e-15 * T))))
    + (y[6] * 2.5984318082380150e+02 * (6.5987737200000004e-04 + T * (-2.8831634400000000e-07 + T * (6.4396811100000003e-11 + -5.4601513599999999e-15 * T))))
    + (y[7] * 1.7322878721586767e+02 * (-7.7689698999999996e-03 + T * (1.0956871759999999e-05 + T * (-3.6885548700000000e-09 + 3.5188805520000000e-13 * T))))
    + (y[8] * 8.2484743055555555e+03 * (2.3458254800000001e-07 + T * (-2.3234328199999999e-10 + T * (6.7712489400000009e-14 + -6.1196801999999997e-18 * T))))
    + (y[9] * 5.1968636164760301e+02 * (-3.8308545699999999e-05 + T * (1.6863949560000000e-09 + T * (1.2038014079999999e-11 + -1.6699062959999999e-15 * T))))
    + (y[10] * 4.8888470041747513e+02 * (1.0972381800000001e-03 + T * (-5.7824220200000002e-07 + T * (1.2272997300000000e-10 + -9.2552903200000005e-15 * T))))
    + (y[11] * 2.5190759558868086e+02 * (2.0404683600000000e-03 + T * (-7.3175512399999998e-07 + T * (5.5791913200000001e-11 + 1.9952732600000000e-15 * T))))
    + (y[12] * 4.6152995281709690e+02 * (2.9513699499999998e-03 + T * (-1.6707195700000000e-06 + T * (3.7826577900000005e-10 + -3.3621267039999999e-14 * T))))
    + (y[13] * 2.4444235020873757e+02 * (4.1597097099999999e-03 + T * (-2.6175355400000001e-06 + T * (6.0247084500000003e-10 + -4.6203697199999998e-14 * T))))
    + (y[14] * 2.9683906104962517e+02 * (1.3732811800000000e-03 + T * (-9.9289017399999999e-07 + T * (2.4308443410000000e-10 + -1.9413269960000001e-14 * T))))
    + (y[15] * 1.8892640369015430e+02 * (2.7455945899999999e-03 + T * (-1.9965647780000000e-06 + T * (4.8304081799999996e-10 + -3.6880745680000001e-14 * T))))
    + (y[17] * 2.7690874908412712e+02 * (6.7003992599999999e-03 + T * (-5.1104136799999999e-06 + T * (1.2833854260000000e-09 + -9.7629008399999998e-14 * T))))
    + (y[18] * 2.8652774484802541e+02 * (2.6411395000000000e-03 + T * (-1.4883545880000000e-06 + T * (3.6993969000000003e-10 + -3.5558348720000003e-14 * T))))
    + (y[19] * 5.1890795107033648e+02 * (3.3984117700000000e-03 + T * (-2.0326193600000002e-06 + T * (3.7653238800000005e-10 + -1.0660033720000001e-14 * T))))
    + (y[20] * 5.5374372960372966e+02 * (1.2925956700000000e-03 + T * (-7.7111818800000003e-07 + T * (1.8780828240000001e-10 + -1.4816876520000001e-14 * T))))
    + (y[21] * 5.9359335332333842e+02 * (1.7466376600000001e-04 + T * (-2.3772912400000000e-07 + T * (9.0555016200000007e-11 + -8.1304063600000002e-15 * T))))
    + (y[22] * 2.8648825373854322e+02 * (3.2329523399999998e-03 + T * (-2.3459259800000001e-06 + T * (5.7152506800000006e-10 + -4.5796602399999998e-14 * T))))
    + (y[23] * 2.5945397553516824e+02 * (8.7501718700000002e-03 + T * (-5.9879811600000004e-06 + T * (1.4018352539999999e-09 + -1.0922743960000000e-13 * T))))
    + (y[24] * 2.6788008570139829e+02 * (7.3113018600000001e-03 + T * (-4.9525159800000004e-06 + T * (1.1511990629999999e-09 + -8.9243029200000004e-14 * T))))
    + (y[25] * 2.7687186480186483e+02 * (8.5611535900000004e-03 + T * (-7.9171038800000005e-06 + T * (2.6350158419999998e-09 + -3.0436748359999998e-13 * T))))
    + (y[26] * 2.7687186480186483e+02 * (8.5909903099999994e-03 + T * (-7.8982668000000001e-06 + T * (2.6196778139999999e-09 + -3.0194167120000000e-13 * T))))
    + (y[27] * 2.7687186480186483e+02 * (6.1838234699999996e-03 + T * (-4.4434232999999999e-06 + T * (1.0756176179999999e-09 + -8.5813162000000001e-14 * T))))
    + (y[28] * 2.5172455646382079e+02 * (8.1570844800000000e-03 + T * (-5.6523115200000004e-06 + T * (1.3137927990000000e-09 + -1.0108984160000000e-13 * T))))
    + (y[29] * 2.5964843232777469e+02 * (5.1621935400000003e-03 + T * (-3.5277477400000001e-06 + T * (8.2515807600000002e-10 + -6.4257257199999997e-14 * T))))
    + (y[30] * 2.5964843232777469e+02 * (4.8884637399999997e-03 + T * (-3.3017327399999998e-06 + T * (7.6611433799999996e-10 + -5.9323424399999996e-14 * T))))
    + (y[31] * 2.6808738311730184e+02 * (2.7237719300000000e-03 + T * (-3.2126659199999999e-07 + T * (-2.9374049460000001e-10 + 4.6841577599999999e-14 * T))))
    + (y[32] * 2.6808738311730184e+02 * (2.2873812200000002e-03 + T * (-1.4293707239999999e-06 + T * (3.0999715199999997e-10 + -2.2819363999999999e-14 * T))))
    + (y[33] * 1.7685453172526749e+02 * (3.6463073200000001e-03 + T * (-2.5822552999999999e-06 + T * (6.1949469900000000e-10 + -4.8855471600000001e-14 * T))))
    + (y[34] * 1.7685453172526749e+02 * (4.8985435099999997e-03 + T * (-3.5938838599999999e-06 + T * (8.8326108299999999e-10 + -7.1294230800000000e-14 * T))))
    + (y[35] * 1.3409557609186507e+02 * (2.2173300299999999e-03 + T * (-1.1513915780000000e-06 + T * (2.0093262720000002e-10 + -1.0357388000000000e-14 * T))))
    + (y[36] * 1.3195045546879959e+02 * (4.4636833599999998e-03 + T * (-3.4454555800000001e-06 + T * (8.7483481800000005e-10 + -7.2194944799999999e-14 * T))))
    + (y[37] * 1.8882343015465673e+02 * (6.0871798899999998e-03 + T * (-4.1886704399999997e-06 + T * (9.8534621099999993e-10 + -7.7081555999999996e-14 * T))))
    + (y[38] * 1.9324723067983732e+02 * (4.0225082100000002e-03 + T * (-2.8192455999999999e-06 + T * (6.7156602600000001e-10 + -5.2999986399999997e-14 * T))))
    + (y[39] * 2.0772642645958804e+03 * (2.1936539200000000e-07 + T * (-2.1505017000000000e-10 + T * (6.2159412300000005e-14 + -5.5743444799999998e-18 * T))))
    + (y[40] * 2.9679667666166921e+02 * (1.4183803000000000e-03 + T * (-1.0065620899999999e-06 + T * (2.4226663919999998e-10 + -1.9042571000000001e-14 * T))))
    + (y_N * 2.0812170463078849e+02 * (1.5613483700000001e-07 + T * (-1.5522171140000001e-10 + T * (4.5878425499999999e-14 + -4.2121797199999996e-18 * T))));
  }


  //Complete dT wrt T calculations
  jac[0] = -(spec_rates[0] * 1.70310000e+01 * (-working_temp * h[0] / cp_avg + cp[0]) + jac[1] * h[0] * rho
    + spec_rates[1] * 4.60050000e+01 * (-working_temp * h[1] / cp_avg + cp[1]) + jac[2] * h[1] * rho
    + spec_rates[2] * 3.00060000e+01 * (-working_temp * h[2] / cp_avg + cp[2]) + jac[3] * h[2] * rho
    + spec_rates[3] * 4.40130000e+01 * (-working_temp * h[3] / cp_avg + cp[3]) + jac[4] * h[3] * rho
    + spec_rates[4] * 2.01600000e+00 * (-working_temp * h[4] / cp_avg + cp[4]) + jac[5] * h[4] * rho
    + spec_rates[5] * 3.19980000e+01 * (-working_temp * h[5] / cp_avg + cp[5]) + jac[6] * h[5] * rho
    + spec_rates[6] * 4.79970000e+01 * (-working_temp * h[6] / cp_avg + cp[6]) + jac[7] * h[6] * rho
    + spec_rates[7] * 1.00800000e+00 * (-working_temp * h[7] / cp_avg + cp[7]) + jac[8] * h[7] * rho
    + spec_rates[8] * 1.59990000e+01 * (-working_temp * h[8] / cp_avg + cp[8]) + jac[9] * h[8] * rho
    + spec_rates[9] * 1.70070000e+01 * (-working_temp * h[9] / cp_avg + cp[9]) + jac[10] * h[9] * rho
    + spec_rates[10] * 3.30060000e+01 * (-working_temp * h[10] / cp_avg + cp[10]) + jac[11] * h[10] * rho
    + spec_rates[11] * 1.80150000e+01 * (-working_temp * h[11] / cp_avg + cp[11]) + jac[12] * h[11] * rho
    + spec_rates[12] * 3.40140000e+01 * (-working_temp * h[12] / cp_avg + cp[12]) + jac[13] * h[12] * rho
    + spec_rates[13] * 2.80100000e+01 * (-working_temp * h[13] / cp_avg + cp[13]) + jac[14] * h[13] * rho
    + spec_rates[14] * 4.40090000e+01 * (-working_temp * h[14] / cp_avg + cp[14]) + jac[15] * h[14] * rho
    + spec_rates[15] * 4.50170000e+01 * (-working_temp * h[15] / cp_avg + cp[15]) + jac[16] * h[15] * rho
    + spec_rates[16] * 3.00260000e+01 * (-working_temp * h[16] / cp_avg + cp[16]) + jac[17] * h[16] * rho
    + spec_rates[17] * 2.90180000e+01 * (-working_temp * h[17] / cp_avg + cp[17]) + jac[18] * h[17] * rho
    + spec_rates[18] * 1.60230000e+01 * (-working_temp * h[18] / cp_avg + cp[18]) + jac[19] * h[18] * rho
    + spec_rates[19] * 1.50150000e+01 * (-working_temp * h[19] / cp_avg + cp[19]) + jac[20] * h[19] * rho
    + spec_rates[20] * 1.40070000e+01 * (-working_temp * h[20] / cp_avg + cp[20]) + jac[21] * h[20] * rho
    + spec_rates[21] * 2.90220000e+01 * (-working_temp * h[21] / cp_avg + cp[21]) + jac[22] * h[21] * rho
    + spec_rates[22] * 3.20460000e+01 * (-working_temp * h[22] / cp_avg + cp[22]) + jac[23] * h[22] * rho
    + spec_rates[23] * 3.10380000e+01 * (-working_temp * h[23] / cp_avg + cp[23]) + jac[24] * h[23] * rho
    + spec_rates[24] * 3.00300000e+01 * (-working_temp * h[24] / cp_avg + cp[24]) + jac[25] * h[24] * rho
    + spec_rates[25] * 3.00300000e+01 * (-working_temp * h[25] / cp_avg + cp[25]) + jac[26] * h[25] * rho
    + spec_rates[26] * 3.00300000e+01 * (-working_temp * h[26] / cp_avg + cp[26]) + jac[27] * h[26] * rho
    + spec_rates[27] * 3.30300000e+01 * (-working_temp * h[27] / cp_avg + cp[27]) + jac[28] * h[27] * rho
    + spec_rates[28] * 3.20220000e+01 * (-working_temp * h[28] / cp_avg + cp[28]) + jac[29] * h[28] * rho
    + spec_rates[29] * 3.20220000e+01 * (-working_temp * h[29] / cp_avg + cp[29]) + jac[30] * h[29] * rho
    + spec_rates[30] * 3.10140000e+01 * (-working_temp * h[30] / cp_avg + cp[30]) + jac[31] * h[30] * rho
    + spec_rates[31] * 3.10140000e+01 * (-working_temp * h[31] / cp_avg + cp[31]) + jac[32] * h[31] * rho
    + spec_rates[32] * 4.70130000e+01 * (-working_temp * h[32] / cp_avg + cp[32]) + jac[33] * h[32] * rho
    + spec_rates[33] * 4.70130000e+01 * (-working_temp * h[33] / cp_avg + cp[33]) + jac[34] * h[33] * rho
    + spec_rates[34] * 6.20040000e+01 * (-working_temp * h[34] / cp_avg + cp[34]) + jac[35] * h[34] * rho
    + spec_rates[35] * 6.30120000e+01 * (-working_temp * h[35] / cp_avg + cp[35]) + jac[36] * h[35] * rho
    + spec_rates[36] * 4.40330000e+01 * (-working_temp * h[36] / cp_avg + cp[36]) + jac[37] * h[36] * rho
    + spec_rates[37] * 4.30250000e+01 * (-working_temp * h[37] / cp_avg + cp[37]) + jac[38] * h[37] * rho
    + spec_rates[38] * 4.00260200e+00 * (-working_temp * h[38] / cp_avg + cp[38]) + jac[39] * h[38] * rho
    + spec_rates[39] * 2.80140000e+01 * (-working_temp * h[39] / cp_avg + cp[39]) + jac[40] * h[39] * rho
    + spec_rates[40] * 3.99500000e+01 * (-working_temp * h[40] / cp_avg + cp[40])) / (rho * cp_avg);
} // end eval_jacob

