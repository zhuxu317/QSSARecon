#include "header.h"
#include "chem_utils.h"
#include "rates.h"

#if defined(CONP)

void dydt (const double t, const double pres, const double * __restrict__ y, double * __restrict__ dy) {

  // species molar concentrations
  double conc[125];
  double y_N;
  double mw_avg;
  double rho;
  eval_conc (y[0], pres, &y[1], &y_N, &mw_avg, &rho, conc);

  // local arrays holding reaction rates
  double fwd_rates[1099];
  double rev_rates[1071];
  eval_rxn_rates (y[0], pres, conc, fwd_rates, rev_rates);

  // get pressure modifications to reaction rates
  double pres_mod[106];
  get_rxn_pres_mod (y[0], pres, conc, pres_mod);

  // evaluate species molar net production rates
  double dy_N;
  eval_spec_rates (fwd_rates, rev_rates, pres_mod, &dy[1], &dy_N);
  // local array holding constant pressure specific heat
  double cp[125];
  eval_cp (y[0], cp);

  // constant pressure mass-average specific heat
  double cp_avg = (cp[0] * y[1]) + (cp[1] * y[2]) + (cp[2] * y[3]) + (cp[3] * y[4])
              + (cp[4] * y[5]) + (cp[5] * y[6]) + (cp[6] * y[7]) + (cp[7] * y[8])
              + (cp[8] * y[9]) + (cp[9] * y[10]) + (cp[10] * y[11]) + (cp[11] * y[12])
              + (cp[12] * y[13]) + (cp[13] * y[14]) + (cp[14] * y[15]) + (cp[15] * y[16])
              + (cp[16] * y[17]) + (cp[17] * y[18]) + (cp[18] * y[19]) + (cp[19] * y[20])
              + (cp[20] * y[21]) + (cp[21] * y[22]) + (cp[22] * y[23]) + (cp[23] * y[24])
              + (cp[24] * y[25]) + (cp[25] * y[26]) + (cp[26] * y[27]) + (cp[27] * y[28])
              + (cp[28] * y[29]) + (cp[29] * y[30]) + (cp[30] * y[31]) + (cp[31] * y[32])
              + (cp[32] * y[33]) + (cp[33] * y[34]) + (cp[34] * y[35]) + (cp[35] * y[36])
              + (cp[36] * y[37]) + (cp[37] * y[38]) + (cp[38] * y[39]) + (cp[39] * y[40])
              + (cp[40] * y[41]) + (cp[41] * y[42]) + (cp[42] * y[43]) + (cp[43] * y[44])
              + (cp[44] * y[45]) + (cp[45] * y[46]) + (cp[46] * y[47]) + (cp[47] * y[48])
              + (cp[48] * y[49]) + (cp[49] * y[50]) + (cp[50] * y[51]) + (cp[51] * y[52])
              + (cp[52] * y[53]) + (cp[53] * y[54]) + (cp[54] * y[55]) + (cp[55] * y[56])
              + (cp[56] * y[57]) + (cp[57] * y[58]) + (cp[58] * y[59]) + (cp[59] * y[60])
              + (cp[60] * y[61]) + (cp[61] * y[62]) + (cp[62] * y[63]) + (cp[63] * y[64])
              + (cp[64] * y[65]) + (cp[65] * y[66]) + (cp[66] * y[67]) + (cp[67] * y[68])
              + (cp[68] * y[69]) + (cp[69] * y[70]) + (cp[70] * y[71]) + (cp[71] * y[72])
              + (cp[72] * y[73]) + (cp[73] * y[74]) + (cp[74] * y[75]) + (cp[75] * y[76])
              + (cp[76] * y[77]) + (cp[77] * y[78]) + (cp[78] * y[79]) + (cp[79] * y[80])
              + (cp[80] * y[81]) + (cp[81] * y[82]) + (cp[82] * y[83]) + (cp[83] * y[84])
              + (cp[84] * y[85]) + (cp[85] * y[86]) + (cp[86] * y[87]) + (cp[87] * y[88])
              + (cp[88] * y[89]) + (cp[89] * y[90]) + (cp[90] * y[91]) + (cp[91] * y[92])
              + (cp[92] * y[93]) + (cp[93] * y[94]) + (cp[94] * y[95]) + (cp[95] * y[96])
              + (cp[96] * y[97]) + (cp[97] * y[98]) + (cp[98] * y[99]) + (cp[99] * y[100])
              + (cp[100] * y[101]) + (cp[101] * y[102]) + (cp[102] * y[103])
              + (cp[103] * y[104]) + (cp[104] * y[105]) + (cp[105] * y[106])
              + (cp[106] * y[107]) + (cp[107] * y[108]) + (cp[108] * y[109])
              + (cp[109] * y[110]) + (cp[110] * y[111]) + (cp[111] * y[112])
              + (cp[112] * y[113]) + (cp[113] * y[114]) + (cp[114] * y[115])
              + (cp[115] * y[116]) + (cp[116] * y[117]) + (cp[117] * y[118])
              + (cp[118] * y[119]) + (cp[119] * y[120]) + (cp[120] * y[121])
              + (cp[121] * y[122]) + (cp[122] * y[123]) + (cp[123] * y[124]) + (cp[124] * y_N);

  // local array for species enthalpies
  double h[125];
  eval_h(y[0], h);
  // rate of change of temperature
  dy[0] = (-1.0 / (rho * cp_avg)) * ((dy[2] * h[1] * 1.0080000000000000e+00)
        + (dy[3] * h[2] * 1.5999000000000001e+01) + (dy[4] * h[3] * 1.7007000000000001e+01)
        + (dy[5] * h[4] * 2.0160000000000000e+00) + (dy[6] * h[5] * 3.1998000000000001e+01)
        + (dy[7] * h[6] * 3.3006000000000000e+01) + (dy[8] * h[7] * 3.4014000000000003e+01)
        + (dy[9] * h[8] * 1.8015000000000001e+01) + (dy[10] * h[9] * 1.7007000000000001e+01)
        + (dy[11] * h[10] * 2.8009999999999998e+01) + (dy[12] * h[11] * 4.4009000000000000e+01)
        + (dy[13] * h[12] * 2.9018000000000001e+01) + (dy[14] * h[13] * 3.0026000000000000e+01)
        + (dy[15] * h[14] * 1.3018999999999998e+01) + (dy[16] * h[15] * 1.2010999999999999e+01)
        + (dy[17] * h[16] * 1.4026999999999999e+01) + (dy[18] * h[17] * 1.4026999999999999e+01)
        + (dy[19] * h[18] * 2.6037999999999997e+01) + (dy[20] * h[19] * 1.5035000000000000e+01)
        + (dy[21] * h[20] * 1.6042999999999999e+01) + (dy[22] * h[21] * 4.6024999999999999e+01)
        + (dy[23] * h[22] * 3.1033999999999999e+01) + (dy[24] * h[23] * 4.5016999999999996e+01)
        + (dy[25] * h[24] * 3.1033999999999999e+01) + (dy[26] * h[25] * 2.8053999999999998e+01)
        + (dy[27] * h[26] * 4.2036999999999999e+01) + (dy[28] * h[27] * 3.0070000000000000e+01)
        + (dy[29] * h[28] * 3.2042000000000002e+01) + (dy[30] * h[29] * 4.7033000000000001e+01)
        + (dy[31] * h[30] * 4.8040999999999997e+01) + (dy[32] * h[31] * 2.7045999999999999e+01)
        + (dy[33] * h[32] * 2.9061999999999998e+01) + (dy[34] * h[33] * 4.6069000000000003e+01)
        + (dy[35] * h[34] * 4.5061000000000000e+01) + (dy[36] * h[35] * 4.4052999999999997e+01)
        + (dy[37] * h[36] * 4.3045000000000002e+01) + (dy[38] * h[37] * 4.7033000000000001e+01)
        + (dy[39] * h[38] * 2.5029999999999998e+01) + (dy[40] * h[39] * 2.4021999999999998e+01)
        + (dy[41] * h[40] * 4.0021000000000001e+01) + (dy[42] * h[41] * 4.1028999999999996e+01)
        + (dy[43] * h[42] * 2.6037999999999997e+01) + (dy[44] * h[43] * 3.9057000000000002e+01)
        + (dy[45] * h[44] * 5.0059999999999995e+01) + (dy[46] * h[45] * 4.1073000000000000e+01)
        + (dy[47] * h[46] * 4.3045000000000002e+01) + (dy[48] * h[47] * 5.9043999999999997e+01)
        + (dy[49] * h[48] * 4.2036999999999999e+01) + (dy[50] * h[49] * 5.2075999999999993e+01)
        + (dy[51] * h[50] * 4.3045000000000002e+01) + (dy[52] * h[51] * 5.6064000000000000e+01)
        + (dy[53] * h[52] * 5.6064000000000000e+01) + (dy[54] * h[53] * 4.2036999999999999e+01)
        + (dy[55] * h[54] * 5.8036000000000001e+01) + (dy[56] * h[55] * 5.7027999999999999e+01)
        + (dy[57] * h[56] * 5.9043999999999997e+01) + (dy[58] * h[57] * 7.5043000000000006e+01)
        + (dy[59] * h[58] * 7.6051000000000002e+01) + (dy[60] * h[59] * 4.2081000000000003e+01)
        + (dy[61] * h[60] * 4.4097000000000001e+01) + (dy[62] * h[61] * 4.3088999999999999e+01)
        + (dy[63] * h[62] * 4.3088999999999999e+01) + (dy[64] * h[63] * 4.0064999999999998e+01)
        + (dy[65] * h[64] * 4.0064999999999998e+01) + (dy[66] * h[65] * 4.4052999999999997e+01)
        + (dy[67] * h[66] * 4.5061000000000000e+01) + (dy[68] * h[67] * 4.5061000000000000e+01)
        + (dy[69] * h[68] * 6.1060000000000002e+01) + (dy[70] * h[69] * 4.4052999999999997e+01)
        + (dy[71] * h[70] * 6.2067999999999998e+01) + (dy[72] * h[71] * 5.8080000000000005e+01)
        + (dy[73] * h[72] * 5.7072000000000003e+01) + (dy[74] * h[73] * 6.1060000000000002e+01)
        + (dy[75] * h[74] * 4.3045000000000002e+01) + (dy[76] * h[75] * 4.6069000000000003e+01)
        + (dy[77] * h[76] * 4.5061000000000000e+01) + (dy[78] * h[77] * 7.7058999999999997e+01)
        + (dy[79] * h[78] * 7.8067000000000007e+01) + (dy[80] * h[79] * 6.1060000000000002e+01)
        + (dy[81] * h[80] * 6.0052000000000000e+01) + (dy[82] * h[81] * 5.9043999999999997e+01)
        + (dy[83] * h[82] * 5.9043999999999997e+01) + (dy[84] * h[83] * 7.7058999999999997e+01)
        + (dy[85] * h[84] * 1.0905700000000000e+02) + (dy[86] * h[85] * 9.2049999999999997e+01)
        + (dy[87] * h[86] * 7.5043000000000006e+01) + (dy[88] * h[87] * 7.5043000000000006e+01)
        + (dy[89] * h[88] * 4.7033000000000001e+01) + (dy[90] * h[89] * 1.3018999999999998e+01)
        + (dy[91] * h[90] * 1.4007000000000000e+01) + (dy[92] * h[91] * 3.0006000000000000e+01)
        + (dy[93] * h[92] * 4.4012999999999998e+01) + (dy[94] * h[93] * 4.6005000000000003e+01)
        + (dy[95] * h[94] * 1.5015000000000001e+01) + (dy[96] * h[95] * 1.6023000000000000e+01)
        + (dy[97] * h[96] * 1.7030999999999999e+01) + (dy[98] * h[97] * 3.1014000000000003e+01)
        + (dy[99] * h[98] * 4.7012999999999998e+01) + (dy[100] * h[99] * 3.2021999999999998e+01)
        + (dy[101] * h[100] * 2.9021999999999998e+01) + (dy[102] * h[101] * 3.0030000000000001e+01)
        + (dy[103] * h[102] * 3.1038000000000000e+01) + (dy[104] * h[103] * 3.2045999999999999e+01)
        + (dy[105] * h[104] * 3.0030000000000001e+01) + (dy[106] * h[105] * 3.2021999999999998e+01)
        + (dy[107] * h[106] * 3.3030000000000001e+01) + (dy[108] * h[107] * 4.7012999999999998e+01)
        + (dy[109] * h[108] * 6.2003999999999998e+01) + (dy[110] * h[109] * 6.3012000000000000e+01)
        + (dy[111] * h[110] * 2.6018000000000001e+01) + (dy[112] * h[111] * 2.7025999999999996e+01)
        + (dy[113] * h[112] * 4.3024999999999999e+01) + (dy[114] * h[113] * 4.0024999999999999e+01)
        + (dy[115] * h[114] * 2.7025999999999996e+01) + (dy[116] * h[115] * 4.1033000000000001e+01)
        + (dy[117] * h[116] * 2.8033999999999999e+01) + (dy[118] * h[117] * 5.2036000000000001e+01)
        + (dy[119] * h[118] * 4.3024999999999999e+01) + (dy[120] * h[119] * 4.3024999999999999e+01)
        + (dy[121] * h[120] * 4.2016999999999996e+01) + (dy[122] * h[121] * 3.1014000000000003e+01)
        + (dy[123] * h[122] * 2.8033999999999999e+01) + (dy[124] * h[123] * 2.8013999999999999e+01));

  // calculate rate of change of species mass fractions
  dy[1] *= (4.0026020000000004e+00 / rho);
  dy[2] *= (1.0080000000000000e+00 / rho);
  dy[3] *= (1.5999000000000001e+01 / rho);
  dy[4] *= (1.7007000000000001e+01 / rho);
  dy[5] *= (2.0160000000000000e+00 / rho);
  dy[6] *= (3.1998000000000001e+01 / rho);
  dy[7] *= (3.3006000000000000e+01 / rho);
  dy[8] *= (3.4014000000000003e+01 / rho);
  dy[9] *= (1.8015000000000001e+01 / rho);
  dy[10] *= (1.7007000000000001e+01 / rho);
  dy[11] *= (2.8009999999999998e+01 / rho);
  dy[12] *= (4.4009000000000000e+01 / rho);
  dy[13] *= (2.9018000000000001e+01 / rho);
  dy[14] *= (3.0026000000000000e+01 / rho);
  dy[15] *= (1.3018999999999998e+01 / rho);
  dy[16] *= (1.2010999999999999e+01 / rho);
  dy[17] *= (1.4026999999999999e+01 / rho);
  dy[18] *= (1.4026999999999999e+01 / rho);
  dy[19] *= (2.6037999999999997e+01 / rho);
  dy[20] *= (1.5035000000000000e+01 / rho);
  dy[21] *= (1.6042999999999999e+01 / rho);
  dy[22] *= (4.6024999999999999e+01 / rho);
  dy[23] *= (3.1033999999999999e+01 / rho);
  dy[24] *= (4.5016999999999996e+01 / rho);
  dy[25] *= (3.1033999999999999e+01 / rho);
  dy[26] *= (2.8053999999999998e+01 / rho);
  dy[27] *= (4.2036999999999999e+01 / rho);
  dy[28] *= (3.0070000000000000e+01 / rho);
  dy[29] *= (3.2042000000000002e+01 / rho);
  dy[30] *= (4.7033000000000001e+01 / rho);
  dy[31] *= (4.8040999999999997e+01 / rho);
  dy[32] *= (2.7045999999999999e+01 / rho);
  dy[33] *= (2.9061999999999998e+01 / rho);
  dy[34] *= (4.6069000000000003e+01 / rho);
  dy[35] *= (4.5061000000000000e+01 / rho);
  dy[36] *= (4.4052999999999997e+01 / rho);
  dy[37] *= (4.3045000000000002e+01 / rho);
  dy[38] *= (4.7033000000000001e+01 / rho);
  dy[39] *= (2.5029999999999998e+01 / rho);
  dy[40] *= (2.4021999999999998e+01 / rho);
  dy[41] *= (4.0021000000000001e+01 / rho);
  dy[42] *= (4.1028999999999996e+01 / rho);
  dy[43] *= (2.6037999999999997e+01 / rho);
  dy[44] *= (3.9057000000000002e+01 / rho);
  dy[45] *= (5.0059999999999995e+01 / rho);
  dy[46] *= (4.1073000000000000e+01 / rho);
  dy[47] *= (4.3045000000000002e+01 / rho);
  dy[48] *= (5.9043999999999997e+01 / rho);
  dy[49] *= (4.2036999999999999e+01 / rho);
  dy[50] *= (5.2075999999999993e+01 / rho);
  dy[51] *= (4.3045000000000002e+01 / rho);
  dy[52] *= (5.6064000000000000e+01 / rho);
  dy[53] *= (5.6064000000000000e+01 / rho);
  dy[54] *= (4.2036999999999999e+01 / rho);
  dy[55] *= (5.8036000000000001e+01 / rho);
  dy[56] *= (5.7027999999999999e+01 / rho);
  dy[57] *= (5.9043999999999997e+01 / rho);
  dy[58] *= (7.5043000000000006e+01 / rho);
  dy[59] *= (7.6051000000000002e+01 / rho);
  dy[60] *= (4.2081000000000003e+01 / rho);
  dy[61] *= (4.4097000000000001e+01 / rho);
  dy[62] *= (4.3088999999999999e+01 / rho);
  dy[63] *= (4.3088999999999999e+01 / rho);
  dy[64] *= (4.0064999999999998e+01 / rho);
  dy[65] *= (4.0064999999999998e+01 / rho);
  dy[66] *= (4.4052999999999997e+01 / rho);
  dy[67] *= (4.5061000000000000e+01 / rho);
  dy[68] *= (4.5061000000000000e+01 / rho);
  dy[69] *= (6.1060000000000002e+01 / rho);
  dy[70] *= (4.4052999999999997e+01 / rho);
  dy[71] *= (6.2067999999999998e+01 / rho);
  dy[72] *= (5.8080000000000005e+01 / rho);
  dy[73] *= (5.7072000000000003e+01 / rho);
  dy[74] *= (6.1060000000000002e+01 / rho);
  dy[75] *= (4.3045000000000002e+01 / rho);
  dy[76] *= (4.6069000000000003e+01 / rho);
  dy[77] *= (4.5061000000000000e+01 / rho);
  dy[78] *= (7.7058999999999997e+01 / rho);
  dy[79] *= (7.8067000000000007e+01 / rho);
  dy[80] *= (6.1060000000000002e+01 / rho);
  dy[81] *= (6.0052000000000000e+01 / rho);
  dy[82] *= (5.9043999999999997e+01 / rho);
  dy[83] *= (5.9043999999999997e+01 / rho);
  dy[84] *= (7.7058999999999997e+01 / rho);
  dy[85] *= (1.0905700000000000e+02 / rho);
  dy[86] *= (9.2049999999999997e+01 / rho);
  dy[87] *= (7.5043000000000006e+01 / rho);
  dy[88] *= (7.5043000000000006e+01 / rho);
  dy[89] *= (4.7033000000000001e+01 / rho);
  dy[90] *= (1.3018999999999998e+01 / rho);
  dy[91] *= (1.4007000000000000e+01 / rho);
  dy[92] *= (3.0006000000000000e+01 / rho);
  dy[93] *= (4.4012999999999998e+01 / rho);
  dy[94] *= (4.6005000000000003e+01 / rho);
  dy[95] *= (1.5015000000000001e+01 / rho);
  dy[96] *= (1.6023000000000000e+01 / rho);
  dy[97] *= (1.7030999999999999e+01 / rho);
  dy[98] *= (3.1014000000000003e+01 / rho);
  dy[99] *= (4.7012999999999998e+01 / rho);
  dy[100] *= (3.2021999999999998e+01 / rho);
  dy[101] *= (2.9021999999999998e+01 / rho);
  dy[102] *= (3.0030000000000001e+01 / rho);
  dy[103] *= (3.1038000000000000e+01 / rho);
  dy[104] *= (3.2045999999999999e+01 / rho);
  dy[105] *= (3.0030000000000001e+01 / rho);
  dy[106] *= (3.2021999999999998e+01 / rho);
  dy[107] *= (3.3030000000000001e+01 / rho);
  dy[108] *= (4.7012999999999998e+01 / rho);
  dy[109] *= (6.2003999999999998e+01 / rho);
  dy[110] *= (6.3012000000000000e+01 / rho);
  dy[111] *= (2.6018000000000001e+01 / rho);
  dy[112] *= (2.7025999999999996e+01 / rho);
  dy[113] *= (4.3024999999999999e+01 / rho);
  dy[114] *= (4.0024999999999999e+01 / rho);
  dy[115] *= (2.7025999999999996e+01 / rho);
  dy[116] *= (4.1033000000000001e+01 / rho);
  dy[117] *= (2.8033999999999999e+01 / rho);
  dy[118] *= (5.2036000000000001e+01 / rho);
  dy[119] *= (4.3024999999999999e+01 / rho);
  dy[120] *= (4.3024999999999999e+01 / rho);
  dy[121] *= (4.2016999999999996e+01 / rho);
  dy[122] *= (3.1014000000000003e+01 / rho);
  dy[123] *= (2.8033999999999999e+01 / rho);
  dy[124] *= (2.8013999999999999e+01 / rho);

} // end dydt

#elif defined(CONV)

void dydt (const double t, const double rho, const double * __restrict__ y, double * __restrict__ dy) {

  // species molar concentrations
  double conc[125];
  double y_N;
  double mw_avg;
  double pres;
  eval_conc_rho (y[0]rho, &y[1], &y_N, &mw_avg, &pres, conc);

  // local arrays holding reaction rates
  double fwd_rates[1099];
  double rev_rates[1071];
  eval_rxn_rates (y[0], pres, conc, fwd_rates, rev_rates);

  // get pressure modifications to reaction rates
  double pres_mod[106];
  get_rxn_pres_mod (y[0], pres, conc, pres_mod);

  // evaluate species molar net production rates
  double dy_N;  eval_spec_rates (fwd_rates, rev_rates, pres_mod, &dy[1], &dy_N);

  double cv[125];
  eval_cv(y[0], cv);

  // constant volume mass-average specific heat
  double cv_avg = (cv[0] * y[1]) + (cv[1] * y[2]) + (cv[2] * y[3]) + (cv[3] * y[4])
              + (cv[4] * y[5]) + (cv[5] * y[6]) + (cv[6] * y[7]) + (cv[7] * y[8])
              + (cv[8] * y[9]) + (cv[9] * y[10]) + (cv[10] * y[11]) + (cv[11] * y[12])
              + (cv[12] * y[13]) + (cv[13] * y[14]) + (cv[14] * y[15]) + (cv[15] * y[16])
              + (cv[16] * y[17]) + (cv[17] * y[18]) + (cv[18] * y[19]) + (cv[19] * y[20])
              + (cv[20] * y[21]) + (cv[21] * y[22]) + (cv[22] * y[23]) + (cv[23] * y[24])
              + (cv[24] * y[25]) + (cv[25] * y[26]) + (cv[26] * y[27]) + (cv[27] * y[28])
              + (cv[28] * y[29]) + (cv[29] * y[30]) + (cv[30] * y[31]) + (cv[31] * y[32])
              + (cv[32] * y[33]) + (cv[33] * y[34]) + (cv[34] * y[35]) + (cv[35] * y[36])
              + (cv[36] * y[37]) + (cv[37] * y[38]) + (cv[38] * y[39]) + (cv[39] * y[40])
              + (cv[40] * y[41]) + (cv[41] * y[42]) + (cv[42] * y[43]) + (cv[43] * y[44])
              + (cv[44] * y[45]) + (cv[45] * y[46]) + (cv[46] * y[47]) + (cv[47] * y[48])
              + (cv[48] * y[49]) + (cv[49] * y[50]) + (cv[50] * y[51]) + (cv[51] * y[52])
              + (cv[52] * y[53]) + (cv[53] * y[54]) + (cv[54] * y[55]) + (cv[55] * y[56])
              + (cv[56] * y[57]) + (cv[57] * y[58]) + (cv[58] * y[59]) + (cv[59] * y[60])
              + (cv[60] * y[61]) + (cv[61] * y[62]) + (cv[62] * y[63]) + (cv[63] * y[64])
              + (cv[64] * y[65]) + (cv[65] * y[66]) + (cv[66] * y[67]) + (cv[67] * y[68])
              + (cv[68] * y[69]) + (cv[69] * y[70]) + (cv[70] * y[71]) + (cv[71] * y[72])
              + (cv[72] * y[73]) + (cv[73] * y[74]) + (cv[74] * y[75]) + (cv[75] * y[76])
              + (cv[76] * y[77]) + (cv[77] * y[78]) + (cv[78] * y[79]) + (cv[79] * y[80])
              + (cv[80] * y[81]) + (cv[81] * y[82]) + (cv[82] * y[83]) + (cv[83] * y[84])
              + (cv[84] * y[85]) + (cv[85] * y[86]) + (cv[86] * y[87]) + (cv[87] * y[88])
              + (cv[88] * y[89]) + (cv[89] * y[90]) + (cv[90] * y[91]) + (cv[91] * y[92])
              + (cv[92] * y[93]) + (cv[93] * y[94]) + (cv[94] * y[95]) + (cv[95] * y[96])
              + (cv[96] * y[97]) + (cv[97] * y[98]) + (cv[98] * y[99]) + (cv[99] * y[100])
              + (cv[100] * y[101]) + (cv[101] * y[102]) + (cv[102] * y[103])
              + (cv[103] * y[104]) + (cv[104] * y[105]) + (cv[105] * y[106])
              + (cv[106] * y[107]) + (cv[107] * y[108]) + (cv[108] * y[109])
              + (cv[109] * y[110]) + (cv[110] * y[111]) + (cv[111] * y[112])
              + (cv[112] * y[113]) + (cv[113] * y[114]) + (cv[114] * y[115])
              + (cv[115] * y[116]) + (cv[116] * y[117]) + (cv[117] * y[118])
              + (cv[118] * y[119]) + (cv[119] * y[120]) + (cv[120] * y[121])
              + (cv[121] * y[122]) + (cv[122] * y[123]) + (cv[123] * y[124])(cv[124] * y_N);

  // local array for species internal energies
  double u[125];
  eval_u (y[0], u);

  // rate of change of temperature
  dy[0] = (-1.0 / (rho * cv_avg)) * ((dy[2] * u[1] * 1.0080000000000000e+00)
        + (dy[3] * u[2] * 1.5999000000000001e+01) + (dy[4] * u[3] * 1.7007000000000001e+01)
        + (dy[5] * u[4] * 2.0160000000000000e+00) + (dy[6] * u[5] * 3.1998000000000001e+01)
        + (dy[7] * u[6] * 3.3006000000000000e+01) + (dy[8] * u[7] * 3.4014000000000003e+01)
        + (dy[9] * u[8] * 1.8015000000000001e+01) + (dy[10] * u[9] * 1.7007000000000001e+01)
        + (dy[11] * u[10] * 2.8009999999999998e+01) + (dy[12] * u[11] * 4.4009000000000000e+01)
        + (dy[13] * u[12] * 2.9018000000000001e+01) + (dy[14] * u[13] * 3.0026000000000000e+01)
        + (dy[15] * u[14] * 1.3018999999999998e+01) + (dy[16] * u[15] * 1.2010999999999999e+01)
        + (dy[17] * u[16] * 1.4026999999999999e+01) + (dy[18] * u[17] * 1.4026999999999999e+01)
        + (dy[19] * u[18] * 2.6037999999999997e+01) + (dy[20] * u[19] * 1.5035000000000000e+01)
        + (dy[21] * u[20] * 1.6042999999999999e+01) + (dy[22] * u[21] * 4.6024999999999999e+01)
        + (dy[23] * u[22] * 3.1033999999999999e+01) + (dy[24] * u[23] * 4.5016999999999996e+01)
        + (dy[25] * u[24] * 3.1033999999999999e+01) + (dy[26] * u[25] * 2.8053999999999998e+01)
        + (dy[27] * u[26] * 4.2036999999999999e+01) + (dy[28] * u[27] * 3.0070000000000000e+01)
        + (dy[29] * u[28] * 3.2042000000000002e+01) + (dy[30] * u[29] * 4.7033000000000001e+01)
        + (dy[31] * u[30] * 4.8040999999999997e+01) + (dy[32] * u[31] * 2.7045999999999999e+01)
        + (dy[33] * u[32] * 2.9061999999999998e+01) + (dy[34] * u[33] * 4.6069000000000003e+01)
        + (dy[35] * u[34] * 4.5061000000000000e+01) + (dy[36] * u[35] * 4.4052999999999997e+01)
        + (dy[37] * u[36] * 4.3045000000000002e+01) + (dy[38] * u[37] * 4.7033000000000001e+01)
        + (dy[39] * u[38] * 2.5029999999999998e+01) + (dy[40] * u[39] * 2.4021999999999998e+01)
        + (dy[41] * u[40] * 4.0021000000000001e+01) + (dy[42] * u[41] * 4.1028999999999996e+01)
        + (dy[43] * u[42] * 2.6037999999999997e+01) + (dy[44] * u[43] * 3.9057000000000002e+01)
        + (dy[45] * u[44] * 5.0059999999999995e+01) + (dy[46] * u[45] * 4.1073000000000000e+01)
        + (dy[47] * u[46] * 4.3045000000000002e+01) + (dy[48] * u[47] * 5.9043999999999997e+01)
        + (dy[49] * u[48] * 4.2036999999999999e+01) + (dy[50] * u[49] * 5.2075999999999993e+01)
        + (dy[51] * u[50] * 4.3045000000000002e+01) + (dy[52] * u[51] * 5.6064000000000000e+01)
        + (dy[53] * u[52] * 5.6064000000000000e+01) + (dy[54] * u[53] * 4.2036999999999999e+01)
        + (dy[55] * u[54] * 5.8036000000000001e+01) + (dy[56] * u[55] * 5.7027999999999999e+01)
        + (dy[57] * u[56] * 5.9043999999999997e+01) + (dy[58] * u[57] * 7.5043000000000006e+01)
        + (dy[59] * u[58] * 7.6051000000000002e+01) + (dy[60] * u[59] * 4.2081000000000003e+01)
        + (dy[61] * u[60] * 4.4097000000000001e+01) + (dy[62] * u[61] * 4.3088999999999999e+01)
        + (dy[63] * u[62] * 4.3088999999999999e+01) + (dy[64] * u[63] * 4.0064999999999998e+01)
        + (dy[65] * u[64] * 4.0064999999999998e+01) + (dy[66] * u[65] * 4.4052999999999997e+01)
        + (dy[67] * u[66] * 4.5061000000000000e+01) + (dy[68] * u[67] * 4.5061000000000000e+01)
        + (dy[69] * u[68] * 6.1060000000000002e+01) + (dy[70] * u[69] * 4.4052999999999997e+01)
        + (dy[71] * u[70] * 6.2067999999999998e+01) + (dy[72] * u[71] * 5.8080000000000005e+01)
        + (dy[73] * u[72] * 5.7072000000000003e+01) + (dy[74] * u[73] * 6.1060000000000002e+01)
        + (dy[75] * u[74] * 4.3045000000000002e+01) + (dy[76] * u[75] * 4.6069000000000003e+01)
        + (dy[77] * u[76] * 4.5061000000000000e+01) + (dy[78] * u[77] * 7.7058999999999997e+01)
        + (dy[79] * u[78] * 7.8067000000000007e+01) + (dy[80] * u[79] * 6.1060000000000002e+01)
        + (dy[81] * u[80] * 6.0052000000000000e+01) + (dy[82] * u[81] * 5.9043999999999997e+01)
        + (dy[83] * u[82] * 5.9043999999999997e+01) + (dy[84] * u[83] * 7.7058999999999997e+01)
        + (dy[85] * u[84] * 1.0905700000000000e+02) + (dy[86] * u[85] * 9.2049999999999997e+01)
        + (dy[87] * u[86] * 7.5043000000000006e+01) + (dy[88] * u[87] * 7.5043000000000006e+01)
        + (dy[89] * u[88] * 4.7033000000000001e+01) + (dy[90] * u[89] * 1.3018999999999998e+01)
        + (dy[91] * u[90] * 1.4007000000000000e+01) + (dy[92] * u[91] * 3.0006000000000000e+01)
        + (dy[93] * u[92] * 4.4012999999999998e+01) + (dy[94] * u[93] * 4.6005000000000003e+01)
        + (dy[95] * u[94] * 1.5015000000000001e+01) + (dy[96] * u[95] * 1.6023000000000000e+01)
        + (dy[97] * u[96] * 1.7030999999999999e+01) + (dy[98] * u[97] * 3.1014000000000003e+01)
        + (dy[99] * u[98] * 4.7012999999999998e+01) + (dy[100] * u[99] * 3.2021999999999998e+01)
        + (dy[101] * u[100] * 2.9021999999999998e+01) + (dy[102] * u[101] * 3.0030000000000001e+01)
        + (dy[103] * u[102] * 3.1038000000000000e+01) + (dy[104] * u[103] * 3.2045999999999999e+01)
        + (dy[105] * u[104] * 3.0030000000000001e+01) + (dy[106] * u[105] * 3.2021999999999998e+01)
        + (dy[107] * u[106] * 3.3030000000000001e+01) + (dy[108] * u[107] * 4.7012999999999998e+01)
        + (dy[109] * u[108] * 6.2003999999999998e+01) + (dy[110] * u[109] * 6.3012000000000000e+01)
        + (dy[111] * u[110] * 2.6018000000000001e+01) + (dy[112] * u[111] * 2.7025999999999996e+01)
        + (dy[113] * u[112] * 4.3024999999999999e+01) + (dy[114] * u[113] * 4.0024999999999999e+01)
        + (dy[115] * u[114] * 2.7025999999999996e+01) + (dy[116] * u[115] * 4.1033000000000001e+01)
        + (dy[117] * u[116] * 2.8033999999999999e+01) + (dy[118] * u[117] * 5.2036000000000001e+01)
        + (dy[119] * u[118] * 4.3024999999999999e+01) + (dy[120] * u[119] * 4.3024999999999999e+01)
        + (dy[121] * u[120] * 4.2016999999999996e+01) + (dy[122] * u[121] * 3.1014000000000003e+01)
        + (dy[123] * u[122] * 2.8033999999999999e+01) + (dy[124] * u[123] * 2.8013999999999999e+01));

  // calculate rate of change of species mass fractions
  dy[1] *= (4.0026020000000004e+00 / rho);
  dy[2] *= (1.0080000000000000e+00 / rho);
  dy[3] *= (1.5999000000000001e+01 / rho);
  dy[4] *= (1.7007000000000001e+01 / rho);
  dy[5] *= (2.0160000000000000e+00 / rho);
  dy[6] *= (3.1998000000000001e+01 / rho);
  dy[7] *= (3.3006000000000000e+01 / rho);
  dy[8] *= (3.4014000000000003e+01 / rho);
  dy[9] *= (1.8015000000000001e+01 / rho);
  dy[10] *= (1.7007000000000001e+01 / rho);
  dy[11] *= (2.8009999999999998e+01 / rho);
  dy[12] *= (4.4009000000000000e+01 / rho);
  dy[13] *= (2.9018000000000001e+01 / rho);
  dy[14] *= (3.0026000000000000e+01 / rho);
  dy[15] *= (1.3018999999999998e+01 / rho);
  dy[16] *= (1.2010999999999999e+01 / rho);
  dy[17] *= (1.4026999999999999e+01 / rho);
  dy[18] *= (1.4026999999999999e+01 / rho);
  dy[19] *= (2.6037999999999997e+01 / rho);
  dy[20] *= (1.5035000000000000e+01 / rho);
  dy[21] *= (1.6042999999999999e+01 / rho);
  dy[22] *= (4.6024999999999999e+01 / rho);
  dy[23] *= (3.1033999999999999e+01 / rho);
  dy[24] *= (4.5016999999999996e+01 / rho);
  dy[25] *= (3.1033999999999999e+01 / rho);
  dy[26] *= (2.8053999999999998e+01 / rho);
  dy[27] *= (4.2036999999999999e+01 / rho);
  dy[28] *= (3.0070000000000000e+01 / rho);
  dy[29] *= (3.2042000000000002e+01 / rho);
  dy[30] *= (4.7033000000000001e+01 / rho);
  dy[31] *= (4.8040999999999997e+01 / rho);
  dy[32] *= (2.7045999999999999e+01 / rho);
  dy[33] *= (2.9061999999999998e+01 / rho);
  dy[34] *= (4.6069000000000003e+01 / rho);
  dy[35] *= (4.5061000000000000e+01 / rho);
  dy[36] *= (4.4052999999999997e+01 / rho);
  dy[37] *= (4.3045000000000002e+01 / rho);
  dy[38] *= (4.7033000000000001e+01 / rho);
  dy[39] *= (2.5029999999999998e+01 / rho);
  dy[40] *= (2.4021999999999998e+01 / rho);
  dy[41] *= (4.0021000000000001e+01 / rho);
  dy[42] *= (4.1028999999999996e+01 / rho);
  dy[43] *= (2.6037999999999997e+01 / rho);
  dy[44] *= (3.9057000000000002e+01 / rho);
  dy[45] *= (5.0059999999999995e+01 / rho);
  dy[46] *= (4.1073000000000000e+01 / rho);
  dy[47] *= (4.3045000000000002e+01 / rho);
  dy[48] *= (5.9043999999999997e+01 / rho);
  dy[49] *= (4.2036999999999999e+01 / rho);
  dy[50] *= (5.2075999999999993e+01 / rho);
  dy[51] *= (4.3045000000000002e+01 / rho);
  dy[52] *= (5.6064000000000000e+01 / rho);
  dy[53] *= (5.6064000000000000e+01 / rho);
  dy[54] *= (4.2036999999999999e+01 / rho);
  dy[55] *= (5.8036000000000001e+01 / rho);
  dy[56] *= (5.7027999999999999e+01 / rho);
  dy[57] *= (5.9043999999999997e+01 / rho);
  dy[58] *= (7.5043000000000006e+01 / rho);
  dy[59] *= (7.6051000000000002e+01 / rho);
  dy[60] *= (4.2081000000000003e+01 / rho);
  dy[61] *= (4.4097000000000001e+01 / rho);
  dy[62] *= (4.3088999999999999e+01 / rho);
  dy[63] *= (4.3088999999999999e+01 / rho);
  dy[64] *= (4.0064999999999998e+01 / rho);
  dy[65] *= (4.0064999999999998e+01 / rho);
  dy[66] *= (4.4052999999999997e+01 / rho);
  dy[67] *= (4.5061000000000000e+01 / rho);
  dy[68] *= (4.5061000000000000e+01 / rho);
  dy[69] *= (6.1060000000000002e+01 / rho);
  dy[70] *= (4.4052999999999997e+01 / rho);
  dy[71] *= (6.2067999999999998e+01 / rho);
  dy[72] *= (5.8080000000000005e+01 / rho);
  dy[73] *= (5.7072000000000003e+01 / rho);
  dy[74] *= (6.1060000000000002e+01 / rho);
  dy[75] *= (4.3045000000000002e+01 / rho);
  dy[76] *= (4.6069000000000003e+01 / rho);
  dy[77] *= (4.5061000000000000e+01 / rho);
  dy[78] *= (7.7058999999999997e+01 / rho);
  dy[79] *= (7.8067000000000007e+01 / rho);
  dy[80] *= (6.1060000000000002e+01 / rho);
  dy[81] *= (6.0052000000000000e+01 / rho);
  dy[82] *= (5.9043999999999997e+01 / rho);
  dy[83] *= (5.9043999999999997e+01 / rho);
  dy[84] *= (7.7058999999999997e+01 / rho);
  dy[85] *= (1.0905700000000000e+02 / rho);
  dy[86] *= (9.2049999999999997e+01 / rho);
  dy[87] *= (7.5043000000000006e+01 / rho);
  dy[88] *= (7.5043000000000006e+01 / rho);
  dy[89] *= (4.7033000000000001e+01 / rho);
  dy[90] *= (1.3018999999999998e+01 / rho);
  dy[91] *= (1.4007000000000000e+01 / rho);
  dy[92] *= (3.0006000000000000e+01 / rho);
  dy[93] *= (4.4012999999999998e+01 / rho);
  dy[94] *= (4.6005000000000003e+01 / rho);
  dy[95] *= (1.5015000000000001e+01 / rho);
  dy[96] *= (1.6023000000000000e+01 / rho);
  dy[97] *= (1.7030999999999999e+01 / rho);
  dy[98] *= (3.1014000000000003e+01 / rho);
  dy[99] *= (4.7012999999999998e+01 / rho);
  dy[100] *= (3.2021999999999998e+01 / rho);
  dy[101] *= (2.9021999999999998e+01 / rho);
  dy[102] *= (3.0030000000000001e+01 / rho);
  dy[103] *= (3.1038000000000000e+01 / rho);
  dy[104] *= (3.2045999999999999e+01 / rho);
  dy[105] *= (3.0030000000000001e+01 / rho);
  dy[106] *= (3.2021999999999998e+01 / rho);
  dy[107] *= (3.3030000000000001e+01 / rho);
  dy[108] *= (4.7012999999999998e+01 / rho);
  dy[109] *= (6.2003999999999998e+01 / rho);
  dy[110] *= (6.3012000000000000e+01 / rho);
  dy[111] *= (2.6018000000000001e+01 / rho);
  dy[112] *= (2.7025999999999996e+01 / rho);
  dy[113] *= (4.3024999999999999e+01 / rho);
  dy[114] *= (4.0024999999999999e+01 / rho);
  dy[115] *= (2.7025999999999996e+01 / rho);
  dy[116] *= (4.1033000000000001e+01 / rho);
  dy[117] *= (2.8033999999999999e+01 / rho);
  dy[118] *= (5.2036000000000001e+01 / rho);
  dy[119] *= (4.3024999999999999e+01 / rho);
  dy[120] *= (4.3024999999999999e+01 / rho);
  dy[121] *= (4.2016999999999996e+01 / rho);
  dy[122] *= (3.1014000000000003e+01 / rho);
  dy[123] *= (2.8033999999999999e+01 / rho);
  dy[124] *= (2.8013999999999999e+01 / rho);

} // end dydt

#endif
