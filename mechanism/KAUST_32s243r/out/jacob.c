#include "jacob.h"

void eval_jacob (const double t, const double pres, const double * __restrict__ y, double * __restrict__ jac) {

  double T = y[0];

  // average molecular weight
  double mw_avg;
  // mass-averaged density
  double rho;
  // species molar concentrations
  double conc[36];
  double y_N;
  eval_conc(y[0], pres, &y[1], &y_N, &mw_avg, &rho, conc);

  // evaluate reaction rates
  double fwd_rates[274];
  double rev_rates[269];
  eval_rxn_rates (T, pres, conc, fwd_rates, rev_rates);

  double pres_mod[25];
  //get pressure modifications to reaction rates
  get_rxn_pres_mod (T, pres, conc, pres_mod);

  // evaluate rate of change of species molar concentration
  double spec_rates[36] = {0};
  eval_spec_rates (fwd_rates, rev_rates, pres_mod, spec_rates, &spec_rates[35]);

  double m = pres / (8.31446210e+03 * T);
  double logT = log(T);
  double J_nplusone = 0;
  double J_nplusjplus[NSP];
  double dBdT[36];
  if (T <= 1000.0) {
    dBdT[0] = (1.5000000000000000e+00 + -7.4537500000000000e+02 / T) / T + 0.0000000000000000e+00 + T * (0.0000000000000000e+00 + T * (0.0000000000000000e+00 + 0.0000000000000000e+00 * T));
    dBdT[1] = (1.5000000000000000e+00 + 2.5473659899999999e+04 / T) / T + 3.5266640949999999e-13 + T * (-6.6530654666666665e-16 + T * (5.7520407999999997e-19 + -1.8554646640000001e-22 * T));
    dBdT[2] = (1.3443311200000001e+00 + -9.1793517299999996e+02 / T) / T + 3.9902603749999996e-03 + T * (-6.4927169999999995e-06 + T * (5.0393023500000001e-09 + -1.4752235220000002e-12 * T));
    dBdT[3] = (1.5000000000000000e+00 + -7.4537500000000000e+02 / T) / T + 0.0000000000000000e+00 + T * (0.0000000000000000e+00 + T * (0.0000000000000000e+00 + 0.0000000000000000e+00 * T));
    dBdT[4] = (2.1682671000000000e+00 + 2.9122259200000000e+04 / T) / T + -1.6396594200000000e-03 + T * (2.2143546533333334e-06 + T * (-1.5320165600000000e-09 + 4.2253194199999998e-13 * T));
    dBdT[5] = (3.1253056099999998e+00 + 3.3815381200000002e+03 / T) / T + -1.6127246950000001e-03 + T * (2.1758823033333334e-06 + T * (-1.4496341075000000e-09 + 4.1247475799999997e-13 * T));
    dBdT[6] = (3.1986405600000003e+00 + -3.0293726699999999e+04 / T) / T + -1.0182170500000001e-03 + T * (2.1734673700000000e-06 + T * (-1.3719926550000001e-09 + 3.5439563400000000e-13 * T));
    dBdT[7] = (3.3017980099999997e+00 + 2.9480804000000001e+02 / T) / T + -2.3745602549999998e-03 + T * (7.0527630333333326e-06 + T * (-6.0690973500000000e-09 + 1.8584502480000002e-12 * T));
    dBdT[8] = (3.2761126899999997e+00 + -1.7702582100000000e+04 / T) / T + -2.7141120849999997e-04 + T * (5.5778567000000005e-06 + T * (-5.3942703249999999e-09 + 1.7249087260000000e-12 * T));
    dBdT[9] = (2.7824563599999999e+00 + -1.0639435599999999e+03 / T) / T + -1.4983670799999999e-03 + T * (3.2824340033333332e-06 + T * (-2.4203237725000002e-09 + 6.4874567400000000e-13 * T));
    dBdT[10] = (2.5795334699999999e+00 + -1.4344085999999999e+04 / T) / T + -3.0517684000000000e-04 + T * (3.3893811000000002e-07 + T * (2.2675147100000000e-10 + -1.8088489979999999e-13 * T));
    dBdT[11] = (1.3567735200000000e+00 + -4.8371969700000001e+04 / T) / T + 4.4922983850000002e-03 + T * (-2.3745208966666665e-06 + T * (6.1479755499999995e-10 + -2.8739909599999997e-14 * T));
    dBdT[12] = (3.2211858400000004e+00 + 3.8395649600000002e+03 / T) / T + -1.6219626600000000e-03 + T * (4.5933148666666667e-06 + T * (-3.3286023250000002e-09 + 8.6753773000000000e-13 * T));
    dBdT[13] = (1.9220791899999998e+00 + -2.3351232700000000e+04 / T) / T + 3.8122692950000002e-03 + T * (1.0996147899999999e-06 + T * (-2.6783801250000000e-09 + 1.0231741140000001e-12 * T));
    dBdT[14] = (1.5030709999999998e+00 + 5.6098900000000001e+04 / T) / T + -1.0900090000000000e-05 + T * (1.8068430000000001e-08 + T * (-1.4118900000000000e-11 + 4.1998080000000003e-15 * T));
    dBdT[15] = (2.4913844699999999e+00 + 4.1785151700000002e+04 / T) / T + 1.2405253600000001e-04 + T * (-4.0784219333333334e-07 + T * (4.9435031749999997e-10 + -1.5784212260000000e-13 * T));
    dBdT[16] = (3.0259005400000003e+00 + 2.1244739000000001e+04 / T) / T + -4.7662597300000001e-04 + T * (1.3782244933333333e-06 + T * (-7.0454156999999999e-10 + 1.3460943660000000e-13 * T));
    dBdT[17] = (1.2043520000000001e+00 + -6.5254880000000003e+03 / T) / T + 5.0573800000000002e-03 + T * (-4.8842166666666665e-06 + T * (3.6180874999999999e-09 + -1.0657018000000000e-12 * T));
    dBdT[18] = (2.8623128400000000e+00 + 2.9162129799999999e+04 / T) / T + -2.2094934900000000e-04 + T * (2.1284071366666665e-06 + T * (-1.4603471100000000e-09 + 3.3825164399999998e-13 * T));
    dBdT[19] = (3.1491587799999996e+00 + 2.3287459699999999e+04 / T) / T + -2.4100677149999999e-03 + T * (7.3202175000000002e-06 + T * (-5.0915725499999996e-09 + 1.2507344000000000e-12 * T));
    dBdT[20] = (2.4212550500000001e+00 + 2.5305613900000000e+04 / T) / T + 6.7450794999999997e-04 + T * (7.4486356999999996e-06 + T * (-7.4931933000000001e-09 + 2.4195794000000001e-12 * T));
    dBdT[21] = (2.8347214900000002e+00 + 1.0089392500000000e+04 / T) / T + -3.2456477749999999e-04 + T * (1.2561615433333334e-05 + T * (-1.2517729550000001e-08 + 4.0672412799999997e-12 * T));
    dBdT[22] = (3.5320400100000002e+00 + 3.4958000300000000e+04 / T) / T + -3.6620928900000000e-03 + T * (1.0026790433333333e-05 + T * (-7.6000137749999992e-09 + 2.0940127800000001e-12 * T));
    dBdT[23] = (2.3765420000000002e+00 + 9.8179609999999993e+03 / T) / T + 6.2653150000000000e-04 + T * (-1.1009170000000000e-06 + T * (1.3044524999999999e-09 + -4.8925259999999995e-13 * T));
    dBdT[24] = (1.5430579999999998e+00 + 8.7651000000000004e+03 / T) / T + 4.7460964999999997e-03 + T * (-3.2642583333333335e-06 + T * (1.5659612500000000e-09 + -3.8036519999999998e-13 * T));
    dBdT[25] = (1.6705999999999999e+00 + 2.8962910000000002e+03 / T) / T + 3.9192504999999997e-03 + T * (-2.6879550000000002e-06 + T * (1.5404287500000000e-09 + -4.6402999999999999e-13 * T));
    dBdT[26] = (1.7844030000000002e+00 + 1.0918780000000001e+04 / T) / T + 3.3048230000000001e-03 + T * (-3.1000743333333334e-06 + T * (2.3594950000000000e-09 + -7.5062920000000005e-13 * T));
    dBdT[28] = (1.2904130000000000e+00 + -1.0431950000000001e+04 / T) / T + 7.0496100000000004e-03 + T * (-4.5595733333333330e-06 + T * (1.8746949999999998e-09 + -3.7538099999999998e-13 * T));
    dBdT[30] = (2.9560824800000001e+00 + 1.0919978999999999e+04 / T) / T + -1.5130550999999999e-03 + T * (8.5624798666666668e-06 + T * (-7.8911280000000004e-09 + 2.4816914800000000e-12 * T));
    dBdT[31] = (2.2101609199999999e+00 + -6.5814848099999999e+03 / T) / T + 3.0983583800000001e-03 + T * (3.6864982666666666e-06 + T * (-4.9167065500000002e-09 + 1.7650331799999999e-12 * T));
    dBdT[33] = (6.9329153999999993e-01 + -1.7388241099999999e+04 / T) / T + 9.5083851000000007e-03 + T * (-2.7505889900000001e-06 + T * (-1.5152845675000001e-09 + 9.3047395600000004e-13 * T));
    dBdT[34] = (1.1735932999999998e+00 + 7.8129090500000002e+03 / T) / T + 5.2451342500000001e-03 + T * (3.6824223000000001e-06 + T * (-7.0390466749999998e-09 + 2.7316791999999999e-12 * T));
    dBdT[35] = (2.2986770000000001e+00 + -1.0208999000000000e+03 / T) / T + 7.0412019999999999e-04 + T * (-1.3210739999999999e-06 + T * (1.4103787500000001e-09 + -4.8897079999999994e-13 * T));
  } else {
    dBdT[0] = (1.5000000000000000e+00 + -7.4537500000000000e+02 / T) / T + 0.0000000000000000e+00 + T * (0.0000000000000000e+00 + T * (0.0000000000000000e+00 + 0.0000000000000000e+00 * T));
    dBdT[1] = (1.5000000099999999e+00 + 2.5473659899999999e+04 / T) / T + -1.1542148649999999e-11 + T * (5.3853982666666673e-15 + T * (-1.1837880875000001e-18 + 9.9639471400000006e-23 * T));
    dBdT[2] = (2.3372791999999998e+00 + -9.5015892199999996e+02 / T) / T + -2.4701236549999999e-05 + T * (1.6648559266666665e-07 + T * (-4.4891598500000001e-11 + 4.0051075199999998e-15 * T));
    dBdT[3] = (1.5000000000000000e+00 + -7.4537500000000000e+02 / T) / T + 0.0000000000000000e+00 + T * (0.0000000000000000e+00 + T * (0.0000000000000000e+00 + 0.0000000000000000e+00 * T));
    dBdT[4] = (1.5694207800000002e+00 + 2.9217579099999999e+04 / T) / T + -4.2987056850000002e-05 + T * (1.3982819633333334e-08 + T * (-2.5044449749999998e-12 + 2.4566738199999997e-16 * T));
    dBdT[5] = (1.8647288600000000e+00 + 3.7188577399999999e+03 / T) / T + 5.2825224000000001e-04 + T * (-8.6360919333333338e-08 + T * (7.6304668500000001e-12 + -2.6639175200000000e-16 * T));
    dBdT[6] = (2.0339924900000002e+00 + -3.0004297100000000e+04 / T) / T + 1.0884590200000001e-03 + T * (-5.4690839333333327e-08 + T * (-2.4260496750000000e-11 + 3.3640198399999998e-15 * T));
    dBdT[7] = (3.0172109000000003e+00 + 1.1185671300000000e+02 / T) / T + 1.1199100650000000e-03 + T * (-2.1121938333333332e-07 + T * (2.8561592500000001e-11 + -2.1581707000000000e-15 * T));
    dBdT[8] = (3.1650028499999996e+00 + -1.7861787700000001e+04 / T) / T + 2.4541584700000000e-03 + T * (-6.3379741666666662e-07 + T * (9.2796496499999996e-11 + -5.7581661000000002e-15 * T));
    dBdT[9] = (2.2825378399999998e+00 + -1.0884577200000001e+03 / T) / T + 7.4154376999999996e-04 + T * (-2.5265555633333331e-07 + T * (5.2367638749999998e-11 + -4.3343558799999996e-15 * T));
    dBdT[10] = (1.7151856099999998e+00 + -1.4151872400000000e+04 / T) / T + 1.0312637150000001e-03 + T * (-3.3294192366666671e-07 + T * (5.7513252000000000e-11 + -4.0729543200000001e-15 * T));
    dBdT[11] = (2.8574602900000001e+00 + -4.8759165999999997e+04 / T) / T + 2.2071851299999999e-03 + T * (-7.3827134666666672e-07 + T * (1.3087254700000001e-10 + -9.4416832800000002e-15 * T));
    dBdT[12] = (1.7721743800000000e+00 + 4.0119181500000000e+03 / T) / T + 2.4784776299999998e-03 + T * (-8.2815204333333337e-07 + T * (1.4729044450000001e-10 + -1.0670174220000000e-14 * T));
    dBdT[13] = (4.3920615200000004e+00 + -2.3648076000000001e+04 / T) / T + 2.0561072749999999e-03 + T * (-4.9398300000000001e-07 + T * (5.9968864999999998e-11 + -2.8780620800000001e-15 * T));
    dBdT[14] = (1.4502679999999999e+00 + 5.6116040000000001e+04 / T) / T + 5.3307299999999997e-05 + T * (-2.4884456666666667e-08 + T * (4.6991300000000000e-12 + -2.0519680000000000e-16 * T));
    dBdT[15] = (2.3839304700000001e+00 + 4.1855758600000001e+04 / T) / T + -1.5220052400000001e-04 + T * (3.5957191999999996e-07 + T * (-1.3493726700000001e-10 + 1.7131499700000000e-14 * T));
    dBdT[16] = (2.8075146000000002e+00 + 2.1275723800000000e+04 / T) / T + 8.7069424000000003e-05 + T * (6.8760559666666666e-07 + T * (-2.9577037000000000e-10 + 4.0162846800000001e-14 * T));
    dBdT[17] = (1.4619040000000001e+00 + -6.4932700000000004e+03 / T) / T + 3.0295830000000002e-03 + T * (-6.6832566666666666e-07 + T * (7.8400074999999994e-11 + -3.8766340000000001e-15 * T));
    dBdT[18] = (1.7802415900000002e+00 + 2.9347306300000000e+04 / T) / T + 2.2555705900000000e-03 + T * (-6.6049024999999996e-07 + T * (9.0290310250000002e-11 + -3.1135848400000003e-15 * T));
    dBdT[19] = (1.3838838000000000e+00 + 2.3420753199999999e+04 / T) / T + 3.3180977950000002e-03 + T * (-6.0556356000000003e-07 + T * (-2.9874257750000000e-11 + 1.8633185099999999e-14 * T));
    dBdT[20] = (3.0448356600000004e+00 + 2.4809860300000000e+04 / T) / T + 3.6556509300000001e-03 + T * (-8.2541933000000010e-07 + T * (9.5933255249999996e-11 + -4.4621514599999999e-15 * T));
    dBdT[21] = (3.9395735700000003e+00 + 9.2826554799999994e+03 / T) / T + 4.3750859350000001e-03 + T * (-9.9799686000000006e-07 + T * (1.1681960449999999e-10 + -5.4613719800000003e-15 * T));
    dBdT[22] = (2.0590367000000001e+00 + 3.4853014900000002e+04 / T) / T + 3.0919117349999998e-03 + T * (-7.4057054999999995e-07 + T * (8.9634801500000001e-11 + -4.2906580999999997e-15 * T));
    dBdT[23] = (2.2454350000000001e+00 + 9.8008400000000001e+03 / T) / T + 6.3456899999999998e-04 + T * (-1.6719633333333333e-07 + T * (2.2923207500000000e-11 + -1.2550838000000000e-15 * T));
    dBdT[24] = (3.7189769999999998e+00 + 8.1658109999999997e+03 / T) / T + 1.4368569999999999e-03 + T * (-3.9916533333333336e-07 + T * (5.6263799999999998e-11 + -3.1506740000000004e-15 * T));
    dBdT[25] = (3.6828589999999997e+00 + 2.2612919999999999e+03 / T) / T + 1.2312145000000000e-03 + T * (-3.4741966666666668e-07 + T * (4.9422550000000001e-11 + -2.7834340000000000e-15 * T));
    dBdT[26] = (2.6151439999999999e+00 + 1.0661910000000000e+04 / T) / T + 1.6062430000000000e-03 + T * (-4.2011233333333331e-07 + T * (5.6682449999999997e-11 + -3.0724720000000004e-15 * T));
    dBdT[28] = (4.4868930000000002e+00 + -1.1268650000000000e+04 / T) / T + 2.1090325000000000e-03 + T * (-5.4971433333333331e-07 + T * (7.4296924999999994e-11 + -4.0422959999999994e-15 * T));
    dBdT[30] = (2.9832193299999998e+00 + 1.0578010600000000e+04 / T) / T + 2.4442318699999998e-03 + T * (-5.5028878999999994e-07 + T * (6.3842861499999997e-11 + -2.9661712199999996e-15 * T));
    dBdT[31] = (2.8811250199999998e+00 + -6.8601841899999999e+03 / T) / T + 4.0785422400000000e-03 + T * (-9.4205192000000002e-07 + T * (1.0948273325000000e-10 + -5.0544920800000002e-15 * T));
    dBdT[33] = (7.0309894199999992e+00 + -1.9282168500000000e+04 / T) / T + 2.2347929449999999e-03 + T * (-5.7486496999999998e-07 + T * (7.2889038250000005e-11 + -3.6020540399999995e-15 * T));
    dBdT[34] = (6.4834770199999996e+00 + 6.1299047399999999e+03 / T) / T + 1.2888603200000000e-03 + T * (-3.3648610333333332e-07 + T * (4.3078515749999999e-11 + -2.1430801600000001e-15 * T));
    dBdT[35] = (1.9266399999999999e+00 + -9.2279769999999996e+02 / T) / T + 7.4398840000000003e-04 + T * (-1.8949200000000001e-07 + T * (2.5242595000000000e-11 + -1.3506701999999999e-15 * T));
  }

  if (T <= 1500.0) {
    dBdT[29] = (1.5305900000000001e+00 + 6.8680299999999997e+03 / T) / T + 4.2980175000000001e-03 + T * (-1.8236766666666667e-06 + T * (5.6906224999999999e-10 + -9.2961459999999992e-14 * T));
    dBdT[32] = (9.3483800000000006e-01 + -5.9157159099999999e+03 / T) / T + 5.0501799999999996e-03 + T * (-1.6548720000000001e-06 + T * (2.1752800000000001e-10 + -4.6482700000000005e-16 * T));
  } else {
    dBdT[29] = (4.6733459999999996e+00 + 5.5693249999999998e+03 / T) / T + 1.1494185000000001e-03 + T * (-5.9148199999999999e-08 + T * (-2.7587049999999998e-11 + 3.7195240000000002e-15 * T));
    dBdT[32] = (5.4796300000000002e+00 + -7.8095029100000002e+03 / T) / T + 9.9763700000000000e-04 + T * (-5.8012900000000006e-08 + T * (-2.4239680000000001e-11 + 3.4029599999999996e-15 * T));
  }

  if (T <= 1671.0) {
    dBdT[27] = (2.3365643100000000e+00 + 2.9597975100000000e+04 / T) / T + 1.3384146950000001e-03 + T * (1.8726710100000000e-07 + T * (-2.7840569749999999e-10 + 5.6815287599999994e-14 * T));
  } else {
    dBdT[27] = (2.7857742999999999e+00 + 2.9331970099999999e+04 / T) / T + 1.4303136399999999e-03 + T * (-3.4141307333333337e-07 + T * (4.1115784750000001e-11 + -1.9558872319999999e-15 * T));
  }

  eval_jacob_0(pres, conc, fwd_rates, rev_rates, pres_mod, spec_rates, m, mw_avg, rho, dBdT, T, jac);
  eval_jacob_1(pres, conc, fwd_rates, rev_rates, pres_mod, spec_rates, m, mw_avg, rho, dBdT, T, jac, &J_nplusone, J_nplusjplus);
  eval_jacob_2(pres, conc, fwd_rates, rev_rates, pres_mod, spec_rates, m, mw_avg, rho, dBdT, T, jac, &J_nplusone, J_nplusjplus);
  eval_jacob_3(pres, conc, fwd_rates, rev_rates, pres_mod, spec_rates, m, mw_avg, rho, dBdT, T, jac, &J_nplusone, J_nplusjplus);
  eval_jacob_4(pres, conc, fwd_rates, rev_rates, pres_mod, spec_rates, m, mw_avg, rho, dBdT, T, jac, &J_nplusone, J_nplusjplus);
  eval_jacob_5(pres, conc, fwd_rates, rev_rates, pres_mod, spec_rates, m, mw_avg, rho, dBdT, T, jac, &J_nplusone, J_nplusjplus);
  eval_jacob_6(pres, conc, fwd_rates, rev_rates, pres_mod, spec_rates, m, mw_avg, rho, dBdT, T, jac, &J_nplusone, J_nplusjplus);
  // species enthalpies
  double h[36];
  eval_h(T, h);

  // species specific heats
  double cp[36];
  eval_cp(T, cp);

  // average specific heat
  double cp_avg;
  cp_avg = (y[1] * cp[0]) + (y[2] * cp[1]) + (y[3] * cp[2]) + (y[4] * cp[3]) + 
     (y[5] * cp[4]) + (y[6] * cp[5]) + (y[7] * cp[6]) + (y[8] * cp[7]) + 
     (y[9] * cp[8]) + (y[10] * cp[9]) + (y[11] * cp[10]) + (y[12] * cp[11]) + 
     (y[13] * cp[12]) + (y[14] * cp[13]) + (y[15] * cp[14]) + (y[16] * cp[15]) + 
     (y[17] * cp[16]) + (y[18] * cp[17]) + (y[19] * cp[18]) + (y[20] * cp[19]) + 
     (y[21] * cp[20]) + (y[22] * cp[21]) + (y[23] * cp[22]) + (y[24] * cp[23]) + 
     (y[25] * cp[24]) + (y[26] * cp[25]) + (y[27] * cp[26]) + (y[28] * cp[27]) + 
     (y[29] * cp[28]) + (y[30] * cp[29]) + (y[31] * cp[30]) + (y[32] * cp[31]) + 
     (y[33] * cp[32]) + (y[34] * cp[33]) + (y[35] * cp[34]) + (y_N * cp[35]);
  jac[0] = 0.0;
  double working_temp = 0;
  //Finish dYk / Yj's
  //And dT/dYj's
  eval_jacob_7(mw_avg, rho, cp_avg, spec_rates, h, cp, jac, J_nplusjplus);
  if (T <= 1000.0) {
    working_temp = (y[1] * 2.0813212426154001e+02 * (0.0000000000000000e+00 + T * (0.0000000000000000e+00 + T * (0.0000000000000000e+00 + 0.0000000000000000e+00 * T))))
    + (y[2] * 8.2489653153957570e+03 * (7.0533281899999999e-13 + T * (-3.9918392799999999e-15 + T * (6.9024489599999992e-18 + -3.7109293280000002e-21 * T))))
    + (y[3] * 4.1244826576978785e+03 * (7.9805207499999992e-03 + T * (-3.8956301999999997e-05 + T * (6.0471628200000004e-08 + -2.9504470440000002e-11 * T))))
    + (y[4] * 2.0772653025533405e+03 * (0.0000000000000000e+00 + T * (0.0000000000000000e+00 + T * (0.0000000000000000e+00 + 0.0000000000000000e+00 * T))))
    + (y[5] * 5.1967336900133762e+02 * (-3.2793188399999999e-03 + T * (1.3286127919999999e-05 + T * (-1.8384198720000000e-08 + 8.4506388399999997e-12 * T))))
    + (y[6] * 4.8887492694330808e+02 * (-3.2254493900000002e-03 + T * (1.3055293820000000e-05 + T * (-1.7395609290000000e-08 + 8.2494951599999996e-12 * T))))
    + (y[7] * 4.6152277955158070e+02 * (-2.0364341000000002e-03 + T * (1.3040804219999999e-05 + T * (-1.6463911860000002e-08 + 7.0879126800000000e-12 * T))))
    + (y[8] * 2.5190194790518544e+02 * (-4.7491205099999996e-03 + T * (4.2316578199999997e-05 + T * (-7.2829168200000001e-08 + 3.7169004960000001e-11 * T))))
    + (y[9] * 2.4443746347165404e+02 * (-5.4282241699999995e-04 + T * (3.3467140200000003e-05 + T * (-6.4731243900000002e-08 + 3.4498174519999999e-11 * T))))
    + (y[10] * 2.5983668450066881e+02 * (-2.9967341599999998e-03 + T * (1.9694604020000000e-05 + T * (-2.9043885270000002e-08 + 1.2974913480000000e-11 * T))))
    + (y[11] * 2.9683482206608977e+02 * (-6.1035368000000000e-04 + T * (2.0336286600000001e-06 + T * (2.7210176520000001e-09 + -3.6176979960000000e-12 * T))))
    + (y[12] * 1.8892296942953618e+02 * (8.9845967700000005e-03 + T * (-1.4247125380000000e-05 + T * (7.3775706599999994e-09 + -5.7479819199999996e-13 * T))))
    + (y[13] * 2.8652438768034290e+02 * (-3.2439253200000000e-03 + T * (2.7559889200000000e-05 + T * (-3.9943227900000001e-08 + 1.7350754600000000e-11 * T))))
    + (y[14] * 1.8469301435389693e+02 * (7.6245385900000004e-03 + T * (6.5976887399999998e-06 + T * (-3.2140561500000001e-08 + 2.0463482280000001e-11 * T))))
    + (y[15] * 5.9360437189524475e+02 * (-2.1800180000000000e-05 + T * (1.0841058000000000e-07 + T * (-1.6942680000000002e-10 + 8.3996160000000005e-14 * T))))
    + (y[16] * 5.5375553125341332e+02 * (2.4810507200000002e-04 + T * (-2.4470531600000002e-06 + T * (5.9322038100000001e-09 + -3.1568424519999998e-12 * T))))
    + (y[17] * 5.1892025773562625e+02 * (-9.5325194600000003e-04 + T * (8.2693469599999998e-06 + T * (-8.4544988400000003e-09 + 2.6921887319999999e-12 * T))))
    + (y[18] * 4.8820837952480719e+02 * (1.0114760000000000e-02 + T * (-2.9305299999999999e-05 + T * (4.3417050000000000e-08 + -2.1314035999999999e-11 * T))))
    + (y[19] * 2.8649397927461854e+02 * (-4.4189869800000001e-04 + T * (1.2770442820000000e-05 + T * (-1.7524165320000000e-08 + 6.7650328799999998e-12 * T))))
    + (y[20] * 2.7687776562670666e+02 * (-4.8201354299999997e-03 + T * (4.3921305000000003e-05 + T * (-6.1098870599999999e-08 + 2.5014688000000001e-11 * T))))
    + (y[21] * 2.6788612733710727e+02 * (1.3490158999999999e-03 + T * (4.4691814199999999e-05 + T * (-8.9918319600000001e-08 + 4.8391587999999999e-11 * T))))
    + (y[22] * 2.5946012886781313e+02 * (-6.4912955499999998e-04 + T * (7.5369692600000006e-05 + T * (-1.5021275460000000e-07 + 8.1344825599999994e-11 * T))))
    + (y[23] * 2.7687776562670666e+02 * (-7.3241857799999999e-03 + T * (6.0160742599999999e-05 + T * (-9.1200165299999997e-08 + 4.1880255600000001e-11 * T))))
    + (y[24] * 2.7709202516551613e+02 * (1.2530630000000000e-03 + T * (-6.6055020000000002e-06 + T * (1.5653429999999999e-08 + -9.7850519999999993e-12 * T))))
    + (y[25] * 1.8890974869174661e+02 * (9.4921929999999995e-03 + T * (-1.9585550000000001e-05 + T * (1.8791535000000001e-08 + -7.6073039999999996e-12 * T))))
    + (y[26] * 1.8072741022059520e+02 * (7.8385009999999995e-03 + T * (-1.6127730000000000e-05 + T * (1.8485145000000000e-08 + -9.2805999999999999e-12 * T))))
    + (y[27] * 2.6808669159297972e+02 * (6.6096460000000003e-03 + T * (-1.8600446000000002e-05 + T * (2.8313939999999999e-08 + -1.5012584000000001e-11 * T))))
    + (y[29] * 1.7685272606920398e+02 * (1.4099220000000001e-02 + T * (-2.7357439999999999e-05 + T * (2.2496339999999998e-08 + -7.5076199999999995e-12 * T))))
    + (y[31] * 2.5964827015909680e+02 * (-3.0261101999999999e-03 + T * (5.1374879200000001e-05 + T * (-9.4693535999999998e-08 + 4.9633829600000001e-11 * T))))
    + (y[32] * 2.5172486130773396e+02 * (6.1967167600000001e-03 + T * (2.2118989599999999e-05 + T * (-5.9000478600000003e-08 + 3.5300663599999999e-11 * T))))
    + (y[34] * 1.3194861272806452e+02 * (1.9016770200000001e-02 + T * (-1.6503533939999999e-05 + T * (-1.8183414810000003e-08 + 1.8609479120000000e-11 * T))))
    + (y[35] * 1.3409354319188117e+02 * (1.0490268500000000e-02 + T * (2.2094533800000000e-05 + T * (-8.4468560100000001e-08 + 5.4633583999999997e-11 * T))))
    + (y_N * 2.9680218594762238e+02 * (1.4082404000000000e-03 + T * (-7.9264439999999996e-06 + T * (1.6924545000000002e-08 + -9.7794159999999997e-12 * T))));
  } else {
    working_temp = (y[1] * 2.0813212426154001e+02 * (0.0000000000000000e+00 + T * (0.0000000000000000e+00 + T * (0.0000000000000000e+00 + 0.0000000000000000e+00 * T))))
    + (y[2] * 8.2489653153957570e+03 * (-2.3084297299999999e-11 + T * (3.2312389600000002e-14 + T * (-1.4205457050000002e-17 + 1.9927894280000001e-21 * T))))
    + (y[3] * 4.1244826576978785e+03 * (-4.9402473099999998e-05 + T * (9.9891355599999992e-07 + T * (-5.3869918199999997e-10 + 8.0102150399999999e-14 * T))))
    + (y[4] * 2.0772653025533405e+03 * (0.0000000000000000e+00 + T * (0.0000000000000000e+00 + T * (0.0000000000000000e+00 + 0.0000000000000000e+00 * T))))
    + (y[5] * 5.1967336900133762e+02 * (-8.5974113700000004e-05 + T * (8.3896917800000004e-08 + T * (-3.0053339700000001e-11 + 4.9133476399999997e-15 * T))))
    + (y[6] * 4.8887492694330808e+02 * (1.0565044800000000e-03 + T * (-5.1816551600000003e-07 + T * (9.1565602200000001e-11 + -5.3278350400000003e-15 * T))))
    + (y[7] * 4.6152277955158070e+02 * (2.1769180400000002e-03 + T * (-3.2814503599999998e-07 + T * (-2.9112596100000000e-10 + 6.7280396799999996e-14 * T))))
    + (y[8] * 2.5190194790518544e+02 * (2.2398201299999999e-03 + T * (-1.2673163000000000e-06 + T * (3.4273911000000001e-10 + -4.3163414000000000e-14 * T))))
    + (y[9] * 2.4443746347165404e+02 * (4.9083169400000000e-03 + T * (-3.8027844999999999e-06 + T * (1.1135579579999999e-09 + -1.1516332200000001e-13 * T))))
    + (y[10] * 2.5983668450066881e+02 * (1.4830875399999999e-03 + T * (-1.5159333380000000e-06 + T * (6.2841166499999998e-10 + -8.6687117599999996e-14 * T))))
    + (y[11] * 2.9683482206608977e+02 * (2.0625274300000002e-03 + T * (-1.9976515420000001e-06 + T * (6.9015902399999998e-10 + -8.1459086400000001e-14 * T))))
    + (y[12] * 1.8892296942953618e+02 * (4.4143702599999998e-03 + T * (-4.4296280800000001e-06 + T * (1.5704705640000000e-09 + -1.8883366560000001e-13 * T))))
    + (y[13] * 2.8652438768034290e+02 * (4.9569552599999997e-03 + T * (-4.9689122600000000e-06 + T * (1.7674853340000001e-09 + -2.1340348440000000e-13 * T))))
    + (y[14] * 1.8469301435389693e+02 * (4.1122145499999999e-03 + T * (-2.9638980000000001e-06 + T * (7.1962637999999993e-10 + -5.7561241600000000e-14 * T))))
    + (y[15] * 5.9360437189524475e+02 * (1.0661459999999999e-04 + T * (-1.4930674000000001e-07 + T * (5.6389560000000003e-11 + -4.1039360000000001e-15 * T))))
    + (y[16] * 5.5375553125341332e+02 * (-3.0440104800000001e-04 + T * (2.1574315199999999e-06 + T * (-1.6192472040000001e-09 + 3.4262999400000001e-13 * T))))
    + (y[17] * 5.1892025773562625e+02 * (1.7413884800000001e-04 + T * (4.1256335800000002e-06 + T * (-3.5492444400000000e-09 + 8.0325693600000005e-13 * T))))
    + (y[18] * 4.8820837952480719e+02 * (6.0591660000000004e-03 + T * (-4.0099539999999997e-06 + T * (9.4080089999999997e-10 + -7.7532679999999996e-14 * T))))
    + (y[19] * 2.8649397927461854e+02 * (4.5111411799999999e-03 + T * (-3.9629415000000000e-06 + T * (1.0834837230000001e-09 + -6.2271696800000006e-14 * T))))
    + (y[20] * 2.7687776562670666e+02 * (6.6361955900000004e-03 + T * (-3.6333813600000000e-06 + T * (-3.5849109300000000e-10 + 3.7266370200000000e-13 * T))))
    + (y[21] * 2.6788612733710727e+02 * (7.3113018600000001e-03 + T * (-4.9525159800000004e-06 + T * (1.1511990629999999e-09 + -8.9243029200000004e-14 * T))))
    + (y[22] * 2.5946012886781313e+02 * (8.7501718700000002e-03 + T * (-5.9879811600000004e-06 + T * (1.4018352539999999e-09 + -1.0922743960000000e-13 * T))))
    + (y[23] * 2.7687776562670666e+02 * (6.1838234699999996e-03 + T * (-4.4434232999999999e-06 + T * (1.0756176179999999e-09 + -8.5813162000000001e-14 * T))))
    + (y[24] * 2.7709202516551613e+02 * (1.2691380000000000e-03 + T * (-1.0031780000000000e-06 + T * (2.7507848999999999e-10 + -2.5101676000000000e-14 * T))))
    + (y[25] * 1.8890974869174661e+02 * (2.8737139999999999e-03 + T * (-2.3949920000000001e-06 + T * (6.7516560000000000e-10 + -6.3013480000000006e-14 * T))))
    + (y[26] * 1.8072741022059520e+02 * (2.4624289999999999e-03 + T * (-2.0845180000000002e-06 + T * (5.9307059999999998e-10 + -5.5668680000000002e-14 * T))))
    + (y[27] * 2.6808669159297972e+02 * (3.2124860000000001e-03 + T * (-2.5206740000000000e-06 + T * (6.8018939999999992e-10 + -6.1449440000000006e-14 * T))))
    + (y[29] * 1.7685272606920398e+02 * (4.2180650000000000e-03 + T * (-3.2982859999999999e-06 + T * (8.9156309999999992e-10 + -8.0845919999999994e-14 * T))))
    + (y[31] * 2.5964827015909680e+02 * (4.8884637399999997e-03 + T * (-3.3017327399999998e-06 + T * (7.6611433799999996e-10 + -5.9323424399999996e-14 * T))))
    + (y[32] * 2.5172486130773396e+02 * (8.1570844800000000e-03 + T * (-5.6523115200000004e-06 + T * (1.3137927990000000e-09 + -1.0108984160000000e-13 * T))))
    + (y[34] * 1.3194861272806452e+02 * (4.4695858899999998e-03 + T * (-3.4491898199999999e-06 + T * (8.7466845900000006e-10 + -7.2041080799999996e-14 * T))))
    + (y[35] * 1.3409354319188117e+02 * (2.5777206400000000e-03 + T * (-2.0189166200000000e-06 + T * (5.1694218899999997e-10 + -4.2861603200000002e-14 * T))))
    + (y_N * 2.9680218594762238e+02 * (1.4879768000000001e-03 + T * (-1.1369520000000000e-06 + T * (3.0291114000000000e-10 + -2.7013403999999999e-14 * T))));
  }

  if (T <= 1500.0) {
    working_temp += (y[30] * 2.5964827015909680e+02 * (8.5960350000000001e-03 + T * (-1.0942060000000000e-05 + T * (6.8287469999999999e-09 + -1.8592291999999999e-12 * T))))
    + (y[33] * 1.7685272606920398e+02 * (1.0100359999999999e-02 + T * (-9.9292320000000006e-06 + T * (2.6103360000000003e-09 + -9.2965400000000002e-15 * T))));
  } else {
    working_temp += (y[30] * 2.5964827015909680e+02 * (2.2988370000000002e-03 + T * (-3.5488919999999998e-07 + T * (-3.3104459999999999e-10 + 7.4390480000000001e-14 * T))))
    + (y[33] * 1.7685272606920398e+02 * (1.9952740000000000e-03 + T * (-3.4807740000000002e-07 + T * (-2.9087615999999999e-10 + 6.8059199999999995e-14 * T))));
  }

  if (T <= 1671.0) {
    working_temp += (y[28] * 2.6808669159297972e+02 * (2.6768293900000001e-03 + T * (1.1236026060000001e-06 + T * (-3.3408683699999998e-09 + 1.1363057519999999e-12 * T))));
  } else {
    working_temp += (y[28] * 2.6808669159297972e+02 * (2.8606272799999999e-03 + T * (-2.0484784400000001e-06 + T * (4.9338941699999996e-10 + -3.9117744639999997e-14 * T))));
  }


  //Complete dT wrt T calculations
  jac[0] = -(spec_rates[0] * 3.99480000e+01 * (-working_temp * h[0] / cp_avg + cp[0]) + jac[1] * h[0] * rho
    + spec_rates[1] * 1.00794000e+00 * (-working_temp * h[1] / cp_avg + cp[1]) + jac[2] * h[1] * rho
    + spec_rates[2] * 2.01588000e+00 * (-working_temp * h[2] / cp_avg + cp[2]) + jac[3] * h[2] * rho
    + spec_rates[3] * 4.00260000e+00 * (-working_temp * h[3] / cp_avg + cp[3]) + jac[4] * h[3] * rho
    + spec_rates[4] * 1.59994000e+01 * (-working_temp * h[4] / cp_avg + cp[4]) + jac[5] * h[4] * rho
    + spec_rates[5] * 1.70073400e+01 * (-working_temp * h[5] / cp_avg + cp[5]) + jac[6] * h[5] * rho
    + spec_rates[6] * 1.80152800e+01 * (-working_temp * h[6] / cp_avg + cp[6]) + jac[7] * h[6] * rho
    + spec_rates[7] * 3.30067400e+01 * (-working_temp * h[7] / cp_avg + cp[7]) + jac[8] * h[7] * rho
    + spec_rates[8] * 3.40146800e+01 * (-working_temp * h[8] / cp_avg + cp[8]) + jac[9] * h[8] * rho
    + spec_rates[9] * 3.19988000e+01 * (-working_temp * h[9] / cp_avg + cp[9]) + jac[10] * h[9] * rho
    + spec_rates[10] * 2.80104000e+01 * (-working_temp * h[10] / cp_avg + cp[10]) + jac[11] * h[10] * rho
    + spec_rates[11] * 4.40098000e+01 * (-working_temp * h[11] / cp_avg + cp[11]) + jac[12] * h[11] * rho
    + spec_rates[12] * 2.90183400e+01 * (-working_temp * h[12] / cp_avg + cp[12]) + jac[13] * h[12] * rho
    + spec_rates[13] * 4.50177400e+01 * (-working_temp * h[13] / cp_avg + cp[13]) + jac[14] * h[13] * rho
    + spec_rates[14] * 1.40067400e+01 * (-working_temp * h[14] / cp_avg + cp[14]) + jac[15] * h[14] * rho
    + spec_rates[15] * 1.50146800e+01 * (-working_temp * h[15] / cp_avg + cp[15]) + jac[16] * h[15] * rho
    + spec_rates[16] * 1.60226200e+01 * (-working_temp * h[16] / cp_avg + cp[16]) + jac[17] * h[16] * rho
    + spec_rates[17] * 1.70305600e+01 * (-working_temp * h[17] / cp_avg + cp[17]) + jac[18] * h[17] * rho
    + spec_rates[18] * 2.90214200e+01 * (-working_temp * h[18] / cp_avg + cp[18]) + jac[19] * h[18] * rho
    + spec_rates[19] * 3.00293600e+01 * (-working_temp * h[19] / cp_avg + cp[19]) + jac[20] * h[19] * rho
    + spec_rates[20] * 3.10373000e+01 * (-working_temp * h[20] / cp_avg + cp[20]) + jac[21] * h[20] * rho
    + spec_rates[21] * 3.20452400e+01 * (-working_temp * h[21] / cp_avg + cp[21]) + jac[22] * h[21] * rho
    + spec_rates[22] * 3.00293600e+01 * (-working_temp * h[22] / cp_avg + cp[22]) + jac[23] * h[22] * rho
    + spec_rates[23] * 3.00061400e+01 * (-working_temp * h[23] / cp_avg + cp[23]) + jac[24] * h[23] * rho
    + spec_rates[24] * 4.40128800e+01 * (-working_temp * h[24] / cp_avg + cp[24]) + jac[25] * h[24] * rho
    + spec_rates[25] * 4.60055400e+01 * (-working_temp * h[25] / cp_avg + cp[25]) + jac[26] * h[25] * rho
    + spec_rates[26] * 3.10140800e+01 * (-working_temp * h[26] / cp_avg + cp[26]) + jac[27] * h[26] * rho
    + spec_rates[27] * 3.10140800e+01 * (-working_temp * h[27] / cp_avg + cp[27]) + jac[28] * h[27] * rho
    + spec_rates[28] * 4.70134800e+01 * (-working_temp * h[28] / cp_avg + cp[28]) + jac[29] * h[28] * rho
    + spec_rates[29] * 3.20220200e+01 * (-working_temp * h[29] / cp_avg + cp[29]) + jac[30] * h[29] * rho
    + spec_rates[30] * 3.20220200e+01 * (-working_temp * h[30] / cp_avg + cp[30]) + jac[31] * h[30] * rho
    + spec_rates[31] * 3.30299600e+01 * (-working_temp * h[31] / cp_avg + cp[31]) + jac[32] * h[31] * rho
    + spec_rates[32] * 4.70134800e+01 * (-working_temp * h[32] / cp_avg + cp[32]) + jac[33] * h[32] * rho
    + spec_rates[33] * 6.30128800e+01 * (-working_temp * h[33] / cp_avg + cp[33]) + jac[34] * h[33] * rho
    + spec_rates[34] * 6.20049400e+01 * (-working_temp * h[34] / cp_avg + cp[34]) + jac[35] * h[34] * rho
    + spec_rates[35] * 2.80134800e+01 * (-working_temp * h[35] / cp_avg + cp[35]) + J_nplusone * h[35] * rho) / (rho * cp_avg);
} // end eval_jacob

