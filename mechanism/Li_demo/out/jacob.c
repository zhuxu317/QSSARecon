#include "jacob.h"

void eval_jacob (const double t, const double pres, const double * __restrict__ y, double * __restrict__ jac) {

  double T = y[0];

  // average molecular weight
  double mw_avg;
  // mass-averaged density
  double rho;
  // species molar concentrations
  double conc[6];
  double y_N;
  eval_conc(y[0], pres, &y[1], &y_N, &mw_avg, &rho, conc);

  // evaluate reaction rates
  double fwd_rates[6];
  double rev_rates[6];
  eval_rxn_rates (T, pres, conc, fwd_rates, rev_rates);

  double pres_mod[3];
  //get pressure modifications to reaction rates
  get_rxn_pres_mod (T, pres, conc, pres_mod);

  // evaluate rate of change of species molar concentration
  double spec_rates[6] = {0};
  eval_spec_rates (fwd_rates, rev_rates, pres_mod, spec_rates, &spec_rates[5]);

  double m = pres / (8.31446210e+03 * T);
  double conc_temp;
  double logT = log(T);
  double j_temp = 0.0;
  double kf = 0.0;
  double pres_mod_temp = 0.0;
  double Kc = 0.0;
  double kr = 0;
  double rho_inv = 1.0 / rho;
  double dBdT[6];
  if (T <= 1000.0) {
    dBdT[0] = (2.2981243099999999e+00 + -1.0125208699999999e+03 / T) / T + 4.1247208700000002e-04 + T * (-2.7143384300000001e-07 + T * (-2.3688585825000001e-11 + 8.2697444799999997e-14 * T));
    dBdT[1] = (1.9464287800000002e+00 + 2.9147644499999999e+04 / T) / T + -8.1908324499999996e-04 + T * (8.0701056666666666e-07 + T * (-4.0071079749999999e-10 + 7.7813927199999998e-14 * T));
    dBdT[2] = (2.3868424899999998e+00 + -3.0208113300000001e+04 / T) / T + 1.7374912300000000e-03 + T * (-2.1182321100000001e-06 + T * (1.7421453174999999e-09 + -5.0131769400000000e-13 * T));
    dBdT[3] = (1.5000000000000000e+00 + 2.5471627000000000e+04 / T) / T + 0.0000000000000000e+00 + T * (0.0000000000000000e+00 + T * (0.0000000000000000e+00 + 0.0000000000000000e+00 * T));
    dBdT[4] = (3.1253056099999998e+00 + 3.3463091300000001e+03 / T) / T + -1.6127246950000001e-03 + T * (2.1758823033333334e-06 + T * (-1.4496341075000000e-09 + 4.1247475799999997e-13 * T));
  } else {
    dBdT[0] = (1.9914233700000001e+00 + -8.3503399700000000e+02 / T) / T + 3.5003220550000000e-04 + T * (-1.8779428966666666e-08 + T * (-2.3078945450000001e-12 + 3.1655035799999998e-16 * T));
    dBdT[1] = (1.5420596600000001e+00 + 2.9230802700000000e+04 / T) / T + -1.3775309550000000e-05 + T * (-1.0342677833333334e-09 + T * (1.1377668549999999e-12 + -8.7361029999999991e-17 * T));
    dBdT[2] = (1.6721456099999998e+00 + -2.9899208999999999e+04 / T) / T + 1.5281464449999999e-03 + T * (-2.9100867033333330e-07 + T * (3.0024909750000002e-11 + -1.2783235740000001e-15 * T));
    dBdT[3] = (1.5000000000000000e+00 + 2.5471627000000000e+04 / T) / T + 0.0000000000000000e+00 + T * (0.0000000000000000e+00 + T * (0.0000000000000000e+00 + 0.0000000000000000e+00 * T));
    dBdT[4] = (1.8647288600000000e+00 + 3.6836287499999999e+03 / T) / T + 5.2825224000000001e-04 + T * (-8.6360919333333338e-08 + T * (7.6304668500000001e-12 + -2.6639175200000000e-16 * T));
  }

  //partial of rxn 0 wrt T
  j_temp = ((1.0 / T) * ((fwd_rates[0] - rev_rates[0]) * (2.6699999999999999e+00 + (3.1652510629641329e+03 / T)) + fwd_rates[0] * -1.0 - rev_rates[0] * (-1.0 + -T * (dBdT[3] + dBdT[4] - dBdT[0] - dBdT[1])))) * rho_inv;
  jac[1] = -j_temp * 2.0160000000000000e+00;
  jac[2] = -j_temp * 1.5999000000000001e+01;
  jac[4] = j_temp * 1.0080000000000000e+00;
  jac[5] = j_temp * 1.7007000000000001e+01;

  //partial of rxn 0 wrt species
  if (T <= 1000.0) {
    Kc = (-1.2012039779999988e+00 + 3.8075251999999971e-01 * logT + T * (-1.2061135370000002e-03 + T * (8.2015278983333341e-07 + T * (-3.4174490805833331e-10 + 6.2990846499999988e-14 * T))) - 6.8281250000000227e+02 / T);
  } else {
    Kc = (1.8450793220000010e+00 + -1.6875417000000015e-01 * logT + T * (1.9199534405000000e-04 + T * (-3.3273611291666666e-08 + T * (2.9335315133333332e-12 + -1.2389526999999999e-16 * T))) - 7.5948704699999871e+02 / T);
  }

  Kc = exp(Kc);
  j_temp = -mw_avg * rho_inv * (2.0 * fwd_rates[0] - 2.0 * rev_rates[0]);
  kf = exp(3.9278963545844361e+00 + 2.67 * logT - (3.1652510629641329e+03 / T));
  kr = kf / Kc;
  jac[7] =  -(j_temp * 9.2803598200899551e-01 + kf * conc[1]);
  jac[8] =  -7.9360119047619051e+00 * (j_temp * 9.2803598200899551e-01 + kf * conc[1]);
  jac[10] =  5.0000000000000000e-01 * (j_temp * 9.2803598200899551e-01 + kf * conc[1]);
  jac[11] =  8.4360119047619051e+00 * (j_temp * 9.2803598200899551e-01 + kf * conc[1]);
  jac[13] =  -1.2600787549221826e-01 * (j_temp * 4.2889269650888839e-01 + kf * conc[0]);
  jac[14] =  -(j_temp * 4.2889269650888839e-01 + kf * conc[0]);
  jac[16] =  6.3003937746109129e-02 * (j_temp * 4.2889269650888839e-01 + kf * conc[0]);
  jac[17] =  1.0630039377461091e+00 * (j_temp * 4.2889269650888839e-01 + kf * conc[0]);
  jac[19] =  -1.1190674437968359e-01 * (j_temp * 3.5692867851788390e-01);
  jac[20] =  -8.8809325562031638e-01 * (j_temp * 3.5692867851788390e-01);
  jac[22] =  5.5953372189841796e-02 * (j_temp * 3.5692867851788390e-01);
  jac[23] =  9.4404662781015825e-01 * (j_temp * 3.5692867851788390e-01);
  jac[25] =  -2.0000000000000000e+00 * (j_temp * 9.6401799100449770e-01 - kr * conc[4]);
  jac[26] =  -1.5872023809523810e+01 * (j_temp * 9.6401799100449770e-01 - kr * conc[4]);
  jac[28] =  (j_temp * 9.6401799100449770e-01 - kr * conc[4]);
  jac[29] =  1.6872023809523810e+01 * (j_temp * 9.6401799100449770e-01 - kr * conc[4]);
  jac[31] =  -1.1853942494267065e-01 * (j_temp * 3.9291068751338609e-01 - kr * conc[3]);
  jac[32] =  -9.4073028752866461e-01 * (j_temp * 3.9291068751338609e-01 - kr * conc[3]);
  jac[34] =  5.9269712471335327e-02 * (j_temp * 3.9291068751338609e-01 - kr * conc[3]);
  jac[35] =  (j_temp * 3.9291068751338609e-01 - kr * conc[3]);

  //partial of rxn 1 wrt T
  j_temp = ((1.0 / T) * ((fwd_rates[1] - rev_rates[1]) * (1.5100000000000000e+00 + (1.7260431074669279e+03 / T)) + fwd_rates[1] * -1.0 - rev_rates[1] * (-1.0 + -T * (dBdT[3] + dBdT[2] - dBdT[0] - dBdT[4])))) * rho_inv;
  jac[1] += -j_temp * 2.0160000000000000e+00;
  jac[3] = j_temp * 1.8015000000000001e+01;
  jac[4] += j_temp * 1.0080000000000000e+00;
  jac[5] += -j_temp * 1.7007000000000001e+01;

  //partial of rxn 1 wrt species
  if (T <= 1000.0) {
    Kc = (7.6512297220000001e+00 + -1.5365874300000000e+00 * logT + T * (2.9377438380000002e-03 + T * (-2.0113402851666665e-06 + T * (1.0718226702749999e-09 + -2.4912247419999999e-13 * T))) - -7.0702745599999998e+03 / T);
  } else {
    Kc = (2.7401752319999999e+00 + -6.8400662000000034e-01 * logT + T * (6.4986199949999997e-04 + T * (-9.2934161016666649e-08 + T * (8.2341124816666671e-12 + -3.3212054500000006e-16 * T))) - -7.2761767529999997e+03 / T);
  }

  Kc = exp(Kc);
  j_temp = -mw_avg * rho_inv * (2.0 * fwd_rates[1] - 2.0 * rev_rates[1]);
  kf = exp(1.2283033686666302e+01 + 1.51 * logT - (1.7260431074669279e+03 / T));
  kr = kf / Kc;
  jac[7] +=  -(j_temp * 9.2803598200899551e-01 + kf * conc[4]);
  jac[9] =  8.9360119047619051e+00 * (j_temp * 9.2803598200899551e-01 + kf * conc[4]);
  jac[10] +=  5.0000000000000000e-01 * (j_temp * 9.2803598200899551e-01 + kf * conc[4]);
  jac[11] +=  -8.4360119047619051e+00 * (j_temp * 9.2803598200899551e-01 + kf * conc[4]);
  jac[13] +=  -1.2600787549221826e-01 * (j_temp * 4.2889269650888839e-01);
  jac[15] =  1.1260078754922183e+00 * (j_temp * 4.2889269650888839e-01);
  jac[16] +=  6.3003937746109129e-02 * (j_temp * 4.2889269650888839e-01);
  jac[17] +=  -1.0630039377461091e+00 * (j_temp * 4.2889269650888839e-01);
  jac[19] +=  -1.1190674437968359e-01 * (j_temp * 3.5692867851788390e-01 - kr * conc[3]);
  jac[21] =  (j_temp * 3.5692867851788390e-01 - kr * conc[3]);
  jac[22] +=  5.5953372189841796e-02 * (j_temp * 3.5692867851788390e-01 - kr * conc[3]);
  jac[23] +=  -9.4404662781015825e-01 * (j_temp * 3.5692867851788390e-01 - kr * conc[3]);
  jac[25] +=  -2.0000000000000000e+00 * (j_temp * 9.6401799100449770e-01 - kr * conc[2]);
  jac[27] =  1.7872023809523810e+01 * (j_temp * 9.6401799100449770e-01 - kr * conc[2]);
  jac[28] +=  (j_temp * 9.6401799100449770e-01 - kr * conc[2]);
  jac[29] +=  -1.6872023809523810e+01 * (j_temp * 9.6401799100449770e-01 - kr * conc[2]);
  jac[31] +=  -1.1853942494267065e-01 * (j_temp * 3.9291068751338609e-01 + kf * conc[0]);
  jac[33] =  1.0592697124713353e+00 * (j_temp * 3.9291068751338609e-01 + kf * conc[0]);
  jac[34] +=  5.9269712471335327e-02 * (j_temp * 3.9291068751338609e-01 + kf * conc[0]);
  jac[35] +=  -(j_temp * 3.9291068751338609e-01 + kf * conc[0]);

  //partial of rxn 2 wrt T
  j_temp = ((1.0 / T) * ((fwd_rates[2] - rev_rates[2]) * (2.0200000000000000e+00 + (6.7431421691127798e+03 / T)) + fwd_rates[2] * -1.0 - rev_rates[2] * (-1.0 + -T * (2.0 * dBdT[4] - dBdT[2] - dBdT[1])))) * rho_inv;
  jac[2] += -j_temp * 1.5999000000000001e+01;
  jac[3] += -j_temp * 1.8015000000000001e+01;
  jac[5] += j_temp * 2.0 * 1.7007000000000001e+01;

  //partial of rxn 2 wrt species
  if (T <= 1000.0) {
    Kc = (-8.8524336999999989e+00 + 1.9173399499999997e+00 * logT + T * (-4.1438573750000006e-03 + T * (2.8314930750000003e-06 + T * (-1.4135675783333333e-09 + 3.1211332070000001e-13 * T))) - 7.7530870600000026e+03 / T);
  } else {
    Kc = (-8.9509590999999933e-01 + 5.1525245000000020e-01 * logT + T * (-4.5786665544999996e-04 + T * (5.9660549724999983e-08 + T * (-5.3005809683333344e-12 + 2.0822527500000000e-16 * T))) - 8.0356637999999984e+03 / T);
  }

  Kc = exp(Kc);
  j_temp = -mw_avg * rho_inv * (2.0 * fwd_rates[2] - 2.0 * rev_rates[2]);
  kf = exp(7.9963172317967457e+00 + 2.02 * logT - (6.7431421691127798e+03 / T));
  kr = kf / Kc;
  jac[8] +=  -7.9360119047619051e+00 * (j_temp * 9.2803598200899551e-01);
  jac[9] +=  -8.9360119047619051e+00 * (j_temp * 9.2803598200899551e-01);
  jac[11] +=  1.6872023809523810e+01 * (j_temp * 9.2803598200899551e-01);
  jac[14] +=  -(j_temp * 4.2889269650888839e-01 + kf * conc[2]);
  jac[15] +=  -1.1260078754922183e+00 * (j_temp * 4.2889269650888839e-01 + kf * conc[2]);
  jac[17] +=  2.1260078754922183e+00 * (j_temp * 4.2889269650888839e-01 + kf * conc[2]);
  jac[20] +=  -8.8809325562031638e-01 * (j_temp * 3.5692867851788390e-01 + kf * conc[1]);
  jac[21] +=  -(j_temp * 3.5692867851788390e-01 + kf * conc[1]);
  jac[23] +=  1.8880932556203165e+00 * (j_temp * 3.5692867851788390e-01 + kf * conc[1]);
  jac[26] +=  -1.5872023809523810e+01 * (j_temp * 9.6401799100449770e-01);
  jac[27] +=  -1.7872023809523810e+01 * (j_temp * 9.6401799100449770e-01);
  jac[29] +=  3.3744047619047620e+01 * (j_temp * 9.6401799100449770e-01);
  jac[32] +=  -9.4073028752866461e-01 * (j_temp * 3.9291068751338609e-01 - kr * 2.0 * conc[4]);
  jac[33] +=  -1.0592697124713353e+00 * (j_temp * 3.9291068751338609e-01 - kr * 2.0 * conc[4]);
  jac[35] +=  2.0000000000000000e+00 * (j_temp * 3.9291068751338609e-01 - kr * 2.0 * conc[4]);

  //partial of rxn 3 wrt T
  j_temp = ((-pres_mod[0] * (fwd_rates[3] - rev_rates[3]) / T) + (pres_mod[0] / T) * ((fwd_rates[3] - rev_rates[3]) * (-1.3999999999999999e+00 + (5.2526058179999396e+04 / T)) - rev_rates[3] * (-1.0 + -T * (2.0 * dBdT[3] - dBdT[0])))) * rho_inv;
  jac[1] += -j_temp * 2.0160000000000000e+00;
  jac[4] += j_temp * 2.0 * 1.0080000000000000e+00;

  //partial of rxn 3 wrt species
  if (T <= 1000.0) {
    Kc = (6.7198318400000012e-01 + 7.0187569000000005e-01 * logT + T * (-4.1247208700000002e-04 + T * (1.3571692150000000e-07 + T * (7.8961952749999999e-12 + -2.0674361199999999e-14 * T))) - 5.1955774870000001e+04 / T);
  } else {
    Kc = (-1.5737017359999994e+00 + 1.0085766299999999e+00 * logT + T * (-3.5003220550000000e-04 + T * (9.3897144833333331e-09 + T * (7.6929818166666671e-13 + -7.9137589499999995e-17 * T))) - 5.1778287996999999e+04 / T);
  }

  Kc = 1.2186597134166982e+01 * exp(Kc);
  pres_mod_temp = (fwd_rates[3] - rev_rates[3]);
  j_temp = -mw_avg * rho_inv * pres_mod[0] * (2.0 * fwd_rates[3] - 3.0 * rev_rates[3]);
  kf = exp(3.8362405249576234e+01 - 1.4 * logT - (5.2526058179999396e+04 / T));
  kr = kf / Kc;
  jac[7] +=  -(j_temp * 9.2803598200899551e-01 + 2.4280359820089954e+00 * pres_mod_temp + pres_mod[0] * (kf));
  jac[10] +=  (j_temp * 9.2803598200899551e-01 + 2.4280359820089954e+00 * pres_mod_temp + pres_mod[0] * (kf));
  jac[13] +=  -1.2600787549221826e-01 * (j_temp * 4.2889269650888839e-01 + 4.2889269650888839e-01 * pres_mod_temp);
  jac[16] +=  1.2600787549221826e-01 * (j_temp * 4.2889269650888839e-01 + 4.2889269650888839e-01 * pres_mod_temp);
  jac[19] +=  -1.1190674437968359e-01 * (j_temp * 3.5692867851788390e-01 + 1.1356928678517884e+01 * pres_mod_temp);
  jac[22] +=  1.1190674437968359e-01 * (j_temp * 3.5692867851788390e-01 + 1.1356928678517884e+01 * pres_mod_temp);
  jac[25] +=  -2.0000000000000000e+00 * (j_temp * 9.6401799100449770e-01 + 9.6401799100449770e-01 * pres_mod_temp + pres_mod[0] * (-kr * 2.0 * conc[3]));
  jac[28] +=  2.0000000000000000e+00 * (j_temp * 9.6401799100449770e-01 + 9.6401799100449770e-01 * pres_mod_temp + pres_mod[0] * (-kr * 2.0 * conc[3]));
  jac[31] +=  -1.1853942494267065e-01 * (j_temp * 3.9291068751338609e-01 + 3.9291068751338609e-01 * pres_mod_temp);
  jac[34] +=  1.1853942494267065e-01 * (j_temp * 3.9291068751338609e-01 + 3.9291068751338609e-01 * pres_mod_temp);

  //partial of rxn 4 wrt T
  j_temp = ((-pres_mod[1] * (fwd_rates[4] - rev_rates[4]) / T) + (pres_mod[1] / T) * ((fwd_rates[4] - rev_rates[4]) * (-1.0000000000000000e+00) + fwd_rates[4] * -1.0 - rev_rates[4] * (-T * (dBdT[4] - dBdT[3] - dBdT[1])))) * rho_inv;
  jac[2] += -j_temp * 1.5999000000000001e+01;
  jac[4] += -j_temp * 1.0080000000000000e+00;
  jac[5] += j_temp * 1.7007000000000001e+01;

  //partial of rxn 4 wrt species
  if (T <= 1000.0) {
    Kc = (-1.8731871619999994e+00 + -3.2112317000000035e-01 * logT + T * (-7.9364145000000014e-04 + T * (6.8443586833333335e-07 + T * (-3.4964110333333333e-10 + 8.3665207700000000e-14 * T))) - -5.1272962370000001e+04 / T);
  } else {
    Kc = (3.4187810580000004e+00 + -1.1773308000000000e+00 * logT + T * (5.4202754955000006e-04 + T * (-4.2663325775000005e-08 + T * (2.1642333316666664e-12 + -4.4757680500000001e-17 * T))) - -5.1018800950000004e+04 / T);
  }

  Kc = 8.2057360967184814e-02 * exp(Kc);
  pres_mod_temp = (fwd_rates[4] - rev_rates[4]);
  j_temp = -mw_avg * rho_inv * pres_mod[1] * (3.0 * fwd_rates[4] - 2.0 * rev_rates[4]);
  kf = exp(2.9181557920442486e+01 - 1.0 * logT);
  kr = kf / Kc;
  jac[8] +=  -7.9360119047619051e+00 * (j_temp * 9.2803598200899551e-01 + 2.4280359820089954e+00 * pres_mod_temp);
  jac[10] +=  -5.0000000000000000e-01 * (j_temp * 9.2803598200899551e-01 + 2.4280359820089954e+00 * pres_mod_temp);
  jac[11] +=  8.4360119047619051e+00 * (j_temp * 9.2803598200899551e-01 + 2.4280359820089954e+00 * pres_mod_temp);
  jac[14] +=  -(j_temp * 4.2889269650888839e-01 + 4.2889269650888839e-01 * pres_mod_temp + pres_mod[1] * (kf * conc[3]));
  jac[16] +=  -6.3003937746109129e-02 * (j_temp * 4.2889269650888839e-01 + 4.2889269650888839e-01 * pres_mod_temp + pres_mod[1] * (kf * conc[3]));
  jac[17] +=  1.0630039377461091e+00 * (j_temp * 4.2889269650888839e-01 + 4.2889269650888839e-01 * pres_mod_temp + pres_mod[1] * (kf * conc[3]));
  jac[20] +=  -8.8809325562031638e-01 * (j_temp * 3.5692867851788390e-01 + 1.1356928678517884e+01 * pres_mod_temp);
  jac[22] +=  -5.5953372189841796e-02 * (j_temp * 3.5692867851788390e-01 + 1.1356928678517884e+01 * pres_mod_temp);
  jac[23] +=  9.4404662781015825e-01 * (j_temp * 3.5692867851788390e-01 + 1.1356928678517884e+01 * pres_mod_temp);
  jac[26] +=  -1.5872023809523810e+01 * (j_temp * 9.6401799100449770e-01 + 9.6401799100449770e-01 * pres_mod_temp + pres_mod[1] * (kf * conc[1]));
  jac[28] +=  -(j_temp * 9.6401799100449770e-01 + 9.6401799100449770e-01 * pres_mod_temp + pres_mod[1] * (kf * conc[1]));
  jac[29] +=  1.6872023809523810e+01 * (j_temp * 9.6401799100449770e-01 + 9.6401799100449770e-01 * pres_mod_temp + pres_mod[1] * (kf * conc[1]));
  jac[32] +=  -9.4073028752866461e-01 * (j_temp * 3.9291068751338609e-01 + 3.9291068751338609e-01 * pres_mod_temp + pres_mod[1] * (-kr));
  jac[34] +=  -5.9269712471335327e-02 * (j_temp * 3.9291068751338609e-01 + 3.9291068751338609e-01 * pres_mod_temp + pres_mod[1] * (-kr));
  jac[35] +=  (j_temp * 3.9291068751338609e-01 + 3.9291068751338609e-01 * pres_mod_temp + pres_mod[1] * (-kr));

  //partial of rxn 5 wrt T
  j_temp = ((-pres_mod[2] * (fwd_rates[5] - rev_rates[5]) / T) + (pres_mod[2] / T) * ((fwd_rates[5] - rev_rates[5]) * (-2.0000000000000000e+00) + fwd_rates[5] * -1.0 - rev_rates[5] * (-T * (dBdT[2] - dBdT[3] - dBdT[4])))) * rho_inv;
  jac[3] += j_temp * 1.8015000000000001e+01;
  jac[4] += -j_temp * 1.0080000000000000e+00;
  jac[5] += -j_temp * 1.7007000000000001e+01;

  //partial of rxn 5 wrt species
  if (T <= 1000.0) {
    Kc = (6.9792465379999999e+00 + -2.2384631200000000e+00 * logT + T * (3.3502159250000003e-03 + T * (-2.1470572066666667e-06 + T * (1.0639264750000000e-09 + -2.2844811300000001e-13 * T))) - -5.9026049430000006e+04 / T);
  } else {
    Kc = (4.3138769680000006e+00 + -1.6925832500000002e+00 * logT + T * (9.9989420499999992e-04 + T * (-1.0232387549999998e-07 + T * (7.4648143000000012e-12 + -2.5298295550000004e-16 * T))) - -5.9054464749999999e+04 / T);
  }

  Kc = 8.2057360967184814e-02 * exp(Kc);
  pres_mod_temp = (fwd_rates[5] - rev_rates[5]);
  j_temp = -mw_avg * rho_inv * pres_mod[2] * (3.0 * fwd_rates[5] - 2.0 * rev_rates[5]);
  kf = exp(3.8176362554637073e+01 - 2.0 * logT);
  kr = kf / Kc;
  jac[9] +=  8.9360119047619051e+00 * (j_temp * 9.2803598200899551e-01 + 2.4280359820089954e+00 * pres_mod_temp);
  jac[10] +=  -5.0000000000000000e-01 * (j_temp * 9.2803598200899551e-01 + 2.4280359820089954e+00 * pres_mod_temp);
  jac[11] +=  -8.4360119047619051e+00 * (j_temp * 9.2803598200899551e-01 + 2.4280359820089954e+00 * pres_mod_temp);
  jac[15] +=  1.1260078754922183e+00 * (j_temp * 4.2889269650888839e-01 + 4.2889269650888839e-01 * pres_mod_temp);
  jac[16] +=  -6.3003937746109129e-02 * (j_temp * 4.2889269650888839e-01 + 4.2889269650888839e-01 * pres_mod_temp);
  jac[17] +=  -1.0630039377461091e+00 * (j_temp * 4.2889269650888839e-01 + 4.2889269650888839e-01 * pres_mod_temp);
  jac[21] +=  (j_temp * 3.5692867851788390e-01 + 1.1356928678517884e+01 * pres_mod_temp + pres_mod[2] * (-kr));
  jac[22] +=  -5.5953372189841796e-02 * (j_temp * 3.5692867851788390e-01 + 1.1356928678517884e+01 * pres_mod_temp + pres_mod[2] * (-kr));
  jac[23] +=  -9.4404662781015825e-01 * (j_temp * 3.5692867851788390e-01 + 1.1356928678517884e+01 * pres_mod_temp + pres_mod[2] * (-kr));
  jac[27] +=  1.7872023809523810e+01 * (j_temp * 9.6401799100449770e-01 + 9.6401799100449770e-01 * pres_mod_temp + pres_mod[2] * (kf * conc[4]));
  jac[28] +=  -(j_temp * 9.6401799100449770e-01 + 9.6401799100449770e-01 * pres_mod_temp + pres_mod[2] * (kf * conc[4]));
  jac[29] +=  -1.6872023809523810e+01 * (j_temp * 9.6401799100449770e-01 + 9.6401799100449770e-01 * pres_mod_temp + pres_mod[2] * (kf * conc[4]));
  jac[33] +=  1.0592697124713353e+00 * (j_temp * 3.9291068751338609e-01 + 3.9291068751338609e-01 * pres_mod_temp + pres_mod[2] * (kf * conc[3]));
  jac[34] +=  -5.9269712471335327e-02 * (j_temp * 3.9291068751338609e-01 + 3.9291068751338609e-01 * pres_mod_temp + pres_mod[2] * (kf * conc[3]));
  jac[35] +=  -(j_temp * 3.9291068751338609e-01 + 3.9291068751338609e-01 * pres_mod_temp + pres_mod[2] * (kf * conc[3]));

  // species enthalpies
  double h[6];
  eval_h(T, h);

  // species specific heats
  double cp[6];
  eval_cp(T, cp);

  // average specific heat
  double cp_avg;
  cp_avg = (y[1] * cp[0]) + (y[2] * cp[1]) + (y[3] * cp[2]) + (y[4] * cp[3]) + 
     (y[5] * cp[4]) + (y_N * cp[5]);
  jac[0] = 0.0;
  double working_temp = (1.0 / cp_avg);
  j_temp = 1.0 / (rho * cp_avg * cp_avg);
  //Finish dYk / Yj's
  //And dT/dYj's
  jac[7] += (spec_rates[0] * mw_avg * 9.2803598200899551e-01 * rho_inv);
  jac[6] = -(h[0] * (working_temp * jac[7] - (j_temp * (cp[0] - cp[5]) * spec_rates[0] * 2.01600000e+00)));
  jac[13] += (spec_rates[0] * mw_avg * 5.4043857501213759e-02 * rho_inv);
  jac[12] = -(h[0] * (working_temp * jac[13] - (j_temp * (cp[1] - cp[5]) * spec_rates[0] * 2.01600000e+00)));
  jac[19] += (spec_rates[0] * mw_avg * 3.9942726388679094e-02 * rho_inv);
  jac[18] = -(h[0] * (working_temp * jac[19] - (j_temp * (cp[2] - cp[5]) * spec_rates[0] * 2.01600000e+00)));
  jac[25] += (spec_rates[0] * mw_avg * 1.9280359820089954e+00 * rho_inv);
  jac[24] = -(h[0] * (working_temp * jac[25] - (j_temp * (cp[3] - cp[5]) * spec_rates[0] * 2.01600000e+00)));
  jac[31] += (spec_rates[0] * mw_avg * 4.6575406951666155e-02 * rho_inv);
  jac[30] = -(h[0] * (working_temp * jac[31] - (j_temp * (cp[4] - cp[5]) * spec_rates[0] * 2.01600000e+00)));
  jac[8] += (spec_rates[1] * mw_avg * 7.3649046012707933e+00 * rho_inv);
  jac[6] -= (h[1] * (working_temp * jac[8] - (j_temp * (cp[0] - cp[5]) * spec_rates[1] * 1.59990000e+01)));
  jac[14] += (spec_rates[1] * mw_avg * 4.2889269650888839e-01 * rho_inv);
  jac[12] -= (h[1] * (working_temp * jac[14] - (j_temp * (cp[1] - cp[5]) * spec_rates[1] * 1.59990000e+01)));
  jac[20] += (spec_rates[1] * mw_avg * 3.1698595212920477e-01 * rho_inv);
  jac[18] -= (h[1] * (working_temp * jac[20] - (j_temp * (cp[2] - cp[5]) * spec_rates[1] * 1.59990000e+01)));
  jac[26] += (spec_rates[1] * mw_avg * 1.5300916506032697e+01 * rho_inv);
  jac[24] -= (h[1] * (working_temp * jac[26] - (j_temp * (cp[3] - cp[5]) * spec_rates[1] * 1.59990000e+01)));
  jac[32] += (spec_rates[1] * mw_avg * 3.6962298403755300e-01 * rho_inv);
  jac[30] -= (h[1] * (working_temp * jac[32] - (j_temp * (cp[4] - cp[5]) * spec_rates[1] * 1.59990000e+01)));
  jac[9] += (spec_rates[2] * mw_avg * 8.2929405832797887e+00 * rho_inv);
  jac[6] -= (h[2] * (working_temp * jac[9] - (j_temp * (cp[0] - cp[5]) * spec_rates[2] * 1.80150000e+01)));
  jac[15] += (spec_rates[2] * mw_avg * 4.8293655401010216e-01 * rho_inv);
  jac[12] -= (h[2] * (working_temp * jac[15] - (j_temp * (cp[1] - cp[5]) * spec_rates[2] * 1.80150000e+01)));
  jac[21] += (spec_rates[2] * mw_avg * 3.5692867851788390e-01 * rho_inv);
  jac[18] -= (h[2] * (working_temp * jac[21] - (j_temp * (cp[2] - cp[5]) * spec_rates[2] * 1.80150000e+01)));
  jac[27] += (spec_rates[2] * mw_avg * 1.7228952488041692e+01 * rho_inv);
  jac[24] -= (h[2] * (working_temp * jac[27] - (j_temp * (cp[3] - cp[5]) * spec_rates[2] * 1.80150000e+01)));
  jac[33] += (spec_rates[2] * mw_avg * 4.1619839098921912e-01 * rho_inv);
  jac[30] -= (h[2] * (working_temp * jac[33] - (j_temp * (cp[4] - cp[5]) * spec_rates[2] * 1.80150000e+01)));
  jac[10] += (spec_rates[3] * mw_avg * 4.6401799100449775e-01 * rho_inv);
  jac[6] -= (h[3] * (working_temp * jac[10] - (j_temp * (cp[0] - cp[5]) * spec_rates[3] * 1.00800000e+00)));
  jac[16] += (spec_rates[3] * mw_avg * 2.7021928750606879e-02 * rho_inv);
  jac[12] -= (h[3] * (working_temp * jac[16] - (j_temp * (cp[1] - cp[5]) * spec_rates[3] * 1.00800000e+00)));
  jac[22] += (spec_rates[3] * mw_avg * 1.9971363194339547e-02 * rho_inv);
  jac[18] -= (h[3] * (working_temp * jac[22] - (j_temp * (cp[2] - cp[5]) * spec_rates[3] * 1.00800000e+00)));
  jac[28] += (spec_rates[3] * mw_avg * 9.6401799100449770e-01 * rho_inv);
  jac[24] -= (h[3] * (working_temp * jac[28] - (j_temp * (cp[3] - cp[5]) * spec_rates[3] * 1.00800000e+00)));
  jac[34] += (spec_rates[3] * mw_avg * 2.3287703475833078e-02 * rho_inv);
  jac[30] -= (h[3] * (working_temp * jac[34] - (j_temp * (cp[4] - cp[5]) * spec_rates[3] * 1.00800000e+00)));
  jac[11] += (spec_rates[4] * mw_avg * 7.8289225922752914e+00 * rho_inv);
  jac[6] -= (h[4] * (working_temp * jac[11] - (j_temp * (cp[0] - cp[5]) * spec_rates[4] * 1.70070000e+01)));
  jac[17] += (spec_rates[4] * mw_avg * 4.5591462525949528e-01 * rho_inv);
  jac[12] -= (h[4] * (working_temp * jac[17] - (j_temp * (cp[1] - cp[5]) * spec_rates[4] * 1.70070000e+01)));
  jac[23] += (spec_rates[4] * mw_avg * 3.3695731532354439e-01 * rho_inv);
  jac[18] -= (h[4] * (working_temp * jac[23] - (j_temp * (cp[2] - cp[5]) * spec_rates[4] * 1.70070000e+01)));
  jac[29] += (spec_rates[4] * mw_avg * 1.6264934497037196e+01 * rho_inv);
  jac[24] -= (h[4] * (working_temp * jac[29] - (j_temp * (cp[3] - cp[5]) * spec_rates[4] * 1.70070000e+01)));
  jac[35] += (spec_rates[4] * mw_avg * 3.9291068751338609e-01 * rho_inv);
  jac[30] -= (h[4] * (working_temp * jac[35] - (j_temp * (cp[4] - cp[5]) * spec_rates[4] * 1.70070000e+01)));
  if (T <= 1000.0) {
    working_temp = (y[1] * 4.1242371527777777e+03 * (8.2494417400000004e-04 + T * (-1.6286030580000000e-06 + T * (-2.8426302990000003e-10 + 1.6539488959999999e-12 * T))))
    + (y[2] * 5.1968636164760301e+02 * (-1.6381664899999999e-03 + T * (4.8420634000000000e-06 + T * (-4.8085295699999997e-09 + 1.5562785440000001e-12 * T))))
    + (y[3] * 4.6152995281709690e+02 * (3.4749824600000001e-03 + T * (-1.2709392660000001e-05 + T * (2.0905743809999998e-08 + -1.0026353879999999e-11 * T))))
    + (y[4] * 8.2484743055555555e+03 * (0.0000000000000000e+00 + T * (0.0000000000000000e+00 + T * (0.0000000000000000e+00 + 0.0000000000000000e+00 * T))))
    + (y[5] * 4.8888470041747513e+02 * (-3.2254493900000002e-03 + T * (1.3055293820000000e-05 + T * (-1.7395609290000000e-08 + 8.2494951599999996e-12 * T))))
    + (y_N * 2.9679667666166921e+02 * (1.4082400000000001e-03 + T * (-7.9264439999999996e-06 + T * (1.6924545000000002e-08 + -9.7794200000000003e-12 * T))));
  } else {
    working_temp = (y[1] * 4.1242371527777777e+03 * (7.0006441100000001e-04 + T * (-1.1267657380000000e-07 + T * (-2.7694734540000002e-11 + 6.3310071600000000e-15 * T))))
    + (y[2] * 5.1968636164760301e+02 * (-2.7550619100000000e-05 + T * (-6.2056066999999998e-09 + T * (1.3653202259999999e-11 + -1.7472205999999999e-15 * T))))
    + (y[3] * 4.6152995281709690e+02 * (3.0562928899999999e-03 + T * (-1.7460520219999999e-06 + T * (3.6029891700000000e-10 + -2.5566471480000000e-14 * T))))
    + (y[4] * 8.2484743055555555e+03 * (0.0000000000000000e+00 + T * (0.0000000000000000e+00 + T * (0.0000000000000000e+00 + 0.0000000000000000e+00 * T))))
    + (y[5] * 4.8888470041747513e+02 * (1.0565044800000000e-03 + T * (-5.1816551600000003e-07 + T * (9.1565602200000001e-11 + -5.3278350400000003e-15 * T))))
    + (y_N * 2.9679667666166921e+02 * (1.4879769999999999e-03 + T * (-1.1369521999999999e-06 + T * (3.0291120000000001e-10 + -2.7013403999999999e-14 * T))));
  }


  //Complete dT wrt T calculations
  jac[0] = -(spec_rates[0] * 2.01600000e+00 * (-working_temp * h[0] / cp_avg + cp[0]) + jac[1] * h[0] * rho
    + spec_rates[1] * 1.59990000e+01 * (-working_temp * h[1] / cp_avg + cp[1]) + jac[2] * h[1] * rho
    + spec_rates[2] * 1.80150000e+01 * (-working_temp * h[2] / cp_avg + cp[2]) + jac[3] * h[2] * rho
    + spec_rates[3] * 1.00800000e+00 * (-working_temp * h[3] / cp_avg + cp[3]) + jac[4] * h[3] * rho
    + spec_rates[4] * 1.70070000e+01 * (-working_temp * h[4] / cp_avg + cp[4]) + jac[5] * h[4] * rho
    + spec_rates[5] * 2.80140000e+01 * (-working_temp * h[5] / cp_avg + cp[5])) / (rho * cp_avg);
} // end eval_jacob

