#include "jacob.h"

void eval_jacob (const double t, const double pres, const double * __restrict__ y, double * __restrict__ jac) {

  double T = y[0];

  // average molecular weight
  double mw_avg;
  // mass-averaged density
  double rho;
  // species molar concentrations
  double conc[43];
  double y_N;
  eval_conc(y[0], pres, &y[1], &y_N, &mw_avg, &rho, conc);

  // evaluate reaction rates
  double fwd_rates[312];
  double rev_rates[306];
  eval_rxn_rates (T, pres, conc, fwd_rates, rev_rates);

  double pres_mod[37];
  //get pressure modifications to reaction rates
  get_rxn_pres_mod (T, pres, conc, pres_mod);

  // evaluate rate of change of species molar concentration
  double spec_rates[43] = {0};
  eval_spec_rates (fwd_rates, rev_rates, pres_mod, spec_rates, &spec_rates[42]);

  double m = pres / (8.31446210e+03 * T);
  double logT = log(T);
  double J_nplusone = 0;
  double J_nplusjplus[NSP];
  double dBdT[43];
  if (T <= 1000.0) {
    dBdT[0] = (3.1986352000000000e+00 + -3.0293725999999999e+04 / T) / T + -1.0182008500000000e-03 + T * (2.1734471999999999e-06 + T * (-1.3719817250000000e-09 + 3.5439360000000003e-13 * T));
    dBdT[1] = (1.2043520000000001e+00 + -6.5254880000000003e+03 / T) / T + 5.0573800000000002e-03 + T * (-4.8842166666666665e-06 + T * (3.6180874999999999e-09 + -1.0657018000000000e-12 * T));
    dBdT[2] = (3.1503668700000000e+00 + 9.7701867899999997e+03 / T) / T + -2.0444500400000000e-03 + T * (3.1269057533333334e-06 + T * (-1.8772722524999999e-09 + 4.2348559600000001e-13 * T));
    dBdT[3] = (1.4912635600000002e+00 + 8.8493862100000006e+03 / T) / T + 4.5811248799999997e-03 + T * (-2.7494928433333334e-06 + T * (9.5822414250000002e-10 + -1.4389235679999999e-13 * T));
    dBdT[4] = (2.7824563599999999e+00 + -1.0639435599999999e+03 / T) / T + -1.4983670799999999e-03 + T * (3.2824340033333332e-06 + T * (-2.4203237725000002e-09 + 6.4874567400000000e-13 * T));
    dBdT[5] = (1.3443311200000001e+00 + -9.1793517299999996e+02 / T) / T + 3.9902603749999996e-03 + T * (-6.4927169999999995e-06 + T * (5.0393023500000001e-09 + -1.4752235220000002e-12 * T));
    dBdT[6] = (2.3910091800000002e+00 + 2.7813067900000001e+03 / T) / T + 1.3122417400000001e-03 + T * (1.6993010199999999e-06 + T * (-1.9053012324999999e-09 + 5.5992027000000002e-13 * T));
    dBdT[7] = (1.5000000000000000e+00 + -7.4537500000000000e+02 / T) / T + 0.0000000000000000e+00 + T * (0.0000000000000000e+00 + T * (0.0000000000000000e+00 + 0.0000000000000000e+00 * T));
    dBdT[9] = (1.5000000000000000e+00 + 2.5473660000000000e+04 / T) / T + 0.0000000000000000e+00 + T * (0.0000000000000000e+00 + T * (0.0000000000000000e+00 + 0.0000000000000000e+00 * T));
    dBdT[10] = (2.1682671000000000e+00 + 2.9122259200000000e+04 / T) / T + -1.6396594200000000e-03 + T * (2.2143546533333334e-06 + T * (-1.5320165600000000e-09 + 4.2253194199999998e-13 * T));
    dBdT[11] = (2.9919842399999999e+00 + 3.3688983600000001e+03 / T) / T + -1.2005332749999999e-03 + T * (1.5388801100000001e-06 + T * (-9.6979076500000001e-10 + 2.7263900399999999e-13 * T));
    dBdT[12] = (3.3017980700000003e+00 + 2.6401848500000000e+02 / T) / T + -2.3745604850000002e-03 + T * (7.0527635000000006e-06 + T * (-6.0690978500000002e-09 + 1.8584504500000003e-12 * T));
    dBdT[13] = (3.3151514899999999e+00 + -1.7706743699999999e+04 / T) / T + -4.2369531099999998e-04 + T * (5.8801441000000001e-06 + T * (-5.6690735999999996e-09 + 1.8179003160000000e-12 * T));
    dBdT[15] = (2.9788353800000000e+00 + 2.1248667300000001e+04 / T) / T + -2.5694404399999999e-04 + T * (8.9478718666666669e-07 + T * (-2.2970815000000001e-10 + -1.9645023040000000e-14 * T));
    dBdT[16] = (2.4469720900000000e+00 + 4.1789926800000001e+04 / T) / T + 2.7892390899999999e-04 + T * (-6.6763119999999996e-07 + T * (7.1488230500000005e-10 + -2.2486856799999999e-13 * T));
    dBdT[17] = (1.4997664300000002e+00 + 5.6076071000000004e+04 / T) / T + 2.5107479700000002e-07 + T * (6.4363737000000003e-10 + T * (-1.2365815724999999e-12 + 5.4817901199999999e-16 * T));
    dBdT[18] = (-5.7457054999999979e-02 + 1.0965265100000001e+04 / T) / T + 1.0674413549999999e-02 + T * (-6.2901961999999993e-06 + T * (2.5240771750000002e-09 + -4.6199258399999992e-13 * T));
    dBdT[19] = (2.8027186199999998e+00 + 2.5752280900000002e+04 / T) / T + 2.7638207050000000e-03 + T * (2.2828667366666667e-07 + T * (-5.0074123250000003e-10 + 1.2428914839999998e-13 * T));
    dBdT[20] = (3.0659086999999996e+00 + 2.3295352999999999e+04 / T) / T + -2.1701220900000001e-03 + T * (7.1083438666666673e-06 + T * (-4.9209969999999997e-09 + 1.1937103440000000e-12 * T));
    dBdT[21] = (2.8770745299999998e+00 + 3.5263743399999999e+04 / T) / T + -1.3262225950000000e-03 + T * (6.2022058333333337e-06 + T * (-4.4173620750000000e-09 + 1.0776013519999999e-12 * T));
    dBdT[22] = (3.2547463199999997e+00 + 2.8580743699999999e+04 / T) / T + -1.7254914900000000e-03 + T * (4.5929566333333333e-06 + T * (-3.3315936000000000e-09 + 8.8204679400000002e-13 * T));
    dBdT[23] = (2.0944675899999998e+00 + 7.1862663199999997e+03 / T) / T + 7.5507286499999996e-03 + T * (-4.2149499333333336e-06 + T * (9.1809395249999996e-10 + 1.7243683440000000e-14 * T));
    dBdT[24] = (3.5198807800000003e+00 + 1.1763792500000000e+04 / T) / T + -2.7125381150000000e-03 + T * (5.6746545333333331e-06 + T * (-3.7177042999999998e-09 + 8.8952699600000006e-13 * T));
    dBdT[25] = (2.0558178599999999e+00 + 2.4609442400000000e+04 / T) / T + 2.2179555550000001e-03 + T * (-4.0739946666666668e-07 + T * (-2.8501862750000000e-10 + 1.3380508639999999e-13 * T));
    dBdT[26] = (2.9337086900000000e+00 + 6.5950721500000000e+03 / T) / T + 1.1058780249999999e-03 + T * (1.9540673366666668e-06 + T * (-1.6823294399999999e-09 + 4.3567234200000000e-13 * T));
    dBdT[27] = (1.9565198499999998e+00 + 1.0270952400000000e+04 / T) / T + 2.1259115499999998e-03 + T * (2.6836548633333330e-06 + T * (-2.6749988250000000e-09 + 7.2514361799999997e-13 * T));
    dBdT[28] = (1.4339949900000000e+00 + -6.0727228400000004e+03 / T) / T + 4.3813200300000001e-03 + T * (2.5594963499999999e-06 + T * (-3.7496437249999998e-09 + 1.1879340640000000e-12 * T));
    dBdT[29] = (2.4910661699999999e+00 + -1.0572286500000000e+04 / T) / T + 3.4055843749999999e-03 + T * (-4.3647706666666665e-07 + T * (-5.8549300999999998e-10 + 2.3786306999999997e-13 * T));
    dBdT[30] = (1.8681645699999998e+00 + -6.4216034600000003e+03 / T) / T + 2.0401817350000000e-03 + T * (3.1837975100000000e-06 + T * (-3.2401172750000001e-09 + 9.1474754400000010e-13 * T));
    dBdT[31] = (3.4370779999999934e-02 + -1.7556222399999999e+04 / T) / T + 1.2240378950000000e-02 + T * (-7.7254094999999999e-06 + T * (2.5773637499999998e-09 + -3.2821457400000002e-13 * T));
    dBdT[32] = (1.2061736999999999e+00 + 2.3267639999999999e+04 / T) / T + 5.5076774999999996e-03 + T * (-2.1203639666666666e-06 + T * (3.0683042500000000e-10 + 6.8086853999999998e-15 * T));
    dBdT[33] = (1.2271352000000002e+00 + 2.6310660000000000e+04 / T) / T + 5.9191175000000004e-03 + T * (-2.8676604666666666e-06 + T * (8.7236129999999997e-10 + -1.5089197000000001e-13 * T));
    dBdT[34] = (1.4119486000000001e+00 + 3.4826620999999999e+04 / T) / T + 4.6866464999999998e-03 + T * (-8.4630839999999993e-07 + T * (-5.1638675000000001e-10 + 2.0261541999999999e-13 * T));
    dBdT[35] = (-6.7140752999999997e-01 + -2.1362967000000001e+01 / T) / T + 1.4556661000000000e-02 + T * (-9.8180486666666657e-06 + T * (4.2048940000000004e-09 + -8.4978251999999994e-13 * T));
    dBdT[36] = (-1.1319767500000000e+00 + 9.1246216999999997e+03 / T) / T + 1.6203417000000001e-02 + T * (-1.1887948000000001e-05 + T * (5.4188077500000003e-09 + -1.1281405600000001e-12 * T));
    dBdT[37] = (-1.0387692140000000e+00 + 4.4283783999999996e+03 / T) / T + 1.6602816999999999e-02 + T * (-1.2690292999999999e-05 + T * (5.9928927500000000e-09 + -1.2756311400000001e-12 * T));
    dBdT[42] = (2.5310052800000000e+00 + -1.0469762800000001e+03 / T) / T + -6.1830494000000001e-05 + T * (-1.6766647766666668e-07 + T * (6.0882653000000001e-10 + -2.8176247000000003e-13 * T));
  } else {
    dBdT[0] = (1.6770388999999999e+00 + -2.9885894000000000e+04 / T) / T + 1.4865907999999999e-03 + T * (-2.5792296333333332e-07 + T * (2.3608378500000001e-11 + -8.5379982000000002e-16 * T));
    dBdT[1] = (1.4619040000000001e+00 + -6.4932700000000004e+03 / T) / T + 3.0295830000000002e-03 + T * (-6.6832566666666666e-07 + T * (7.8400074999999994e-11 + -3.8766340000000001e-15 * T));
    dBdT[2] = (1.7946283900000002e+00 + 1.0001906900000000e+04 / T) / T + 1.0613029300000000e-03 + T * (-3.7312323666666669e-07 + T * (6.9880254499999997e-11 + -5.3725072599999999e-15 * T));
    dBdT[3] = (2.6131690700000001e+00 + 8.6007512599999991e+03 / T) / T + 2.5798523250000001e-03 + T * (-9.9075874999999998e-07 + T * (2.0012632450000001e-10 + -1.6526639039999999e-14 * T));
    dBdT[4] = (2.6609606499999998e+00 + -1.2159771800000001e+03 / T) / T + 3.2818290550000001e-04 + T * (-4.7049875666666662e-08 + T * (5.1449483749999997e-12 + -2.5982687200000003e-16 * T));
    dBdT[5] = (1.9328657499999999e+00 + -8.1306558099999995e+02 / T) / T + 4.1330401299999997e-04 + T * (-4.8800788000000007e-08 + T * (3.8525103499999999e-12 + -1.3776095999999999e-16 * T));
    dBdT[6] = (2.6523927899999999e+00 + 2.5721613699999998e+03 / T) / T + 2.3581615500000001e-03 + T * (-9.1530582666666671e-07 + T * (1.8634570850000001e-10 + -1.5277822160000000e-14 * T));
    dBdT[7] = (1.5000000000000000e+00 + -7.4537500000000000e+02 / T) / T + 0.0000000000000000e+00 + T * (0.0000000000000000e+00 + T * (0.0000000000000000e+00 + 0.0000000000000000e+00 * T));
    dBdT[9] = (1.5000000000000000e+00 + 2.5473660000000000e+04 / T) / T + 0.0000000000000000e+00 + T * (0.0000000000000000e+00 + T * (0.0000000000000000e+00 + 0.0000000000000000e+00 * T));
    dBdT[10] = (1.5436369700000001e+00 + 2.9226011999999999e+04 / T) / T + -1.3658124299999999e-05 + T * (-1.3967650666666665e-09 + T * (1.2387046125000000e-12 + -9.5910738799999993e-17 * T));
    dBdT[11] = (1.8385303300000002e+00 + 3.6978080799999998e+03 / T) / T + 5.5370644500000001e-04 + T * (-9.8000069666666654e-08 + T * (1.0517468224999999e-11 + -4.8457978000000002e-16 * T));
    dBdT[12] = (3.1722874100000000e+00 + 3.1020683900000002e+01 / T) / T + 9.4058813500000002e-04 + T * (-1.1542576200000000e-07 + T * (4.8664387250000001e-12 + 3.5251380999999999e-17 * T));
    dBdT[13] = (3.5797730500000000e+00 + -1.8007177500000002e+04 / T) / T + 2.0266300150000001e-03 + T * (-4.3281576666666668e-07 + T * (4.9552849999999997e-11 + -2.2793758399999999e-15 * T));
    dBdT[15] = (1.6283960999999998e+00 + 2.1590958600000002e+04 / T) / T + 1.7218994400000000e-03 + T * (-3.6202121666666662e-07 + T * (3.7678509500000002e-11 + -9.1884655999999996e-16 * T));
    dBdT[16] = (1.9510095500000002e+00 + 4.1970704500000000e+04 / T) / T + 4.5499721950000000e-04 + T * (-2.7852747966666667e-08 + T * (-1.2932800675000000e-11 + 2.2796287200000002e-15 * T));
    dBdT[17] = (1.4160424500000000e+00 + 5.6105151200000000e+04 / T) / T + 8.7331883000000003e-05 + T * (-3.9621520666666666e-08 + T * (7.5462513500000001e-12 + -4.0652031800000000e-16 * T));
    dBdT[18] = (2.2189389199999998e+00 + 1.0506127399999999e+04 / T) / T + 6.1602063999999998e-03 + T * (-1.8145738333333333e-06 + T * (3.0555837499999998e-10 + -2.2147303999999998e-14 * T));
    dBdT[19] = (2.2030228100000002e+00 + 2.5868959800000001e+04 / T) / T + 3.9958147750000002e-03 + T * (-1.0363098499999999e-06 + T * (1.4785825450000000e-10 + -8.6909941799999997e-15 * T));
    dBdT[20] = (5.3340890999999990e-01 + 2.3625323600000000e+04 / T) / T + 4.6601715150000004e-03 + T * (-1.4872437566666666e-06 + T * (2.5944383500000001e-10 + -1.8907225039999999e-14 * T));
    dBdT[21] = (4.6257630999999999e-01 + 3.5591851000000002e+04 / T) / T + 5.0506943999999998e-03 + T * (-1.7226316866666668e-06 + T * (3.1901694750000000e-10 + -2.4466509999999999e-14 * T));
    dBdT[22] = (2.4274442299999999e+00 + 2.8555138400000000e+04 / T) / T + 1.6164761699999999e-03 + T * (-3.9098766333333333e-07 + T * (4.7627089000000001e-11 + -2.2898301200000000e-15 * T));
    dBdT[23] = (5.3829383799999997e+00 + 6.3547396200000003e+03 / T) / T + 2.7121125150000001e-03 + T * (-1.1146592666666667e-06 + T * (2.3711135425000000e-10 + -2.0392342800000000e-14 * T));
    dBdT[24] = (1.5881980200000001e+00 + 1.2021357400000001e+04 / T) / T + 2.4385441099999999e-03 + T * (-7.6414438333333338e-07 + T * (1.4555350699999999e-10 + -1.1896234860000000e-14 * T));
    dBdT[25] = (2.7117462600000000e+00 + 2.4410822100000001e+04 / T) / T + 1.5804447550000001e-03 + T * (-4.4423468333333335e-07 + T * (7.0571986250000003e-11 + -4.7476380199999995e-15 * T));
    dBdT[26] = (2.3648563600000001e+00 + 6.6265471699999998e+03 / T) / T + 3.0665371600000001e-03 + T * (-8.2954628666666674e-07 + T * (1.2095461674999999e-10 + -7.2799187200000004e-15 * T));
    dBdT[27] = (9.9860923999999995e-01 + 1.0321076300000001e+04 / T) / T + 5.4563158000000000e-03 + T * (-2.0613323633333331e-06 + T * (4.0478629000000002e-10 + -3.2271702200000001e-14 * T));
    dBdT[28] = (3.5461689900000000e+00 + -6.9025817999999999e+03 / T) / T + 4.2312136349999998e-03 + T * (-1.3646388700000000e-06 + T * (2.4954467874999998e-10 + -1.9327780360000000e-14 * T));
    dBdT[29] = (3.1996667099999998e+00 + -1.0812276900000001e+04 / T) / T + 2.9710866899999998e-03 + T * (-9.8468278000000008e-07 + T * (1.7996154675000000e-10 + -1.3498181219999999e-14 * T));
    dBdT[30] = (1.7188679800000002e+00 + -6.6194913900000001e+03 / T) / T + 4.6162473399999999e-03 + T * (-1.6697405333333333e-06 + T * (3.2538797250000002e-10 + -2.6100746799999999e-14 * T));
    dBdT[31] = (4.2885149100000000e+00 + -1.8546379900000000e+04 / T) / T + 5.1253777000000002e-03 + T * (-2.0036952666666666e-06 + T * (4.1315012999999997e-10 + -3.4700550600000002e-14 * T));
    dBdT[32] = (3.3354568999999996e+00 + 2.2629333999999999e+04 / T) / T + 2.9654894000000001e-03 + T * (-8.8644213333333335e-07 + T * (1.3994688750000001e-10 + -9.0189195999999995e-15 * T));
    dBdT[33] = (3.4262382999999996e+00 + 2.5679259999999998e+04 / T) / T + 2.9685328000000001e-03 + T * (-8.9652299999999991e-07 + T * (1.4242899750000000e-10 + -9.2153609999999997e-15 * T));
    dBdT[34] = (3.2454200000000002e+00 + 3.4204620000000003e+04 / T) / T + 3.1309083499999999e-03 + T * (-9.5990850000000004e-07 + T * (1.5414933750000000e-10 + -1.0052380399999999e-14 * T));
    dBdT[35] = (5.1275310999999997e+00 + -1.4630364999999999e+03 / T) / T + 4.9743840499999999e-03 + T * (-1.4481142666666668e-06 + T * (2.2446918499999999e-10 + -1.4280248999999999e-14 * T));
    dBdT[36] = (5.4585065000000004e+00 + 7.5481944000000003e+03 / T) / T + 4.7759718499999996e-03 + T * (-1.3842388333333335e-06 + T * (2.1392879499999999e-10 + -1.3581339000000001e-14 * T));
    dBdT[37] = (5.6604028000000000e+00 + 2.8616698000000001e+03 / T) / T + 4.6429677500000001e-03 + T * (-1.3386913333333333e-06 + T * (2.0609223499999999e-10 + -1.3046359000000001e-14 * T));
    dBdT[42] = (1.9525763700000001e+00 + -9.2394868799999995e+02 / T) / T + 6.9845020000000005e-04 + T * (-1.6421053433333334e-07 + T * (1.9650254875000001e-11 + -9.2151040799999995e-16 * T));
  }

  if (T <= 1710.0) {
    dBdT[14] = (2.4189622599999998e+00 + 5.0075694600000003e+04 / T) / T + 1.5962790050000000e-04 + T * (-1.0276423900000001e-07 + T * (9.1101873500000000e-11 + -2.0039095800000001e-14 * T));
  } else {
    dBdT[14] = (1.8537604000000001e+00 + 5.0322547299999998e+04 / T) / T + 5.1497166999999995e-04 + T * (-7.7555492333333332e-08 + T * (4.8437675999999999e-12 + -6.3151969400000004e-17 * T));
  }

  eval_jacob_0(pres, conc, fwd_rates, rev_rates, pres_mod, spec_rates, m, mw_avg, rho, dBdT, T, jac);
  eval_jacob_1(pres, conc, fwd_rates, rev_rates, pres_mod, spec_rates, mw_avg, rho, dBdT, T, jac, &J_nplusone, J_nplusjplus);
  eval_jacob_2(pres, conc, fwd_rates, rev_rates, pres_mod, spec_rates, m, mw_avg, rho, dBdT, T, jac, &J_nplusone, J_nplusjplus);
  eval_jacob_3(pres, conc, fwd_rates, rev_rates, pres_mod, spec_rates, mw_avg, rho, dBdT, T, jac, &J_nplusone, J_nplusjplus);
  eval_jacob_4(pres, conc, fwd_rates, rev_rates, pres_mod, spec_rates, m, mw_avg, rho, dBdT, T, jac, &J_nplusone, J_nplusjplus);
  eval_jacob_5(pres, conc, fwd_rates, rev_rates, pres_mod, spec_rates, m, mw_avg, rho, dBdT, T, jac);
  eval_jacob_6(pres, conc, fwd_rates, rev_rates, pres_mod, spec_rates, m, mw_avg, rho, dBdT, T, jac, &J_nplusone, J_nplusjplus);
  eval_jacob_7(pres, conc, fwd_rates, rev_rates, pres_mod, spec_rates, mw_avg, rho, dBdT, T, jac, &J_nplusone, J_nplusjplus);
  // species enthalpies
  double h[43];
  eval_h(T, h);

  // species specific heats
  double cp[43];
  eval_cp(T, cp);

  // average specific heat
  double cp_avg;
  cp_avg = (y[1] * cp[0]) + (y[2] * cp[1]) + (y[3] * cp[2]) + (y[4] * cp[3]) + 
     (y[5] * cp[4]) + (y[6] * cp[5]) + (y[7] * cp[6]) + (y[8] * cp[7]) + 
     (y[9] * cp[8]) + (y[10] * cp[9]) + (y[11] * cp[10]) + (y[12] * cp[11]) + 
     (y[13] * cp[12]) + (y[14] * cp[13]) + (y[15] * cp[14]) + (y[16] * cp[15]) + 
     (y[17] * cp[16]) + (y[18] * cp[17]) + (y[19] * cp[18]) + (y[20] * cp[19]) + 
     (y[21] * cp[20]) + (y[22] * cp[21]) + (y[23] * cp[22]) + (y[24] * cp[23]) + 
     (y[25] * cp[24]) + (y[26] * cp[25]) + (y[27] * cp[26]) + (y[28] * cp[27]) + 
     (y[29] * cp[28]) + (y[30] * cp[29]) + (y[31] * cp[30]) + (y[32] * cp[31]) + 
     (y[33] * cp[32]) + (y[34] * cp[33]) + (y[35] * cp[34]) + (y[36] * cp[35]) + 
     (y[37] * cp[36]) + (y[38] * cp[37]) + (y[39] * cp[38]) + (y[40] * cp[39]) + 
     (y[41] * cp[40]) + (y[42] * cp[41]) + (y_N * cp[42]);
  jac[0] = 0.0;
  double working_temp = 0;
  //Finish dYk / Yj's
  //And dT/dYj's
  eval_jacob_8(mw_avg, rho, cp_avg, spec_rates, h, cp, jac);
  eval_jacob_9(mw_avg, rho, cp_avg, spec_rates, h, cp, jac, J_nplusjplus);
  if (T <= 1000.0) {
    working_temp = (y[1] * 4.6152995281709690e+02 * (-2.0364017000000000e-03 + T * (1.3040683200000000e-05 + T * (-1.6463780699999999e-08 + 7.0878720000000001e-12 * T))))
    + (y[2] * 4.8819576654336220e+02 * (1.0114760000000000e-02 + T * (-2.9305299999999999e-05 + T * (4.3417050000000000e-08 + -2.1314035999999999e-11 * T))))
    + (y[3] * 2.7709331800306609e+02 * (-4.0889000800000000e-03 + T * (1.8761434520000000e-05 + T * (-2.2527267029999997e-08 + 8.4697119200000003e-12 * T))))
    + (y[4] * 1.8890923363551681e+02 * (9.1622497599999995e-03 + T * (-1.6496957059999999e-05 + T * (1.1498689709999999e-08 + -2.8778471359999999e-12 * T))))
    + (y[5] * 2.5984318082380150e+02 * (-2.9967341599999998e-03 + T * (1.9694604020000000e-05 + T * (-2.9043885270000002e-08 + 1.2974913480000000e-11 * T))))
    + (y[6] * 4.1242371527777777e+03 * (7.9805207499999992e-03 + T * (-3.8956301999999997e-05 + T * (6.0471628200000004e-08 + -2.9504470440000002e-11 * T))))
    + (y[7] * 1.8072953157265516e+02 * (2.6244834800000002e-03 + T * (1.0195806119999999e-05 + T * (-2.2863614789999997e-08 + 1.1198405400000000e-11 * T))))
    + (y[8] * 2.0812170463078849e+02 * (0.0000000000000000e+00 + T * (0.0000000000000000e+00 + T * (0.0000000000000000e+00 + 0.0000000000000000e+00 * T))))
    + (y[9] * 2.0772642645958804e+03 * (0.0000000000000000e+00 + T * (0.0000000000000000e+00 + T * (0.0000000000000000e+00 + 0.0000000000000000e+00 * T))))
    + (y[10] * 8.2484743055555555e+03 * (0.0000000000000000e+00 + T * (0.0000000000000000e+00 + T * (0.0000000000000000e+00 + 0.0000000000000000e+00 * T))))
    + (y[11] * 5.1968636164760301e+02 * (-3.2793188399999999e-03 + T * (1.3286127919999999e-05 + T * (-1.8384198720000000e-08 + 8.4506388399999997e-12 * T))))
    + (y[12] * 4.8888470041747513e+02 * (-2.4010665499999998e-03 + T * (9.2332806600000008e-06 + T * (-1.1637489180000001e-08 + 5.4527800800000000e-12 * T))))
    + (y[13] * 2.5190759558868086e+02 * (-4.7491209700000004e-03 + T * (4.2316581000000002e-05 + T * (-7.2829174200000009e-08 + 3.7169009000000002e-11 * T))))
    + (y[14] * 2.4444235020873757e+02 * (-8.4739062199999996e-04 + T * (3.5280864600000001e-05 + T * (-6.8028883199999996e-08 + 3.6358006320000000e-11 * T))))
    + (y[16] * 5.1890795107033648e+02 * (-5.1388808799999997e-04 + T * (5.3687231200000000e-06 + T * (-2.7564977999999999e-09 + -3.9290046079999999e-13 * T))))
    + (y[17] * 5.5374372960372966e+02 * (5.5784781799999997e-04 + T * (-4.0057872000000000e-06 + T * (8.5785876600000002e-09 + -4.4973713599999999e-12 * T))))
    + (y[18] * 5.9359335332333842e+02 * (5.0214959400000004e-07 + T * (3.8618242200000000e-09 + T * (-1.4838978870000000e-11 + 1.0963580240000001e-14 * T))))
    + (y[19] * 2.5945397553516824e+02 * (2.1348827099999999e-02 + T * (-3.7741177199999997e-05 + T * (3.0288926100000005e-08 + -9.2398516799999992e-12 * T))))
    + (y[20] * 2.6788008570139829e+02 * (5.5276414099999999e-03 + T * (1.3697200420000001e-06 + T * (-6.0088947900000008e-09 + 2.4857829679999999e-12 * T))))
    + (y[21] * 2.7687186480186483e+02 * (-4.3402441800000002e-03 + T * (4.2650063200000002e-05 + T * (-5.9051963999999993e-08 + 2.3874206880000000e-11 * T))))
    + (y[22] * 2.7687186480186483e+02 * (-2.6524451899999999e-03 + T * (3.7213235000000000e-05 + T * (-5.3008344900000000e-08 + 2.1552027039999998e-11 * T))))
    + (y[23] * 2.8648825373854322e+02 * (-3.4509829800000000e-03 + T * (2.7557739800000002e-05 + T * (-3.9979123200000003e-08 + 1.7640935880000001e-11 * T))))
    + (y[24] * 1.3409557609186507e+02 * (1.5101457299999999e-02 + T * (-2.5289699600000000e-05 + T * (1.1017127429999999e-08 + 3.4487366880000002e-13 * T))))
    + (y[25] * 2.6808738311730184e+02 * (-5.4250762300000000e-03 + T * (3.4047927200000000e-05 + T * (-4.4612451599999994e-08 + 1.7790539920000002e-11 * T))))
    + (y[26] * 2.6808738311730184e+02 * (4.4359111100000003e-03 + T * (-2.4443968000000001e-06 + T * (-3.4202235299999998e-09 + 2.6761017280000000e-12 * T))))
    + (y[27] * 2.5964843232777469e+02 * (2.2117560499999999e-03 + T * (1.1724404020000000e-05 + T * (-2.0187953279999999e-08 + 8.7134468399999995e-12 * T))))
    + (y[28] * 2.5964843232777469e+02 * (4.2518230999999997e-03 + T * (1.6101929179999999e-05 + T * (-3.2099985899999997e-08 + 1.4502872360000000e-11 * T))))
    + (y[29] * 2.5172455646382079e+02 * (8.7626400600000001e-03 + T * (1.5356978100000000e-05 + T * (-4.4995724699999998e-08 + 2.3758681279999999e-11 * T))))
    + (y[30] * 1.7685453172526749e+02 * (6.8111687499999999e-03 + T * (-2.6188624000000000e-06 + T * (-7.0259161199999997e-09 + 4.7572613999999999e-12 * T))))
    + (y[31] * 1.7685453172526749e+02 * (4.0803634699999999e-03 + T * (1.9102785060000001e-05 + T * (-3.8881407300000002e-08 + 1.8294950880000001e-11 * T))))
    + (y[32] * 1.3195045546879959e+02 * (2.4480757900000000e-02 + T * (-4.6352457000000003e-05 + T * (3.0928364999999998e-08 + -6.5642914800000000e-12 * T))))
    + (y[33] * 1.8467964061215878e+02 * (1.1015354999999999e-02 + T * (-1.2722183800000000e-05 + T * (3.6819650999999999e-09 + 1.3617370800000000e-13 * T))))
    + (y[34] * 1.8467964061215878e+02 * (1.1838235000000001e-02 + T * (-1.7205962800000000e-05 + T * (1.0468335599999999e-08 + -3.0178394000000001e-12 * T))))
    + (y[35] * 1.8467964061215878e+02 * (9.3732929999999996e-03 + T * (-5.0778503999999998e-06 + T * (-6.1966410000000005e-09 + 4.0523083999999996e-12 * T))))
    + (y[36] * 1.3404369155865092e+02 * (2.9113322000000001e-02 + T * (-5.8908291999999998e-05 + T * (5.0458728000000008e-08 + -1.6995650399999999e-11 * T))))
    + (y[37] * 1.3404369155865092e+02 * (3.2406834000000002e-02 + T * (-7.1327688000000005e-05 + T * (6.5025693000000001e-08 + -2.2562811200000002e-11 * T))))
    + (y[38] * 1.3404369155865092e+02 * (3.3205633999999998e-02 + T * (-7.6141757999999995e-05 + T * (7.1914712999999997e-08 + -2.5512622800000000e-11 * T))))
    + (y[39] * 2.9683906104962517e+02 * (-6.1035368999999996e-04 + T * (2.0336285999999999e-06 + T * (2.7210175800000002e-09 + -3.6176979599999999e-12 * T))))
    + (y[40] * 1.8892640369015430e+02 * (8.9841299000000003e-03 + T * (-1.4244126400000001e-05 + T * (7.3719024000000001e-09 + -5.7154191999999996e-13 * T))))
    + (y[41] * 5.1826105466558636e+02 * (-1.3662200899999999e-02 + T * (9.8290784200000004e-05 + T * (-1.4527403010000001e-07 + 6.6641376399999995e-11 * T))))
    + (y[42] * 2.7650356168939146e+02 * (-5.5015490099999996e-03 + T * (1.1988769160000001e-04 + T * (-2.1253994069999998e-07 + 1.0747433440000000e-10 * T))))
    + (y_N * 2.9679667666166921e+02 * (-1.2366098800000000e-04 + T * (-1.0059988660000001e-06 + T * (7.3059183600000005e-09 + -5.6352494000000003e-12 * T))));
  } else {
    working_temp = (y[1] * 4.6152995281709690e+02 * (2.9731815999999999e-03 + T * (-1.5475377800000000e-06 + T * (2.8330054200000001e-10 + -1.7075996400000000e-14 * T))))
    + (y[2] * 4.8819576654336220e+02 * (6.0591660000000004e-03 + T * (-4.0099539999999997e-06 + T * (9.4080089999999997e-10 + -7.7532679999999996e-14 * T))))
    + (y[3] * 2.7709331800306609e+02 * (2.1226058600000001e-03 + T * (-2.2387394200000001e-06 + T * (8.3856305399999996e-10 + -1.0745014520000000e-13 * T))))
    + (y[4] * 1.8890923363551681e+02 * (5.1597046500000002e-03 + T * (-5.9445524999999999e-06 + T * (2.4015158940000001e-09 + -3.3053278080000001e-13 * T))))
    + (y[5] * 2.5984318082380150e+02 * (6.5636581100000002e-04 + T * (-2.8229925399999997e-07 + T * (6.1739380499999999e-11 + -5.1965374400000003e-15 * T))))
    + (y[6] * 4.1242371527777777e+03 * (8.2660802599999995e-04 + T * (-2.9280472800000003e-07 + T * (4.6230124199999999e-11 + -2.7552192000000000e-15 * T))))
    + (y[7] * 1.8072953157265516e+02 * (4.7163231000000002e-03 + T * (-5.4918349600000003e-06 + T * (2.2361485020000002e-09 + -3.0555644320000000e-13 * T))))
    + (y[8] * 2.0812170463078849e+02 * (0.0000000000000000e+00 + T * (0.0000000000000000e+00 + T * (0.0000000000000000e+00 + 0.0000000000000000e+00 * T))))
    + (y[9] * 2.0772642645958804e+03 * (0.0000000000000000e+00 + T * (0.0000000000000000e+00 + T * (0.0000000000000000e+00 + 0.0000000000000000e+00 * T))))
    + (y[10] * 8.2484743055555555e+03 * (0.0000000000000000e+00 + T * (0.0000000000000000e+00 + T * (0.0000000000000000e+00 + 0.0000000000000000e+00 * T))))
    + (y[11] * 5.1968636164760301e+02 * (-2.7316248599999999e-05 + T * (-8.3805903999999992e-09 + T * (1.4864455349999999e-11 + -1.9182147759999999e-15 * T))))
    + (y[12] * 4.8888470041747513e+02 * (1.1074128900000000e-03 + T * (-5.8800041799999995e-07 + T * (1.2620961869999999e-10 + -9.6915956000000007e-15 * T))))
    + (y[13] * 2.5190759558868086e+02 * (1.8811762700000000e-03 + T * (-6.9255457200000001e-07 + T * (5.8397264700000001e-11 + 7.0502761999999997e-16 * T))))
    + (y[14] * 2.4444235020873757e+02 * (4.0532600300000002e-03 + T * (-2.5968946000000000e-06 + T * (5.9463419999999994e-10 + -4.5587516799999997e-14 * T))))
    + (y[16] * 5.1890795107033648e+02 * (3.4437988800000000e-03 + T * (-2.1721272999999998e-06 + T * (4.5214211400000002e-10 + -1.8376931200000000e-14 * T))))
    + (y[17] * 5.5374372960372966e+02 * (9.0999443900000000e-04 + T * (-1.6711648780000001e-07 + T * (-1.5519360810000001e-10 + 4.5592574400000002e-14 * T))))
    + (y[18] * 5.9359335332333842e+02 * (1.7466376600000001e-04 + T * (-2.3772912400000000e-07 + T * (9.0555016200000007e-11 + -8.1304063600000002e-15 * T))))
    + (y[19] * 2.5945397553516824e+02 * (1.2320412800000000e-02 + T * (-1.0887442999999999e-05 + T * (3.6667004999999995e-09 + -4.4294607999999999e-13 * T))))
    + (y[20] * 2.6788008570139829e+02 * (7.9916295500000005e-03 + T * (-6.2178590999999997e-06 + T * (1.7742990540000001e-09 + -1.7381988359999999e-13 * T))))
    + (y[21] * 2.7687186480186483e+02 * (9.3203430300000008e-03 + T * (-8.9234625400000003e-06 + T * (3.1133260200000001e-09 + -3.7814450079999999e-13 * T))))
    + (y[22] * 2.7687186480186483e+02 * (1.0101388800000000e-02 + T * (-1.0335790120000001e-05 + T * (3.8282033700000004e-09 + -4.8933020000000001e-13 * T))))
    + (y[23] * 2.8648825373854322e+02 * (3.2329523399999998e-03 + T * (-2.3459259800000001e-06 + T * (5.7152506800000006e-10 + -4.5796602399999998e-14 * T))))
    + (y[24] * 1.3409557609186507e+02 * (5.4242250300000003e-03 + T * (-6.6879556000000000e-06 + T * (2.8453362509999998e-09 + -4.0784685599999998e-13 * T))))
    + (y[25] * 2.6808738311730184e+02 * (4.8770882199999999e-03 + T * (-4.5848663000000001e-06 + T * (1.7466420840000000e-09 + -2.3792469719999998e-13 * T))))
    + (y[26] * 2.6808738311730184e+02 * (3.1608895100000002e-03 + T * (-2.6654081000000001e-06 + T * (8.4686383500000003e-10 + -9.4952760399999997e-14 * T))))
    + (y[27] * 2.5964843232777469e+02 * (6.1330743200000001e-03 + T * (-4.9772777200000003e-06 + T * (1.4514554009999998e-09 + -1.4559837440000000e-13 * T))))
    + (y[28] * 2.5964843232777469e+02 * (1.0912631600000000e-02 + T * (-1.2367994180000000e-05 + T * (4.8574354800000003e-09 + -6.4543404400000001e-13 * T))))
    + (y[29] * 2.5172455646382079e+02 * (8.4624272699999996e-03 + T * (-8.1878332199999996e-06 + T * (2.9945361450000000e-09 + -3.8655560719999998e-13 * T))))
    + (y[30] * 1.7685453172526749e+02 * (5.9421733799999996e-03 + T * (-5.9080966800000001e-06 + T * (2.1595385610000001e-09 + -2.6996362439999998e-13 * T))))
    + (y[31] * 1.7685453172526749e+02 * (9.2324946799999998e-03 + T * (-1.0018443200000000e-05 + T * (3.9046556700000000e-09 + -5.2201493599999998e-13 * T))))
    + (y[32] * 1.3195045546879959e+02 * (1.0250755400000000e-02 + T * (-1.2022171600000000e-05 + T * (4.9578015599999999e-09 + -6.9401101199999998e-13 * T))))
    + (y[33] * 1.8467964061215878e+02 * (5.9309788000000002e-03 + T * (-5.3186528000000003e-06 + T * (1.6793626500000001e-09 + -1.8037839200000000e-13 * T))))
    + (y[34] * 1.8467964061215878e+02 * (5.9370656000000003e-03 + T * (-5.3791379999999997e-06 + T * (1.7091479699999999e-09 + -1.8430721999999999e-13 * T))))
    + (y[35] * 1.8467964061215878e+02 * (6.2618166999999997e-03 + T * (-5.7594509999999998e-06 + T * (1.8497920499999999e-09 + -2.0104760799999999e-13 * T))))
    + (y[36] * 1.3404369155865092e+02 * (9.9487680999999998e-03 + T * (-8.6886856000000006e-06 + T * (2.6936302200000001e-09 + -2.8560498000000000e-13 * T))))
    + (y[37] * 1.3404369155865092e+02 * (9.5519436999999992e-03 + T * (-8.3054330000000004e-06 + T * (2.5671455399999997e-09 + -2.7162678000000002e-13 * T))))
    + (y[38] * 1.3404369155865092e+02 * (9.2859355000000001e-03 + T * (-8.0321480000000002e-06 + T * (2.4731068199999998e-09 + -2.6092718000000001e-13 * T))))
    + (y[39] * 2.9683906104962517e+02 * (1.3517281000000000e-03 + T * (-9.7158809999999997e-07 + T * (2.3656093200000000e-10 + -1.8792298400000001e-14 * T))))
    + (y[40] * 1.8892640369015430e+02 * (2.7414569000000001e-03 + T * (-1.9917951800000000e-06 + T * (4.8115998000000004e-10 + -3.6647942799999998e-14 * T))))
    + (y[41] * 5.1826105466558636e+02 * (1.0026309900000000e-02 + T * (-6.6332247600000003e-06 + T * (1.6094494140000001e-09 + -1.2587870320000000e-13 * T))))
    + (y[42] * 2.7650356168939146e+02 * (1.5353880200000000e-02 + T * (-1.0940789700000000e-05 + T * (2.6334796320000000e-09 + -2.0926701240000000e-13 * T))))
    + (y_N * 2.9679667666166921e+02 * (1.3969004000000001e-03 + T * (-9.8526320600000006e-07 + T * (2.3580305850000002e-10 + -1.8430208160000000e-14 * T))));
  }

  if (T <= 1710.0) {
    working_temp += (y[15] * 4.8888470041747513e+02 * (3.1925580100000000e-04 + T * (-6.1658543400000005e-07 + T * (1.0932224820000000e-09 + -4.0078191600000002e-13 * T))));
  } else {
    working_temp += (y[15] * 4.8888470041747513e+02 * (1.0299433399999999e-03 + T * (-4.6533295400000002e-07 + T * (5.8125211199999999e-11 + -1.2630393880000000e-15 * T))));
  }


  //Complete dT wrt T calculations
  jac[0] = -(spec_rates[0] * 1.80150000e+01 * (-working_temp * h[0] / cp_avg + cp[0]) + jac[1] * h[0] * rho
    + spec_rates[1] * 1.70310000e+01 * (-working_temp * h[1] / cp_avg + cp[1]) + jac[2] * h[1] * rho
    + spec_rates[2] * 3.00060000e+01 * (-working_temp * h[2] / cp_avg + cp[2]) + jac[3] * h[2] * rho
    + spec_rates[3] * 4.40130000e+01 * (-working_temp * h[3] / cp_avg + cp[3]) + jac[4] * h[3] * rho
    + spec_rates[4] * 3.19980000e+01 * (-working_temp * h[4] / cp_avg + cp[4]) + jac[5] * h[4] * rho
    + spec_rates[5] * 2.01600000e+00 * (-working_temp * h[5] / cp_avg + cp[5]) + jac[6] * h[5] * rho
    + spec_rates[6] * 4.60050000e+01 * (-working_temp * h[6] / cp_avg + cp[6]) + jac[7] * h[6] * rho
    + spec_rates[7] * 3.99500000e+01 * (-working_temp * h[7] / cp_avg + cp[7]) + jac[8] * h[7] * rho
    + spec_rates[8] * 4.00260200e+00 * (-working_temp * h[8] / cp_avg + cp[8]) + jac[9] * h[8] * rho
    + spec_rates[9] * 1.00800000e+00 * (-working_temp * h[9] / cp_avg + cp[9]) + jac[10] * h[9] * rho
    + spec_rates[10] * 1.59990000e+01 * (-working_temp * h[10] / cp_avg + cp[10]) + jac[11] * h[10] * rho
    + spec_rates[11] * 1.70070000e+01 * (-working_temp * h[11] / cp_avg + cp[11]) + jac[12] * h[11] * rho
    + spec_rates[12] * 3.30060000e+01 * (-working_temp * h[12] / cp_avg + cp[12]) + jac[13] * h[12] * rho
    + spec_rates[13] * 3.40140000e+01 * (-working_temp * h[13] / cp_avg + cp[13]) + jac[14] * h[13] * rho
    + spec_rates[14] * 1.70070000e+01 * (-working_temp * h[14] / cp_avg + cp[14]) + jac[15] * h[14] * rho
    + spec_rates[15] * 1.60230000e+01 * (-working_temp * h[15] / cp_avg + cp[15]) + jac[16] * h[15] * rho
    + spec_rates[16] * 1.50150000e+01 * (-working_temp * h[16] / cp_avg + cp[16]) + jac[17] * h[16] * rho
    + spec_rates[17] * 1.40070000e+01 * (-working_temp * h[17] / cp_avg + cp[17]) + jac[18] * h[17] * rho
    + spec_rates[18] * 3.20460000e+01 * (-working_temp * h[18] / cp_avg + cp[18]) + jac[19] * h[18] * rho
    + spec_rates[19] * 3.10380000e+01 * (-working_temp * h[19] / cp_avg + cp[19]) + jac[20] * h[19] * rho
    + spec_rates[20] * 3.00300000e+01 * (-working_temp * h[20] / cp_avg + cp[20]) + jac[21] * h[20] * rho
    + spec_rates[21] * 3.00300000e+01 * (-working_temp * h[21] / cp_avg + cp[21]) + jac[22] * h[21] * rho
    + spec_rates[22] * 2.90220000e+01 * (-working_temp * h[22] / cp_avg + cp[22]) + jac[23] * h[22] * rho
    + spec_rates[23] * 6.20040000e+01 * (-working_temp * h[23] / cp_avg + cp[23]) + jac[24] * h[23] * rho
    + spec_rates[24] * 3.10140000e+01 * (-working_temp * h[24] / cp_avg + cp[24]) + jac[25] * h[24] * rho
    + spec_rates[25] * 3.10140000e+01 * (-working_temp * h[25] / cp_avg + cp[25]) + jac[26] * h[25] * rho
    + spec_rates[26] * 3.20220000e+01 * (-working_temp * h[26] / cp_avg + cp[26]) + jac[27] * h[26] * rho
    + spec_rates[27] * 3.20220000e+01 * (-working_temp * h[27] / cp_avg + cp[27]) + jac[28] * h[27] * rho
    + spec_rates[28] * 3.30300000e+01 * (-working_temp * h[28] / cp_avg + cp[28]) + jac[29] * h[28] * rho
    + spec_rates[29] * 4.70130000e+01 * (-working_temp * h[29] / cp_avg + cp[29]) + jac[30] * h[29] * rho
    + spec_rates[30] * 4.70130000e+01 * (-working_temp * h[30] / cp_avg + cp[30]) + jac[31] * h[30] * rho
    + spec_rates[31] * 6.30120000e+01 * (-working_temp * h[31] / cp_avg + cp[31]) + jac[32] * h[31] * rho
    + spec_rates[32] * 4.50210000e+01 * (-working_temp * h[32] / cp_avg + cp[32]) + jac[33] * h[32] * rho
    + spec_rates[33] * 4.50210000e+01 * (-working_temp * h[33] / cp_avg + cp[33]) + jac[34] * h[33] * rho
    + spec_rates[34] * 4.50210000e+01 * (-working_temp * h[34] / cp_avg + cp[34]) + jac[35] * h[34] * rho
    + spec_rates[35] * 6.20280000e+01 * (-working_temp * h[35] / cp_avg + cp[35]) + jac[36] * h[35] * rho
    + spec_rates[36] * 6.20280000e+01 * (-working_temp * h[36] / cp_avg + cp[36]) + jac[37] * h[36] * rho
    + spec_rates[37] * 6.20280000e+01 * (-working_temp * h[37] / cp_avg + cp[37]) + jac[38] * h[37] * rho
    + spec_rates[38] * 2.80100000e+01 * (-working_temp * h[38] / cp_avg + cp[38]) + jac[39] * h[38] * rho
    + spec_rates[39] * 4.40090000e+01 * (-working_temp * h[39] / cp_avg + cp[39]) + jac[40] * h[39] * rho
    + spec_rates[40] * 1.60430000e+01 * (-working_temp * h[40] / cp_avg + cp[40]) + jac[41] * h[40] * rho
    + spec_rates[41] * 3.00700000e+01 * (-working_temp * h[41] / cp_avg + cp[41]) + jac[42] * h[41] * rho
    + spec_rates[42] * 2.80140000e+01 * (-working_temp * h[42] / cp_avg + cp[42]) + J_nplusone * h[42] * rho) / (rho * cp_avg);
} // end eval_jacob

